<!DOCTYPE html><html><head>
      <title>DinosaurusLand</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({"extensions":["tex2jax.js"],"jax":["input/TeX","output/HTML-CSS"],"messageStyle":"none","tex2jax":{"processEnvironments":false,"processEscapes":true,"inlineMath":[["$","$"],["\\(","\\)"]],"displayMath":[["$$","$$"],["\\[","\\]"]]},"TeX":{"extensions":["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]},"HTML-CSS":{"availableFonts":["TeX"]}});
        </script>
        <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
        
      
      
      
      
      
      
      
      
      
      <style>
      /**
 * prism.js Github theme based on GitHub's theme.
 * @author Sam Clarke
 */
code[class*="language-"],
pre[class*="language-"] {
  color: #333;
  background: none;
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.4;

  -moz-tab-size: 8;
  -o-tab-size: 8;
  tab-size: 8;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
  padding: .8em;
  overflow: auto;
  /* border: 1px solid #ddd; */
  border-radius: 3px;
  /* background: #fff; */
  background: #f5f5f5;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
  padding: .1em;
  border-radius: .3em;
  white-space: normal;
  background: #f5f5f5;
}

.token.comment,
.token.blockquote {
  color: #969896;
}

.token.cdata {
  color: #183691;
}

.token.doctype,
.token.punctuation,
.token.variable,
.token.macro.property {
  color: #333;
}

.token.operator,
.token.important,
.token.keyword,
.token.rule,
.token.builtin {
  color: #a71d5d;
}

.token.string,
.token.url,
.token.regex,
.token.attr-value {
  color: #183691;
}

.token.property,
.token.number,
.token.boolean,
.token.entity,
.token.atrule,
.token.constant,
.token.symbol,
.token.command,
.token.code {
  color: #0086b3;
}

.token.tag,
.token.selector,
.token.prolog {
  color: #63a35c;
}

.token.function,
.token.namespace,
.token.pseudo-element,
.token.class,
.token.class-name,
.token.pseudo-class,
.token.id,
.token.url-reference .token.variable,
.token.attr-name {
  color: #795da3;
}

.token.entity {
  cursor: help;
}

.token.title,
.token.title .token.punctuation {
  font-weight: bold;
  color: #1d3e81;
}

.token.list {
  color: #ed6a43;
}

.token.inserted {
  background-color: #eaffea;
  color: #55a532;
}

.token.deleted {
  background-color: #ffecec;
  color: #bd2c00;
}

.token.bold {
  font-weight: bold;
}

.token.italic {
  font-style: italic;
}


/* JSON */
.language-json .token.property {
  color: #183691;
}

.language-markup .token.tag .token.punctuation {
  color: #333;
}

/* CSS */
code.language-css,
.language-css .token.function {
  color: #0086b3;
}

/* YAML */
.language-yaml .token.atrule {
  color: #63a35c;
}

code.language-yaml {
  color: #183691;
}

/* Ruby */
.language-ruby .token.function {
  color: #333;
}

/* Markdown */
.language-markdown .token.url {
  color: #795da3;
}

/* Makefile */
.language-makefile .token.symbol {
  color: #795da3;
}

.language-makefile .token.variable {
  color: #183691;
}

.language-makefile .token.builtin {
  color: #0086b3;
}

/* Bash */
.language-bash .token.keyword {
  color: #0086b3;
}

/* highlight */
pre[data-line] {
  position: relative;
  padding: 1em 0 1em 3em;
}
pre[data-line] .line-highlight-wrapper {
  position: absolute;
  top: 0;
  left: 0;
  background-color: transparent;
  display: block;
  width: 100%;
}

pre[data-line] .line-highlight {
  position: absolute;
  left: 0;
  right: 0;
  padding: inherit 0;
  margin-top: 1em;
  background: hsla(24, 20%, 50%,.08);
  background: linear-gradient(to right, hsla(24, 20%, 50%,.1) 70%, hsla(24, 20%, 50%,0));
  pointer-events: none;
  line-height: inherit;
  white-space: pre;
}

pre[data-line] .line-highlight:before, 
pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-start);
  position: absolute;
  top: .4em;
  left: .6em;
  min-width: 1em;
  padding: 0 .5em;
  background-color: hsla(24, 20%, 50%,.4);
  color: hsl(24, 20%, 95%);
  font: bold 65%/1.5 sans-serif;
  text-align: center;
  vertical-align: .3em;
  border-radius: 999px;
  text-shadow: none;
  box-shadow: 0 1px white;
}

pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-end);
  top: auto;
  bottom: .4em;
}html body{font-family:"Helvetica Neue",Helvetica,"Segoe UI",Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ul,html body>ol{margin-bottom:16px}html body ul,html body ol{padding-left:2em}html body ul.no-list,html body ol.no-list{padding:0;list-style-type:none}html body ul ul,html body ul ol,html body ol ol,html body ol ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:bold;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:bold}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em !important;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::before,html body code::after{letter-spacing:-0.2em;content:"\00a0"}html body pre>code{padding:0;margin:0;font-size:.85em !important;word-break:normal;white-space:pre;background:transparent;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;font-size:.85em !important;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:before,html body pre tt:before,html body pre code:after,html body pre tt:after{content:normal}html body p,html body blockquote,html body ul,html body ol,html body dl,html body pre{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body pre,html body code{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview .pagebreak,.markdown-preview .newpage{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center !important}.markdown-preview:not([for="preview"]) .code-chunk .btn-group{display:none}.markdown-preview:not([for="preview"]) .code-chunk .status{display:none}.markdown-preview:not([for="preview"]) .code-chunk .output-div{margin-bottom:16px}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0}@media screen and (min-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{font-size:14px !important;padding:1em}}@media print{html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,0.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{padding:0 1.6em;margin-top:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc li{margin-bottom:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{list-style-type:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% -  300px);padding:2em calc(50% - 457px -  150px);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */

      </style>
    </head>
    <body for="html-export">
      <div class="mume markdown-preview  ">
      <h1 class="mume-header" id="%E5%AD%97%E7%AC%A6%E7%BA%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B-%E6%81%90%E9%BE%99%E4%B9%8B%E5%9C%B0">&#x5B57;&#x7B26;&#x7EA7;&#x8BED;&#x8A00;&#x6A21;&#x578B;-&#x6050;&#x9F99;&#x4E4B;&#x5730;</h1>

<h2 class="mume-header" id="%E9%97%AE%E9%A2%98%E6%8F%8F%E8%BF%B0">&#x95EE;&#x9898;&#x63CF;&#x8FF0;</h2>

<p>&#x6B22;&#x8FCE;&#x6765;&#x5230;&#x6050;&#x9F99;&#x5C9B;!6500&#x4E07;&#x5E74;&#x524D;&#xFF0C;&#x6050;&#x9F99;&#x5C31;&#x5B58;&#x5728;&#x4E86;&#xFF0C;&#x5728;&#x8FD9;&#x6B21;&#x4F5C;&#x4E1A;&#x4E2D;&#xFF0C;&#x6050;&#x9F99;&#x53C8;&#x56DE;&#x6765;&#x4E86;&#x3002;&#x4F60;&#x8D1F;&#x8D23;&#x4E00;&#x9879;&#x7279;&#x6B8A;&#x4EFB;&#x52A1;&#x3002;&#x9886;&#x5148;&#x7684;&#x751F;&#x7269;&#x5B66;&#x7814;&#x7A76;&#x4EBA;&#x5458;&#x6B63;&#x5728;&#x521B;&#x9020;&#x65B0;&#x7684;&#x6050;&#x9F99;&#x54C1;&#x79CD;&#xFF0C;&#x5E76;&#x5C06;&#x5B83;&#x4EEC;&#x5E26;&#x5230;&#x5730;&#x7403;&#x4E0A;&#xFF0C;&#x800C;&#x4F60;&#x7684;&#x5DE5;&#x4F5C;&#x5C31;&#x662F;&#x7ED9;&#x8FD9;&#x4E9B;&#x6050;&#x9F99;&#x547D;&#x540D;&#x3002;&#x5982;&#x679C;&#x6050;&#x9F99;&#x4E0D;&#x559C;&#x6B22;&#x5B83;&#x7684;&#x540D;&#x5B57;&#xFF0C;&#x5B83;&#x53EF;&#x80FD;&#x4F1A;&#x9009;&#x62E9;beserk&#xFF0C;&#x6240;&#x4EE5;&#x660E;&#x667A;&#x5730;&#x9009;&#x62E9;!</p>
<p>&#x5E78;&#x8FD0;&#x7684;&#x662F;&#xFF0C;&#x4F60;&#x5DF2;&#x7ECF;&#x5B66;&#x4F1A;&#x4E86;&#x4E00;&#x4E9B;&#x6DF1;&#x5165;&#x7684;&#x5B66;&#x4E60;&#xFF0C;&#x4F60;&#x5C06;&#x4F7F;&#x7528;&#x5B83;&#x6765;&#x62EF;&#x6551;&#x8FD9;&#x4E00;&#x5929;&#x3002;&#x60A8;&#x7684;&#x52A9;&#x624B;&#x5DF2;&#x7ECF;&#x6536;&#x96C6;&#x4E86;&#x4E00;&#x5F20;&#x4ED6;&#x4EEC;&#x80FD;&#x627E;&#x5230;&#x7684;&#x6240;&#x6709;&#x6050;&#x9F99;&#x540D;&#x5B57;&#x7684;&#x6E05;&#x5355;&#xFF0C;&#x5E76;&#x5C06;&#x5B83;&#x4EEC;&#x6C47;&#x7F16;&#x5230;dinos.txt&#x4E2D;&#x3002;&#x8981;&#x521B;&#x5EFA;&#x65B0;&#x7684;&#x6050;&#x9F99;&#x540D;&#x79F0;&#xFF0C;&#x60A8;&#x5C06;&#x6784;&#x5EFA;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x7EA7;&#x8BED;&#x8A00;&#x6A21;&#x578B;&#x6765;&#x751F;&#x6210;&#x65B0;&#x7684;&#x540D;&#x79F0;&#x3002;&#x60A8;&#x7684;&#x7B97;&#x6CD5;&#x5C06;&#x5B66;&#x4E60;&#x4E0D;&#x540C;&#x7684;&#x540D;&#x79F0;&#x6A21;&#x5F0F;&#xFF0C;&#x5E76;&#x968F;&#x673A;&#x751F;&#x6210;&#x65B0;&#x7684;&#x540D;&#x79F0;&#x3002;&#x5E0C;&#x671B;&#x8FD9;&#x4E2A;&#x7B97;&#x6CD5;&#x80FD;&#x8BA9;&#x4F60;&#x548C;&#x4F60;&#x7684;&#x56E2;&#x961F;&#x8FDC;&#x79BB;&#x6050;&#x9F99;&#x7684;&#x6124;&#x6012;!</p>
<h2 class="mume-header" id="%E5%AD%A6%E4%B9%A0%E7%9B%AE%E6%A0%87">&#x5B66;&#x4E60;&#x76EE;&#x6807;</h2>

<ul>
<li>
<p>&#x5982;&#x4F55;&#x5B58;&#x50A8;&#x6587;&#x672C;&#x6570;&#x636E;&#x5904;&#x7406;&#x4F7F;&#x7528;RNN</p>
</li>
<li>
<p>&#x5982;&#x4F55;&#x7EFC;&#x5408;&#x6570;&#x636E;&#xFF0C;&#x901A;&#x8FC7;&#x62BD;&#x6837;&#x9884;&#x6D4B;&#x5728;&#x6BCF;&#x4E2A;time-step&#xFF0C;&#x5E76;&#x4F20;&#x9012;&#x5B83;&#x5230;&#x4E0B;&#x4E00;&#x4E2A;RNN&#x5355;&#x5143;</p>
</li>
<li>
<p>&#x5982;&#x4F55;&#x6784;&#x5EFA;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x7EA7;&#x6587;&#x672C;&#x751F;&#x6210;&#x9012;&#x5F52;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;</p>
</li>
<li>
<p>&#x4E3A;&#x4EC0;&#x4E48;&#x88C1;&#x526A;&#x68AF;&#x5EA6;&#x662F;&#x91CD;&#x8981;&#x7684;</p>
</li>
</ul>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> utils <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> random
</pre><h2 class="mume-header" id="%E6%95%B0%E6%8D%AE%E9%9B%86%E5%92%8C%E9%A2%84%E5%A4%84%E7%90%86">&#x6570;&#x636E;&#x96C6;&#x548C;&#x9884;&#x5904;&#x7406;</h2>

<h3 class="mume-header" id="%E8%AF%BB%E5%8F%96%E6%95%B0%E6%8D%AE">&#x8BFB;&#x53D6;&#x6570;&#x636E;</h3>

<p>&#x8FD0;&#x884C;&#x4EE5;&#x4E0B;&#x5355;&#x5143;&#x8BFB;&#x53D6;&#x6050;&#x9F99;&#x540D;&#x79F0;&#x7684;&#x6570;&#x636E;&#x96C6;&#xFF0C;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x552F;&#x4E00;&#x5B57;&#x7B26;&#x5217;&#x8868;(&#x4F8B;&#x5982;a-z)&#xFF0C;&#x5E76;&#x8BA1;&#x7B97;&#x6570;&#x636E;&#x96C6;&#x548C;&#x8BCD;&#x6C47;&#x8868;&#x7684;&#x5927;&#x5C0F;&#x3002;</p>
<pre data-role="codeBlock" data-info="python" class="language-python">data <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&apos;dinos.txt&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;r&apos;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
data<span class="token operator">=</span> data<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span>
chars <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">set</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>
data_size<span class="token punctuation">,</span> vocab_size <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>chars<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&apos;There are %d total characters and %d unique characters in your data.&apos;</span> <span class="token operator">%</span> <span class="token punctuation">(</span>data_size<span class="token punctuation">,</span> vocab_size<span class="token punctuation">)</span><span class="token punctuation">)</span>
</pre><h4 class="mume-header" id="%E7%BB%93%E6%9E%9C">&#x7ED3;&#x679C;</h4>

<pre data-role="codeBlock" data-info class="language-"><code>There are 19909 total characters and 27 unique characters in your data.
</code></pre><h3 class="mume-header" id="%E7%94%9F%E6%88%90%E5%AD%97%E5%85%B8">&#x751F;&#x6210;&#x5B57;&#x5178;</h3>

<p>&#x8FD9;&#x4E9B;&#x5B57;&#x7B26;&#x662F;a-z(26&#x4E2A;&#x5B57;&#x7B26;)&#x52A0;&#x4E0A;&#x201C;\n&#x201D;(&#x6216;&#x6362;&#x884C;&#x5B57;&#x7B26;)&#xFF0C;&#x8BE5;&#x5B57;&#x7B26;&#x5728;&#x672C;&#x6B21;&#x4EFB;&#x52A1;&#x4E2D;&#x626E;&#x6F14;&#x7684;&#x89D2;&#x8272;&#x7C7B;&#x4F3C;&#x4E8E;&#x6211;&#x4EEC;&#x5728;&#x8BFE;&#x5802;&#x4E0A;&#x8BA8;&#x8BBA;&#x8FC7;&#x7684;<code>&lt; EOS &gt;</code>&#x6807;&#x8BB0;&#xFF0C;&#x53EA;&#x662F;&#x5728;&#x8FD9;&#x91CC;&#x5B83;&#x8868;&#x793A;&#x6050;&#x9F99;&#x540D;&#x79F0;&#x7684;&#x7ED3;&#x675F;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x53E5;&#x5B50;&#x7684;&#x7ED3;&#x675F;&#x3002;&#x5728;&#x4E0B;&#x9762;&#x7684;&#x5355;&#x5143;&#x683C;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x521B;&#x5EFA;&#x4E86;&#x4E00;&#x4E2A;python&#x5B57;&#x5178;(&#x5373;&#xFF0C;&#x5C06;&#x6BCF;&#x4E2A;&#x5B57;&#x7B26;&#x6620;&#x5C04;&#x5230;0-26&#x4E4B;&#x95F4;&#x7684;&#x7D22;&#x5F15;&#x3002;&#x6211;&#x4EEC;&#x8FD8;&#x521B;&#x5EFA;&#x4E86;&#x7B2C;&#x4E8C;&#x4E2A;python&#x5B57;&#x5178;&#xFF0C;&#x5B83;&#x5C06;&#x6BCF;&#x4E2A;&#x7D22;&#x5F15;&#x6620;&#x5C04;&#x56DE;&#x5BF9;&#x5E94;&#x7684;&#x5B57;&#x7B26;&#x5B57;&#x7B26;&#x3002;&#x8FD9;&#x5C06;&#x5E2E;&#x52A9;&#x60A8;&#x8BA1;&#x7B97;&#x51FA;&#x5728;softmax&#x5C42;&#x7684;&#x6982;&#x7387;&#x5206;&#x5E03;&#x8F93;&#x51FA;&#x4E2D;&#xFF0C;&#x4EC0;&#x4E48;&#x7D22;&#x5F15;&#x5BF9;&#x5E94;&#x4E8E;&#x4EC0;&#x4E48;&#x5B57;&#x7B26;&#x3002;&#x4E0B;&#x9762;&#xFF0C;<code>char_to_ix</code>&#x548C;<code>ix_to_char</code>&#x662F;python&#x5B57;&#x5178;&#x3002;</p>
<pre data-role="codeBlock" data-info="python" class="language-python">char_to_ix <span class="token operator">=</span> <span class="token punctuation">{</span> ch<span class="token punctuation">:</span>i <span class="token keyword">for</span> i<span class="token punctuation">,</span>ch <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span><span class="token builtin">sorted</span><span class="token punctuation">(</span>chars<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
ix_to_char <span class="token operator">=</span> <span class="token punctuation">{</span> i<span class="token punctuation">:</span>ch <span class="token keyword">for</span> i<span class="token punctuation">,</span>ch <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span><span class="token builtin">sorted</span><span class="token punctuation">(</span>chars<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ix_to_char<span class="token punctuation">)</span>
</pre><h4 class="mume-header" id="%E7%BB%93%E6%9E%9C-1">&#x7ED3;&#x679C;</h4>

<pre data-role="codeBlock" data-info class="language-"><code>{0: &apos;\n&apos;, 1: &apos;a&apos;, 2: &apos;b&apos;, 3: &apos;c&apos;, 4: &apos;d&apos;, 5: &apos;e&apos;, 6: &apos;f&apos;, 7: &apos;g&apos;, 8: &apos;h&apos;, 9: &apos;i&apos;, 10: &apos;j&apos;, 11: &apos;k&apos;, 12: &apos;l&apos;, 13: &apos;m&apos;, 14: &apos;n&apos;, 15: &apos;o&apos;, 16: &apos;p&apos;, 17: &apos;q&apos;, 18: &apos;r&apos;, 19: &apos;s&apos;, 20: &apos;t&apos;, 21: &apos;u&apos;, 22: &apos;v&apos;, 23: &apos;w&apos;, 24: &apos;x&apos;, 25: &apos;y&apos;, 26: &apos;z&apos;}
</code></pre><h3 class="mume-header" id="%E6%A8%A1%E5%9E%8B%E6%A6%82%E8%BF%B0">&#x6A21;&#x578B;&#x6982;&#x8FF0;</h3>

<p>&#x60A8;&#x7684;&#x6A21;&#x578B;&#x5C06;&#x5177;&#x6709;&#x4EE5;&#x4E0B;&#x7ED3;&#x6784;:</p>
<ul>
<li>
<p>&#x521D;&#x59CB;&#x5316;&#x53C2;&#x6570;</p>
</li>
<li>
<p>&#x8FD0;&#x884C;&#x4F18;&#x5316;&#x5FAA;&#x73AF;</p>
</li>
<li>
<p>&#x6B63;&#x5411;&#x4F20;&#x64AD;&#x8BA1;&#x7B97;&#x635F;&#x8017;&#x51FD;&#x6570;</p>
</li>
<li>
<p>&#x53CD;&#x5411;&#x4F20;&#x64AD;&#x8BA1;&#x7B97;&#x5173;&#x4E8E;&#x635F;&#x5931;&#x51FD;&#x6570;&#x7684;&#x68AF;&#x5EA6;</p>
</li>
<li>
<p>&#x88C1;&#x526A;&#x68AF;&#x5EA6;&#xFF0C;&#x4EE5;&#x907F;&#x514D;&#x7206;&#x70B8;&#x68AF;&#x5EA6;</p>
</li>
<li>
<p>&#x4F7F;&#x7528;&#x68AF;&#x5EA6;&#xFF0C;&#x66F4;&#x65B0;&#x4F60;&#x7684;&#x53C2;&#x6570;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;&#x66F4;&#x65B0;&#x89C4;&#x5219;&#x3002;</p>
</li>
<li>
<p>&#x8FD4;&#x56DE;&#x5B66;&#x4E60;&#x7684;&#x53C2;&#x6570;</p>
</li>
</ul>
<p>&#x5728;&#x6BCF;&#x4E00;&#x4E2A;time-step&#xFF0C;RNN&#x5C1D;&#x8BD5;&#x7ED9;&#x5B9A;&#x4E4B;&#x524D;&#x5B57;&#x7B26;&#x7684;&#x6761;&#x4EF6;&#x4E0B;&#x9884;&#x6D4B;&#x4E0B;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x662F;&#x4EC0;&#x4E48;&#x3002;&#x6570;&#x636E;&#x96C6;<span class="mathjax-exps">$X = (x^{\langle 1 \rangle}, x^{\langle 2 \rangle}, ..., x^{\langle T_x \rangle})$</span>&#x662F;&#x8BAD;&#x7EC3;&#x96C6;&#x4E2D;&#x7684;&#x4E00;&#x7EC4;&#x5B57;&#x7B26;&#xFF0C;&#x800C;&#x662F;<span class="mathjax-exps">$Y = (y^{\langle 1 \rangle}, y^{\langle 2 \rangle}, ..., y^{\langle T_x \rangle})$</span>&#x8FD9;&#x6837;&#x7684;&#xFF0C;&#x5728;&#x6BCF;&#x4E00;&#x4E2A;time-step <span class="mathjax-exps">$t$</span>&#xFF0C;&#x6211;&#x4EEC;&#x6709;<span class="mathjax-exps">$y^{\langle t \rangle} = x^{\langle t+1 \rangle}$</span>&#x3002;</p>
<h2 class="mume-header" id="%E6%9E%84%E5%BB%BA%E6%A8%A1%E5%9D%97">&#x6784;&#x5EFA;&#x6A21;&#x5757;</h2>

<p>&#x5728;&#x672C;&#x90E8;&#x5206;&#x4E2D;&#xFF0C;&#x60A8;&#x5C06;&#x6784;&#x5EFA;&#x6574;&#x4E2A;&#x6A21;&#x578B;&#x7684;&#x4E24;&#x4E2A;&#x91CD;&#x8981;&#x6A21;&#x5757;:</p>
<ul>
<li>
<p>&#x68AF;&#x5EA6;&#x88C1;&#x526A;:&#x907F;&#x514D;&#x7206;&#x70B8;&#x68AF;&#x5EA6;</p>
</li>
<li>
<p>&#x62BD;&#x6837;:&#x7528;&#x4E8E;&#x751F;&#x6210;&#x5B57;&#x7B26;&#x7684;&#x6280;&#x672F;</p>
</li>
</ul>
<p>&#x7136;&#x540E;&#x60A8;&#x5C06;&#x5E94;&#x7528;&#x8FD9;&#x4E24;&#x4E2A;&#x51FD;&#x6570;&#x6765;&#x6784;&#x5EFA;&#x6A21;&#x578B;&#x3002;</p>
<h3 class="mume-header" id="%E8%A3%81%E5%89%AA%E4%BC%98%E5%8C%96%E5%BE%AA%E7%8E%AF%E4%B8%AD%E7%9A%84%E6%A2%AF%E5%BA%A6">&#x88C1;&#x526A;&#x4F18;&#x5316;&#x5FAA;&#x73AF;&#x4E2D;&#x7684;&#x68AF;&#x5EA6;</h3>

<p>&#x5728;&#x672C;&#x8282;&#x4E2D;&#xFF0C;&#x60A8;&#x5C06;&#x5B9E;&#x73B0;&#x5C06;&#x5728;&#x4F18;&#x5316;&#x5FAA;&#x73AF;&#x4E2D;&#x8C03;&#x7528;&#x7684;<code>clip</code>&#x51FD;&#x6570;&#x3002;&#x56DE;&#x60F3;&#x4E00;&#x4E0B;&#xFF0C;&#x60A8;&#x7684;&#x6574;&#x4E2A;&#x5FAA;&#x73AF;&#x7ED3;&#x6784;&#x901A;&#x5E38;&#x7531;&#x6B63;&#x5411;&#x4F20;&#x64AD;&#x3001;&#x6210;&#x672C;&#x8BA1;&#x7B97;&#x3001;&#x53CD;&#x5411;&#x4F20;&#x9012;&#x548C;&#x53C2;&#x6570;&#x66F4;&#x65B0;&#x7EC4;&#x6210;&#x3002;&#x5728;&#x66F4;&#x65B0;&#x53C2;&#x6570;&#x4E4B;&#x524D;&#xFF0C;&#x60A8;&#x5C06;&#x6267;&#x884C;&#x68AF;&#x5EA6;&#x88C1;&#x526A;&#xFF0C;&#x5F53;&#x9700;&#x8981;&#x65F6;&#xFF0C;&#x4EE5;&#x786E;&#x4FDD;&#x60A8;&#x7684;&#x68AF;&#x5EA6;&#x4E0D;&#x662F;&#x201C;&#x7206;&#x70B8;&#x201D;&#xFF0C;&#x5373;&#x91C7;&#x53D6;&#x8FC7;&#x5927;&#x7684;&#x503C;&#x3002;</p>
<p>&#x5728;&#x4E0B;&#x9762;&#x7684;&#x7EC3;&#x4E60;&#x4E2D;&#xFF0C;&#x60A8;&#x5C06;&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x51FD;&#x6570;<code>clip</code>&#xFF0C;&#x5B83;&#x63A5;&#x53D7;&#x4E00;&#x4E2A;&#x68AF;&#x5EA6;&#x5B57;&#x5178;&#x5E76;&#x5728;&#x9700;&#x8981;&#x65F6;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x68AF;&#x5EA6;&#x7684;&#x526A;&#x5207;&#x7248;&#x672C;&#x3002;&#x526A;&#x8F91;&#x6E10;&#x53D8;&#x6709;&#x4E0D;&#x540C;&#x7684;&#x65B9;&#x6CD5;;&#x6211;&#x4EEC;&#x5C06;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x5143;&#x7D20;&#x526A;&#x5207;&#x8FC7;&#x7A0B;&#xFF0C;&#x5176;&#x4E2D;&#x68AF;&#x5EA6;&#x5411;&#x91CF;&#x7684;&#x6BCF;&#x4E2A;&#x5143;&#x7D20;&#x90FD;&#x88AB;&#x526A;&#x5207;&#x5230;&#x67D0;&#x4E2A;&#x8303;&#x56F4;[-N, N]&#x4E4B;&#x95F4;&#x3002;&#x66F4;&#x4E00;&#x822C;&#x5730;&#xFF0C;&#x60A8;&#x5C06;&#x63D0;&#x4F9B;&#x4E00;&#x4E2A;<code>maxValue</code>(&#x6BD4;&#x5982;10)&#x3002;&#x5728;&#x8FD9;&#x4E2A;&#x4F8B;&#x5B50;&#x4E2D;&#xFF0C;&#x5982;&#x679C;&#x68AF;&#x5EA6;&#x5411;&#x91CF;&#x7684;&#x4EFB;&#x4F55;&#x4E00;&#x4E2A;&#x5206;&#x91CF;&#x5927;&#x4E8E;10&#xFF0C;&#x5B83;&#x5C06;&#x88AB;&#x8BBE;&#x4E3A;10;&#x5982;&#x679C;&#x68AF;&#x5EA6;&#x5411;&#x91CF;&#x7684;&#x4EFB;&#x4F55;&#x4E00;&#x4E2A;&#x5206;&#x91CF;&#x5C0F;&#x4E8E;-10&#xFF0C;&#x5B83;&#x5C31;&#x4F1A;&#x88AB;&#x8BBE;&#x4E3A;-10&#x3002;&#x5982;&#x679C;&#x5B83;&#x5728;-10&#x548C;10&#x4E4B;&#x95F4;&#xFF0C;&#x5B83;&#x5C31;&#x4E0D;&#x53D7;&#x5F71;&#x54CD;&#x3002;</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment">### GRADED FUNCTION: clip</span>

<span class="token keyword">def</span> <span class="token function">clip</span><span class="token punctuation">(</span>gradients<span class="token punctuation">,</span> maxValue<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&apos;&apos;&apos;
    Clips the gradients&apos; values between minimum and maximum.
    
    Arguments:
    gradients -- a dictionary containing the gradients &quot;dWaa&quot;, &quot;dWax&quot;, &quot;dWya&quot;, &quot;db&quot;, &quot;dby&quot;
    maxValue -- everything above this number is set to this number, and everything less than -maxValue is set to -maxValue
    
    Returns: 
    gradients -- a dictionary with the clipped gradients.
    &apos;&apos;&apos;</span>
    
    <span class="token comment">### START CODE HERE ###</span>
    <span class="token comment"># &#x88C1;&#x526A;&#x4EE5;&#x51CF;&#x8F7B;&#x7206;&#x70B8;&#x68AF;&#x5EA6; (&#x2248;2 lines)</span>
    
    clipped_gradients <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">for</span> g <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string">&apos;dWax&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;dWaa&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;dWya&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;db&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;dby&apos;</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        clipped_gradients<span class="token punctuation">[</span>g<span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>clip<span class="token punctuation">(</span>gradients<span class="token punctuation">[</span>g<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">-</span>maxValue<span class="token punctuation">,</span> maxValue<span class="token punctuation">)</span>
    <span class="token comment">### END CODE HERE ###</span>
    
    <span class="token keyword">return</span> clipped_gradients
</pre><h4 class="mume-header" id="%E6%B5%8B%E8%AF%95">&#x6D4B;&#x8BD5;</h4>

<pre data-role="codeBlock" data-info="python" class="language-python">np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
dWax <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">10</span>
dWaa <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">10</span>
dWya <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">10</span>
db <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">10</span>
dby <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">10</span>
gradients <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;dWax&quot;</span><span class="token punctuation">:</span> dWax<span class="token punctuation">,</span> <span class="token string">&quot;dWaa&quot;</span><span class="token punctuation">:</span> dWaa<span class="token punctuation">,</span> <span class="token string">&quot;dWya&quot;</span><span class="token punctuation">:</span> dWya<span class="token punctuation">,</span> <span class="token string">&quot;db&quot;</span><span class="token punctuation">:</span> db<span class="token punctuation">,</span> <span class="token string">&quot;dby&quot;</span><span class="token punctuation">:</span> dby<span class="token punctuation">}</span>
gradients <span class="token operator">=</span> clip<span class="token punctuation">(</span>gradients<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;gradients[\&quot;dWaa\&quot;][1][2] =&quot;</span><span class="token punctuation">,</span> gradients<span class="token punctuation">[</span><span class="token string">&quot;dWaa&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;gradients[\&quot;dWax\&quot;][3][1] =&quot;</span><span class="token punctuation">,</span> gradients<span class="token punctuation">[</span><span class="token string">&quot;dWax&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;gradients[\&quot;dWya\&quot;][1][2] =&quot;</span><span class="token punctuation">,</span> gradients<span class="token punctuation">[</span><span class="token string">&quot;dWya&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;gradients[\&quot;db\&quot;][4] =&quot;</span><span class="token punctuation">,</span> gradients<span class="token punctuation">[</span><span class="token string">&quot;db&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;gradients[\&quot;dby\&quot;][1] =&quot;</span><span class="token punctuation">,</span> gradients<span class="token punctuation">[</span><span class="token string">&quot;dby&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</pre><h4 class="mume-header" id="%E7%BB%93%E6%9E%9C-2">&#x7ED3;&#x679C;</h4>

<pre data-role="codeBlock" data-info class="language-"><code>gradients[&quot;dWaa&quot;][1][2] = 10.0
gradients[&quot;dWax&quot;][3][1] = -10.0
gradients[&quot;dWya&quot;][1][2] = 0.2971381536101662
gradients[&quot;db&quot;][4] = [10.]
gradients[&quot;dby&quot;][1] = [8.45833407]
</code></pre><h3 class="mume-header" id="%E9%87%87%E6%A0%B7">&#x91C7;&#x6837;</h3>

<p>&#x5B9E;&#x73B0;&#x4E0B;&#x9762;&#x7684;&#x201C;sample&#x201D;&#x51FD;&#x6570;&#x6765;&#x5BF9;&#x5B57;&#x7B26;&#x8FDB;&#x884C;&#x91C7;&#x6837;&#x3002;&#x60A8;&#x9700;&#x8981;&#x6267;&#x884C;4&#x4E2A;&#x6B65;&#x9AA4;:</p>
<ul>
<li>
<p><strong>&#x6B65;&#x9AA4;1</strong>:&#x5411;&#x7F51;&#x7EDC;&#x4F20;&#x9012;&#x7B2C;&#x4E00;&#x4E2A;&#x201C;&#x5047;&#x7684;&#x201D;&#x8F93;&#x5165;<span class="mathjax-exps">$x^{\langle 1 \rangle} = \vec{0}$</span>(&#x96F6;&#x5411;&#x91CF;)&#x8FD9;&#x662F;&#x751F;&#x6210;&#x4EFB;&#x4F55;&#x5B57;&#x7B26;&#x4E4B;&#x524D;&#x7684;&#x9ED8;&#x8BA4;&#x8F93;&#x5165;&#x3002;&#x6211;&#x4EEC;&#x8FD8;&#x8BBE;&#x7F6E;<span class="mathjax-exps">$a^{\langle 0 \rangle} = \vec{0}$</span></p>
</li>
<li>
<p><strong>&#x6B65;&#x9AA4;2</strong>:&#x8FD0;&#x884C;&#x4E00;&#x6B65;&#x6B63;&#x5411;&#x4F20;&#x64AD;&#xFF0C;&#x4EE5;&#x83B7;&#x5F97;<span class="mathjax-exps">$a^{\langle 1 \rangle}$</span>&#x548C;<span class="mathjax-exps">$\hat{y}^{\langle 1 \rangle}$</span>&#x3002;&#x65B9;&#x7A0B;&#x5982;&#x4E0B;:</p>
</li>
</ul>
<p></p><div class="mathjax-exps">$$a^{\langle t+1 \rangle} = \tanh(W_{ax}  x^{\langle t \rangle } + W_{aa} a^{\langle t \rangle } + b)$$</div><p></p>
<p></p><div class="mathjax-exps">$$z^{\langle t + 1 \rangle } = W_{ya}  a^{\langle t + 1 \rangle } + b_y$$</div><p></p>
<p></p><div class="mathjax-exps">$$\hat{y}^{\langle t+1 \rangle } = softmax(z^{\langle t + 1 \rangle })$$</div><p></p>
<p><strong>&#x6CE8;&#x610F;</strong>&#xFF0C;<span class="mathjax-exps">$\hat{y}^{\langle t+1 \rangle}$</span>&#x662F;&#x4E00;&#x4E2A;(softmax)&#x6982;&#x7387;&#x5411;&#x91CF;(&#x5B83;&#x7684;&#x5206;&#x91CF;&#x5728;0&#x548C;1&#x4E4B;&#x95F4;&#x5E76;&#x4E14;&#x548C;&#x4E3A;1). <span class="mathjax-exps">$\hat{y}^{\langle t+1 \rangle}_i$</span>&#x8868;&#x793A;&#x7531;&#x201C;i&#x201D;&#x7D22;&#x5F15;&#x7684;&#x5B57;&#x7B26;&#x662F;&#x4E0B;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x7684;&#x6982;&#x7387;&#x3002;</p>
<ul>
<li><strong>&#x6B65;&#x9AA4;3</strong>:&#x6267;&#x884C;&#x62BD;&#x6837;:&#x6839;&#x636E;<span class="mathjax-exps">$\hat{y}^{\langle t+1 \rangle}$</span>&#x6307;&#x5B9A;&#x7684;&#x6982;&#x7387;&#x5206;&#x5E03;&#x9009;&#x62E9;&#x4E0B;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x7684;&#x7D22;&#x5F15;&#x3002;&#x8FD9;&#x610F;&#x5473;&#x7740;&#xFF0C;&#x5982;&#x679C;<span class="mathjax-exps">$\hat{y}^{\langle t+1 \rangle}_i = 0.16$</span>&#xFF0C;&#x60A8;&#x5C06;&#x4EE5;16%&#x7684;&#x6982;&#x7387;&#x9009;&#x62E9;&#x7D22;&#x5F15;&#x201C;i&#x201D;&#x3002;&#x8981;&#x5B9E;&#x73B0;&#x5B83;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<a href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.random.choice.html">&apos; np.random.choice &apos;</a>&#x3002;</li>
</ul>
<p>&#x4E0B;&#x9762;&#x662F;&#x4E00;&#x4E2A;&#x5982;&#x4F55;&#x4F7F;&#x7528;<code>np.random.choice()</code>&#x7684;&#x4F8B;&#x5B50;:</p>
<pre data-role="codeBlock" data-info="python" class="language-python">np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
p <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.7</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
index <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> p <span class="token operator">=</span> p<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</pre><p>&#x8FD9;&#x610F;&#x5473;&#x7740;&#x4F60;&#x5C06;&#x6839;&#x636E;&#x5206;&#x5E03;&#x9009;&#x62E9;<code>index</code>:<br>
<span class="mathjax-exps">$P(index = 0) = 0.1, P(index = 1) = 0.0, P(index = 2) = 0.7, P(index = 3) = 0.2$</span>&#x3002;</p>
<ul>
<li><strong>&#x6B65;&#x9AA4;4</strong>:&#x5728;<code>sample()</code>&#x4E2D;&#x5B9E;&#x73B0;&#x7684;&#x6700;&#x540E;&#x4E00;&#x6B65;&#x662F;&#x8986;&#x76D6;&#x53D8;&#x91CF;<code>x</code>&#xFF0C;&#x5B83;&#x5F53;&#x524D;&#x5B58;&#x50A8;<span class="mathjax-exps">$x^{\langle t \rangle}$</span>&#xFF0C;&#x5176;&#x503C;&#x4E3A;<span class="mathjax-exps">$x^{\langle t + 1 \rangle}$</span>&#x3002;&#x60A8;&#x5C06;&#x901A;&#x8FC7;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x4E0E;&#x60A8;&#x9009;&#x62E9;&#x4F5C;&#x4E3A;&#x9884;&#x6D4B;&#x7684;&#x5B57;&#x7B26;&#x5BF9;&#x5E94;&#x7684;one-hot&#x5411;&#x91CF;&#x6765;&#x8868;&#x793A;<span class="mathjax-exps">$x^{\langle t + 1 \rangle}$</span>&#x3002;&#x7136;&#x540E;&#xFF0C;&#x5728;&#x6B65;&#x9AA4;1&#x4E2D;&#x5411;&#x524D;&#x4F20;&#x64AD;<span class="mathjax-exps">$x^{\langle t + 1 \rangle}$</span>&#xFF0C;&#x5E76;&#x4E00;&#x76F4;&#x91CD;&#x590D;&#x6B64;&#x8FC7;&#x7A0B;&#xFF0C;&#x76F4;&#x5230;&#x5F97;&#x5230;&#x4E00;&#x4E2A;&#x201C;\n&#x201D;&#x5B57;&#x7B26;&#xFF0C;&#x8868;&#x793A;&#x5DF2;&#x7ECF;&#x5230;&#x8FBE;&#x6050;&#x9F99;&#x540D;&#x79F0;&#x7684;&#x672B;&#x5C3E;&#x3002;</li>
</ul>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># GRADED FUNCTION: sample</span>

<span class="token keyword">def</span> <span class="token function">sample</span><span class="token punctuation">(</span>parameters<span class="token punctuation">,</span> char_to_ix<span class="token punctuation">,</span> seed<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    Sample a sequence of characters according to a sequence of probability distributions output of the RNN

    Arguments:
    parameters -- python dictionary containing the parameters Waa, Wax, Wya, by, and b. 
    char_to_ix -- python dictionary mapping each character to an index.
    seed -- used for grading purposes. Do not worry about it.

    Returns:
    indices -- a list of length n containing the indices of the sampled characters.
    &quot;&quot;&quot;</span>
    
    <span class="token comment"># &#x53D6;&#x53C2;</span>
    Waa<span class="token punctuation">,</span> Wax<span class="token punctuation">,</span> Wya<span class="token punctuation">,</span> by<span class="token punctuation">,</span> b <span class="token operator">=</span> parameters<span class="token punctuation">[</span><span class="token string">&apos;Waa&apos;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> parameters<span class="token punctuation">[</span><span class="token string">&apos;Wax&apos;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> parameters<span class="token punctuation">[</span><span class="token string">&apos;Wya&apos;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> parameters<span class="token punctuation">[</span><span class="token string">&apos;by&apos;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> parameters<span class="token punctuation">[</span><span class="token string">&apos;b&apos;</span><span class="token punctuation">]</span>
    vocab_size <span class="token operator">=</span> by<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    n_a <span class="token operator">=</span> Waa<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    
    <span class="token comment">### START CODE HERE ###</span>
    <span class="token comment"># &#x6B65;&#x9AA4; 1: &#x96F6;&#x521D;&#x59CB;&#x5316; one-hot &#x5411;&#x91CF; x &#x4F5C;&#x4E3A;&#x9996;&#x5B57;&#x6BCD; (&#x521D;&#x59CB;&#x5316;&#x5E8F;&#x5217;&#x751F;&#x6210;). (&#x2248;1 line)</span>
    x <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>vocab_size<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># &#x6B65;&#x9AA4; 1&apos;: &#x96F6;&#x521D;&#x59CB;&#x5316; a_prev (&#x2248;1 line)</span>
    a_prev <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>n_a<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    
    <span class="token comment"># &#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x7A7A;&#x7684;&#x7D22;&#x5F15;&#x5217;&#x8868;&#xFF0C;&#x8FD9;&#x4E2A;&#x5217;&#x8868;&#x5C06;&#x5305;&#x542B;&#x8981;&#x751F;&#x6210;&#x7684;&#x5B57;&#x7B26;&#x7684;&#x7D22;&#x5F15;&#x5217;&#x8868; (&#x2248;1 line)</span>
    indices <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    
    <span class="token comment"># Idx&#x662F;&#x4E00;&#x4E2A;&#x7528;&#x6765;&#x68C0;&#x6D4B;&#x6362;&#x884C;&#x7B26;&#x7684;&#x6807;&#x5FD7;&#xFF0C;&#x6211;&#x4EEC;&#x628A;&#x5B83;&#x521D;&#x59CB;&#x5316;&#x4E3A;-1</span>
    idx <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span> 
    
    <span class="token comment"># &#x5FAA;&#x73AF;time-step t&#x3002;&#x5728;&#x6BCF;&#x4E2A;time-step&#xFF0C;&#x4ECE;&#x6982;&#x7387;&#x5206;&#x5E03;&#x4E2D;&#x62BD;&#x53D6;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x5E76;&#x6DFB;&#x52A0;&#x5B83;&#x7684;&#x7D22;&#x5F15;&#x5230;&#x201C;indices&#x201D;&#x3002;</span>
    <span class="token comment">#&#x5982;&#x679C;&#x8FBE;&#x5230;50&#x4E2A;&#x5B57;&#x7B26;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x505C;&#x6B62;(&#x5728;&#x8BAD;&#x7EC3;&#x5F97;&#x5F88;&#x597D;&#x7684;&#x6A21;&#x578B;&#x4E2D;&#x662F;&#x975E;&#x5E38;&#x4E0D;&#x53EF;&#x80FD;&#x7684;)&#x8FD9;&#x6709;&#x52A9;&#x4E8E;&#x8C03;&#x8BD5;&#xFF0C;&#x5E76;&#x9632;&#x6B62;&#x8FDB;&#x5165;&#x65E0;&#x9650;&#x5FAA;&#x73AF;&#x3002; </span>
    counter <span class="token operator">=</span> <span class="token number">0</span>
    newline_character <span class="token operator">=</span> char_to_ix<span class="token punctuation">[</span><span class="token string">&apos;\n&apos;</span><span class="token punctuation">]</span>
    
    <span class="token keyword">while</span> <span class="token punctuation">(</span>idx <span class="token operator">!=</span> newline_character <span class="token keyword">and</span> counter <span class="token operator">!=</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        
        <span class="token comment"># &#x6B65;&#x9AA4; 2: &#x6B63;&#x5411;&#x4F20;&#x64AD;x</span>
        a <span class="token operator">=</span> np<span class="token punctuation">.</span>tanh<span class="token punctuation">(</span>np<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>Wax<span class="token punctuation">,</span> x<span class="token punctuation">)</span> <span class="token operator">+</span> np<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>Waa<span class="token punctuation">,</span> a_prev<span class="token punctuation">)</span> <span class="token operator">+</span> b<span class="token punctuation">)</span>
        z <span class="token operator">=</span> np<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>Wya<span class="token punctuation">,</span> a<span class="token punctuation">)</span> <span class="token operator">+</span> by
        y <span class="token operator">=</span> softmax<span class="token punctuation">(</span>z<span class="token punctuation">)</span>
        
        <span class="token comment"># &#x4E3A;&#x4E86;&#x9010;&#x6E10;&#x53D8;&#x5316;</span>
        np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span>counter<span class="token operator">+</span>seed<span class="token punctuation">)</span> 
        
        <span class="token comment"># &#x6B65;&#x9AA4; 3: &#x4ECE;&#x6982;&#x7387;&#x5206;&#x5E03;y&#x4E2D;&#x62BD;&#x53D6;&#x8BCD;&#x6C47;&#x8868;&#x4E2D;&#x5B57;&#x7B26;&#x7684;&#x7D22;&#x5F15;</span>
        idx <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span>vocab_size<span class="token punctuation">)</span><span class="token punctuation">,</span> p<span class="token operator">=</span>y<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        <span class="token comment"># &#x6DFB;&#x52A0; index &#x5230; &quot;indices&quot;</span>
        indices<span class="token punctuation">.</span>append<span class="token punctuation">(</span>idx<span class="token punctuation">)</span>
        
        <span class="token comment"># &#x6B65;&#x9AA4; 4: &#x5C06;&#x8F93;&#x5165;&#x5B57;&#x7B26;&#x6539;&#x5199;&#x4E3A;&#x4E0E;&#x62BD;&#x6837;&#x7D22;&#x5F15;&#x5BF9;&#x5E94;&#x7684;&#x5B57;&#x7B26;&#x3002;</span>
        x <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>vocab_size<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        x<span class="token punctuation">[</span>idx<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
        
        <span class="token comment"># &#x66F4;&#x65B0; &quot;a_prev&quot; &#x4E3A; &quot;a&quot;</span>
        a_prev <span class="token operator">=</span> a
        
        <span class="token comment"># &#x4E3A;&#x4E86;&#x9010;&#x6E10;&#x53D8;&#x5316;</span>
        seed <span class="token operator">+=</span> <span class="token number">1</span>
        counter <span class="token operator">+=</span><span class="token number">1</span>
        
    <span class="token comment">### END CODE HERE ###</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>counter <span class="token operator">==</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        indices<span class="token punctuation">.</span>append<span class="token punctuation">(</span>char_to_ix<span class="token punctuation">[</span><span class="token string">&apos;\n&apos;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    
    <span class="token keyword">return</span> indices
</pre><h4 class="mume-header" id="%E6%B5%8B%E8%AF%95-1">&#x6D4B;&#x8BD5;</h4>

<pre data-role="codeBlock" data-info="python" class="language-python">np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
_<span class="token punctuation">,</span> n_a <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">100</span>
Wax<span class="token punctuation">,</span> Waa<span class="token punctuation">,</span> Wya <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span>n_a<span class="token punctuation">,</span> vocab_size<span class="token punctuation">)</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span>n_a<span class="token punctuation">,</span> n_a<span class="token punctuation">)</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span>vocab_size<span class="token punctuation">,</span> n_a<span class="token punctuation">)</span>
b<span class="token punctuation">,</span> by <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span>n_a<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span>vocab_size<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
parameters <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;Wax&quot;</span><span class="token punctuation">:</span> Wax<span class="token punctuation">,</span> <span class="token string">&quot;Waa&quot;</span><span class="token punctuation">:</span> Waa<span class="token punctuation">,</span> <span class="token string">&quot;Wya&quot;</span><span class="token punctuation">:</span> Wya<span class="token punctuation">,</span> <span class="token string">&quot;b&quot;</span><span class="token punctuation">:</span> b<span class="token punctuation">,</span> <span class="token string">&quot;by&quot;</span><span class="token punctuation">:</span> by<span class="token punctuation">}</span>


indices <span class="token operator">=</span> sample<span class="token punctuation">(</span>parameters<span class="token punctuation">,</span> char_to_ix<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Sampling:&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;list of sampled indices:&quot;</span><span class="token punctuation">,</span> indices<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;list of sampled characters:&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>ix_to_char<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> indices<span class="token punctuation">]</span><span class="token punctuation">)</span>
</pre><h4 class="mume-header" id="%E7%BB%93%E6%9E%9C-3">&#x7ED3;&#x679C;</h4>

<pre data-role="codeBlock" data-info class="language-"><code>Sampling:
list of sampled indices: [12, 17, 24, 14, 13, 9, 10, 22, 24, 6, 13, 11, 12, 6, 21, 15, 21, 14, 3, 2, 1, 21, 18, 24, 7, 25, 6, 25, 18, 10, 16, 2, 3, 8, 15, 12, 11, 7, 1, 12, 10, 2, 7, 7, 11, 17, 24, 1, 13, 0, 0]
list of sampled characters: [&apos;l&apos;, &apos;q&apos;, &apos;x&apos;, &apos;n&apos;, &apos;m&apos;, &apos;i&apos;, &apos;j&apos;, &apos;v&apos;, &apos;x&apos;, &apos;f&apos;, &apos;m&apos;, &apos;k&apos;, &apos;l&apos;, &apos;f&apos;, &apos;u&apos;, &apos;o&apos;, &apos;u&apos;, &apos;n&apos;, &apos;c&apos;, &apos;b&apos;, &apos;a&apos;, &apos;u&apos;, &apos;r&apos;, &apos;x&apos;, &apos;g&apos;, &apos;y&apos;, &apos;f&apos;, &apos;y&apos;, &apos;r&apos;, &apos;j&apos;, &apos;p&apos;, &apos;b&apos;, &apos;c&apos;, &apos;h&apos;, &apos;o&apos;, &apos;l&apos;, &apos;k&apos;, &apos;g&apos;, &apos;a&apos;, &apos;l&apos;, &apos;j&apos;, &apos;b&apos;, &apos;g&apos;, &apos;g&apos;, &apos;k&apos;, &apos;q&apos;, &apos;x&apos;, &apos;a&apos;, &apos;m&apos;, &apos;\n&apos;, &apos;\n&apos;]
</code></pre><h2 class="mume-header" id="%E6%9E%84%E5%BB%BA%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B">&#x6784;&#x5EFA;&#x8BED;&#x8A00;&#x6A21;&#x578B;</h2>

<p>&#x73B0;&#x5728;&#x662F;&#x65F6;&#x5019;&#x6784;&#x5EFA;&#x7528;&#x4E8E;&#x6587;&#x672C;&#x751F;&#x6210;&#x7684;&#x5B57;&#x7B26;&#x7EA7;&#x8BED;&#x8A00;&#x6A21;&#x578B;&#x4E86;&#x3002;</p>
<h3 class="mume-header" id="%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E4%BC%98%E5%8C%96%E5%99%A8">&#x68AF;&#x5EA6;&#x4E0B;&#x964D;+&#x4F18;&#x5316;&#x5668;</h3>

<p>&#x5728;&#x672C;&#x8282;&#x4E2D;&#xFF0C;&#x60A8;&#x5C06;&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x6267;&#x884C;&#x968F;&#x673A;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;&#x4E00;&#x6B65;(&#x4F7F;&#x7528;&#x88C1;&#x526A;&#x68AF;&#x5EA6;)&#x7684;&#x51FD;&#x6570;&#x3002;&#x4F60;&#x4F1A;&#x4E00;&#x6B21;&#x4E00;&#x4E2A;&#x5730;&#x770B;&#x8BAD;&#x7EC3;&#x4F8B;&#x5B50;&#xFF0C;&#x6240;&#x4EE5;&#x4F18;&#x5316;&#x7B97;&#x6CD5;&#x662F;&#x968F;&#x673A;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;&#x3002;&#x4F5C;&#x4E3A;&#x63D0;&#x9192;&#xFF0C;&#x4EE5;&#x4E0B;&#x662F;&#x4E00;&#x4E2A;&#x5E38;&#x89C1;&#x7684;RNN&#x4F18;&#x5316;&#x5FAA;&#x73AF;&#x7684;&#x6B65;&#x9AA4;:</p>
<ul>
<li>
<p>&#x901A;&#x8FC7;RNN&#x5411;&#x524D;&#x4F20;&#x64AD;&#xFF0C;&#x8BA1;&#x7B97;&#x635F;&#x5931;</p>
</li>
<li>
<p>&#x53CD;&#x5411;&#x4F20;&#x64AD;&#xFF0C;&#x901A;&#x8FC7;time&#x6765;&#x8BA1;&#x7B97;&#x6709;&#x5173;&#x53C2;&#x6570;&#x7684;&#x635F;&#x5931;&#x7684;&#x68AF;&#x5EA6;</p>
</li>
<li>
<p>&#x5982;&#x679C;&#x9700;&#x8981;&#x7684;&#x8BDD;&#xFF0C;&#x88C1;&#x526A;&#x68AF;&#x5EA6;</p>
</li>
<li>
<p>&#x4F7F;&#x7528;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;&#x66F4;&#x65B0;&#x53C2;&#x6570;</p>
</li>
</ul>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># GRADED FUNCTION: optimize</span>

<span class="token keyword">def</span> <span class="token function">optimize</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">,</span> a_prev<span class="token punctuation">,</span> parameters<span class="token punctuation">,</span> learning_rate <span class="token operator">=</span> <span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    Execute one step of the optimization to train the model.
    
    Arguments:
    X -- list of integers, where each integer is a number that maps to a character in the vocabulary.
    Y -- list of integers, exactly the same as X but shifted one index to the left.
    a_prev -- previous hidden state.
    parameters -- python dictionary containing:
                        Wax -- Weight matrix multiplying the input, numpy array of shape (n_a, n_x)
                        Waa -- Weight matrix multiplying the hidden state, numpy array of shape (n_a, n_a)
                        Wya -- Weight matrix relating the hidden-state to the output, numpy array of shape (n_y, n_a)
                        b --  Bias, numpy array of shape (n_a, 1)
                        by -- Bias relating the hidden-state to the output, numpy array of shape (n_y, 1)
    learning_rate -- learning rate for the model.
    
    Returns:
    loss -- value of the loss function (cross-entropy)
    gradients -- python dictionary containing:
                        dWax -- Gradients of input-to-hidden weights, of shape (n_a, n_x)
                        dWaa -- Gradients of hidden-to-hidden weights, of shape (n_a, n_a)
                        dWya -- Gradients of hidden-to-output weights, of shape (n_y, n_a)
                        db -- Gradients of bias vector, of shape (n_a, 1)
                        dby -- Gradients of output bias vector, of shape (n_y, 1)
    a[len(X)-1] -- the last hidden state, of shape (n_a, 1)
    &quot;&quot;&quot;</span>
    
    <span class="token comment">### START CODE HERE ###</span>
    
    <span class="token comment"># &#x901A;&#x8FC7; time &#x6B63;&#x5411;&#x4F20;&#x64AD;(&#x2248;1 line)</span>
    loss<span class="token punctuation">,</span> cache <span class="token operator">=</span> rnn_forward<span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">,</span> a_prev<span class="token punctuation">,</span> parameters<span class="token punctuation">)</span>
    
    <span class="token comment"># &#x901A;&#x8FC7; time &#x53CD;&#x5411;&#x4F20;&#x64AD; (&#x2248;1 line)</span>
    gradients<span class="token punctuation">,</span> a <span class="token operator">=</span> rnn_backward<span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">,</span> parameters<span class="token punctuation">,</span> cache<span class="token punctuation">)</span>
    
    <span class="token comment"># &#x68AF;&#x5EA6;&#x88C1;&#x526A; (&#x2248;1 line)</span>
    gradients <span class="token operator">=</span> clip<span class="token punctuation">(</span>gradients<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
    
    <span class="token comment"># &#x66F4;&#x65B0;&#x53C2;&#x6570; (&#x2248;1 line)</span>
    parameters <span class="token operator">=</span> update_parameters<span class="token punctuation">(</span>parameters<span class="token punctuation">,</span> gradients<span class="token punctuation">,</span> learning_rate<span class="token punctuation">)</span>
    
    <span class="token comment">### END CODE HERE ###</span>
    
    <span class="token keyword">return</span> loss<span class="token punctuation">,</span> gradients<span class="token punctuation">,</span> a<span class="token punctuation">[</span><span class="token builtin">len</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
</pre><h4 class="mume-header" id="%E6%B5%8B%E8%AF%95-2">&#x6D4B;&#x8BD5;</h4>

<pre data-role="codeBlock" data-info="python" class="language-python">np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
vocab_size<span class="token punctuation">,</span> n_a <span class="token operator">=</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">100</span>
a_prev <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span>n_a<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
Wax<span class="token punctuation">,</span> Waa<span class="token punctuation">,</span> Wya <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span>n_a<span class="token punctuation">,</span> vocab_size<span class="token punctuation">)</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span>n_a<span class="token punctuation">,</span> n_a<span class="token punctuation">)</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span>vocab_size<span class="token punctuation">,</span> n_a<span class="token punctuation">)</span>
b<span class="token punctuation">,</span> by <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span>n_a<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span>vocab_size<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
parameters <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;Wax&quot;</span><span class="token punctuation">:</span> Wax<span class="token punctuation">,</span> <span class="token string">&quot;Waa&quot;</span><span class="token punctuation">:</span> Waa<span class="token punctuation">,</span> <span class="token string">&quot;Wya&quot;</span><span class="token punctuation">:</span> Wya<span class="token punctuation">,</span> <span class="token string">&quot;b&quot;</span><span class="token punctuation">:</span> b<span class="token punctuation">,</span> <span class="token string">&quot;by&quot;</span><span class="token punctuation">:</span> by<span class="token punctuation">}</span>
X <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span>
Y <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">]</span>

loss<span class="token punctuation">,</span> gradients<span class="token punctuation">,</span> a_last <span class="token operator">=</span> optimize<span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">,</span> a_prev<span class="token punctuation">,</span> parameters<span class="token punctuation">,</span> learning_rate <span class="token operator">=</span> <span class="token number">0.01</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Loss =&quot;</span><span class="token punctuation">,</span> loss<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;gradients[\&quot;dWaa\&quot;][1][2] =&quot;</span><span class="token punctuation">,</span> gradients<span class="token punctuation">[</span><span class="token string">&quot;dWaa&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;np.argmax(gradients[\&quot;dWax\&quot;]) =&quot;</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>gradients<span class="token punctuation">[</span><span class="token string">&quot;dWax&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;gradients[\&quot;dWya\&quot;][1][2] =&quot;</span><span class="token punctuation">,</span> gradients<span class="token punctuation">[</span><span class="token string">&quot;dWya&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;gradients[\&quot;db\&quot;][4] =&quot;</span><span class="token punctuation">,</span> gradients<span class="token punctuation">[</span><span class="token string">&quot;db&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;gradients[\&quot;dby\&quot;][1] =&quot;</span><span class="token punctuation">,</span> gradients<span class="token punctuation">[</span><span class="token string">&quot;dby&quot;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;a_last[4] =&quot;</span><span class="token punctuation">,</span> a_last<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</pre><h4 class="mume-header" id="%E7%BB%93%E6%9E%9C-4">&#x7ED3;&#x679C;</h4>

<pre data-role="codeBlock" data-info class="language-"><code>Loss = 126.50397572165382
gradients[&quot;dWaa&quot;][1][2] = 0.1947093153471637
np.argmax(gradients[&quot;dWax&quot;]) = 93
gradients[&quot;dWya&quot;][1][2] = -0.007773876032002977
gradients[&quot;db&quot;][4] = [-0.06809825]
gradients[&quot;dby&quot;][1] = [0.01538192]
a_last[4] = [-1.]
</code></pre><h3 class="mume-header" id="%E8%AE%AD%E7%BB%83%E6%A8%A1%E5%9E%8B">&#x8BAD;&#x7EC3;&#x6A21;&#x578B;</h3>

<p>&#x7ED9;&#x5B9A;&#x6050;&#x9F99;&#x540D;&#x79F0;&#x6570;&#x636E;&#x96C6;&#xFF0C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x6570;&#x636E;&#x96C6;&#x7684;&#x6BCF;&#x4E00;&#x884C;(&#x4E00;&#x4E2A;&#x540D;&#x79F0;)&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x8BAD;&#x7EC3;&#x793A;&#x4F8B;&#x3002;&#x6BCF;100&#x6B65;&#x7684;&#x968F;&#x673A;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;&#xFF0C;&#x4F60;&#x4F1A;&#x62BD;&#x53D6;10&#x4E2A;&#x968F;&#x673A;&#x9009;&#x62E9;&#x7684;&#x540D;&#x5B57;&#x6765;&#x89C2;&#x5BDF;&#x7B97;&#x6CD5;&#x7684;&#x8FD0;&#x884C;&#x60C5;&#x51B5;&#x3002;&#x8BB0;&#x4F4F;&#x8981;&#x6253;&#x4E71;&#x6570;&#x636E;&#x96C6;&#xFF0C;&#x4EE5;&#x4FBF;&#x968F;&#x673A;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;&#x4EE5;<strong>&#x968F;&#x673A;&#x987A;&#x5E8F;</strong>&#x8BBF;&#x95EE;&#x793A;&#x4F8B;&#x3002;</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># GRADED FUNCTION: model</span>

<span class="token keyword">def</span> <span class="token function">model</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> ix_to_char<span class="token punctuation">,</span> char_to_ix<span class="token punctuation">,</span> num_iterations <span class="token operator">=</span> <span class="token number">35000</span><span class="token punctuation">,</span> n_a <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">,</span> dino_names <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">,</span> vocab_size <span class="token operator">=</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    Trains the model and generates dinosaur names. 
    
    Arguments:
    data -- text corpus
    ix_to_char -- dictionary that maps the index to a character
    char_to_ix -- dictionary that maps a character to an index
    num_iterations -- number of iterations to train the model for
    n_a -- number of units of the RNN cell
    dino_names -- number of dinosaur names you want to sample at each iteration. 
    vocab_size -- number of unique characters found in the text, size of the vocabulary
    
    Returns:
    parameters -- learned parameters
    &quot;&quot;&quot;</span>
    
    <span class="token comment"># &#x4ECE; vocab_size &#x83B7;&#x53D6; n_x and n_y </span>
    n_x<span class="token punctuation">,</span> n_y <span class="token operator">=</span> vocab_size<span class="token punctuation">,</span> vocab_size
    
    <span class="token comment"># &#x521D;&#x59CB;&#x5316;&#x53C2;&#x6570;</span>
    parameters <span class="token operator">=</span> initialize_parameters<span class="token punctuation">(</span>n_a<span class="token punctuation">,</span> n_x<span class="token punctuation">,</span> n_y<span class="token punctuation">)</span>
    
    <span class="token comment"># &#x521D;&#x59CB;&#x5316;&#x635F;&#x5931;(&#x8FD9;&#x662F;&#x5FC5;&#x9700;&#x7684;&#xFF0C;&#x56E0;&#x4E3A;&#x6211;&#x4EEC;&#x60F3;&#x5E73;&#x6ED1;&#x635F;&#x5931;&#xFF0C;&#x4E0D;&#x7528;&#x62C5;&#x5FC3;)</span>
    loss <span class="token operator">=</span> get_initial_loss<span class="token punctuation">(</span>vocab_size<span class="token punctuation">,</span> dino_names<span class="token punctuation">)</span>
    
    <span class="token comment"># &#x6784;&#x5EFA;&#x6240;&#x6709;&#x6050;&#x9F99;&#x540D;&#x79F0;&#x7684;&#x5217;&#x8868;(&#x8BAD;&#x7EC3;&#x793A;&#x4F8B;)&#x3002;</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&quot;dinos.txt&quot;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        examples <span class="token operator">=</span> f<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>
    examples <span class="token operator">=</span> <span class="token punctuation">[</span>x<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> examples<span class="token punctuation">]</span>
    
    <span class="token comment"># &#x968F;&#x673A;&#x5316;&#x6240;&#x6709;&#x6050;&#x9F99;&#x7684;&#x540D;&#x5B57;</span>
    np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
    np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>examples<span class="token punctuation">)</span>
    
    <span class="token comment"># &#x521D;&#x59CB;&#x5316;LSTM&#x7684;&#x9690;&#x85CF;&#x72B6;&#x6001;</span>
    a_prev <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>n_a<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    
    <span class="token comment">#&#x4F18;&#x5316;&#x5FAA;&#x73AF;</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_iterations<span class="token punctuation">)</span><span class="token punctuation">:</span>
        
        <span class="token comment">### START CODE HERE ###</span>
        
        <span class="token comment"># &#x4F7F;&#x7528;&#x4E0A;&#x9762;&#x7684;&#x63D0;&#x793A;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x8BAD;&#x7EC3;&#x793A;&#x4F8B;(X,Y) (&#x2248; 2 lines)</span>
        index <span class="token operator">=</span> j <span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>examples<span class="token punctuation">)</span>
        X <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token boolean">None</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">[</span>char_to_ix<span class="token punctuation">[</span>ch<span class="token punctuation">]</span> <span class="token keyword">for</span> ch <span class="token keyword">in</span> examples<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">]</span> 
        Y <span class="token operator">=</span> X<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">[</span>char_to_ix<span class="token punctuation">[</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
        
        <span class="token comment"># &#x6267;&#x884C;&#x4E00;&#x4E2A;&#x4F18;&#x5316;&#x6B65;&#x9AA4;:&#x6B63;&#x5411;&#x4F20;&#x64AD; -&gt;&#x53CD;&#x5411;&#x4F20;&#x64AD; -&gt;&#x68AF;&#x5EA6;&#x88C1;&#x526A;-&gt;&#x66F4;&#x65B0;&#x53C2;&#x6570;</span>
        <span class="token comment"># &#x9009;&#x62E9;&#x5B66;&#x4E60;&#x7387;&#x4E3A; 0.01</span>
        curr_loss<span class="token punctuation">,</span> gradients<span class="token punctuation">,</span> a_prev <span class="token operator">=</span> optimize<span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">,</span> a_prev<span class="token punctuation">,</span> parameters<span class="token punctuation">)</span>
        
        <span class="token comment">### END CODE HERE ###</span>
        
        <span class="token comment"># &#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x5EF6;&#x8FDF;&#x6280;&#x5DE7;&#x6765;&#x4FDD;&#x6301;&#x5E73;&#x6ED1;&#x7684;&#x635F;&#x5931;&#x3002;&#x8FD9;&#x662F;&#x4E3A;&#x4E86;&#x52A0;&#x901F;&#x8BAD;&#x7EC3;&#x3002;</span>
        loss <span class="token operator">=</span> smooth<span class="token punctuation">(</span>loss<span class="token punctuation">,</span> curr_loss<span class="token punctuation">)</span>

        <span class="token comment"># &#x6BCF;2000&#x6B21;&#x8FED;&#x4EE3;&#xFF0C;&#x901A;&#x8FC7;sample()&#x751F;&#x6210;n&#x4E2A;&#x5B57;&#x7B26;&#xFF0C;&#x4EE5;&#x68C0;&#x67E5;&#x6A21;&#x578B;&#x662F;&#x5426;&#x6B63;&#x786E;&#x5B66;&#x4E60;</span>
        <span class="token keyword">if</span> j <span class="token operator">%</span> <span class="token number">2000</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&apos;Iteration: %d, Loss: %f&apos;</span> <span class="token operator">%</span> <span class="token punctuation">(</span>j<span class="token punctuation">,</span> loss<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&apos;\n&apos;</span><span class="token punctuation">)</span>
            
            <span class="token comment"># &#x8981;&#x6253;&#x5370;&#x7684;&#x6050;&#x9F99;&#x540D;&#x5B57;&#x7684;&#x6570;&#x91CF;</span>
            seed <span class="token operator">=</span> <span class="token number">0</span>
            <span class="token keyword">for</span> name <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>dino_names<span class="token punctuation">)</span><span class="token punctuation">:</span>
                
                <span class="token comment"># &#x6253;&#x5370;&#x6837;&#x672C;&#x7D22;&#x5F15;</span>
                sampled_indices <span class="token operator">=</span> sample<span class="token punctuation">(</span>parameters<span class="token punctuation">,</span> char_to_ix<span class="token punctuation">,</span> seed<span class="token punctuation">)</span>
                print_sample<span class="token punctuation">(</span>sampled_indices<span class="token punctuation">,</span> ix_to_char<span class="token punctuation">)</span>
                
                seed <span class="token operator">+=</span> <span class="token number">1</span>  <span class="token comment"># &#x4E3A;&#x4E86;&#x8FBE;&#x5230;&#x540C;&#x6837;&#x7684;&#x9010;&#x6E10;&#x79FB;&#x52A8;&#x76EE;&#x7684;&#xFF0C;&#x5C06;&#x79CD;&#x5B50;&#x589E;&#x52A0;&#x4E00;&#x3002;</span>
      
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&apos;\n&apos;</span><span class="token punctuation">)</span>
        
    <span class="token keyword">return</span> parameters
</pre><p>&#x8FD0;&#x884C;&#x4EE5;&#x4E0B;&#x5355;&#x5143;&#x683C;&#xFF0C;&#x60A8;&#x5E94;&#x8BE5;&#x89C2;&#x5BDF;&#x6A21;&#x578B;&#x5728;&#x7B2C;&#x4E00;&#x6B21;&#x8FED;&#x4EE3;&#x65F6;&#x8F93;&#x51FA;&#x968F;&#x673A;&#x5916;&#x89C2;&#x7684;&#x5B57;&#x7B26;&#x3002;&#x7ECF;&#x8FC7;&#x51E0;&#x5343;&#x6B21;&#x8FED;&#x4EE3;&#x4E4B;&#x540E;&#xFF0C;&#x60A8;&#x7684;&#x6A21;&#x578B;&#x5E94;&#x8BE5;&#x5B66;&#x4F1A;&#x751F;&#x6210;&#x5916;&#x89C2;&#x5408;&#x7406;&#x7684;&#x540D;&#x79F0;&#x3002;</p>
<pre data-role="codeBlock" data-info="python" class="language-python">parameters <span class="token operator">=</span> model<span class="token punctuation">(</span>data<span class="token punctuation">,</span> ix_to_char<span class="token punctuation">,</span> char_to_ix<span class="token punctuation">)</span>
</pre><h4 class="mume-header" id="%E7%BB%93%E6%9E%9C-5">&#x7ED3;&#x679C;</h4>

<pre data-role="codeBlock" data-info class="language-"><code>Iteration: 0, Loss: 23.087336

Nkzxwtdmfqoeyhsqwasjkjvu
Kneb
Kzxwtdmfqoeyhsqwasjkjvu
Neb
Zxwtdmfqoeyhsqwasjkjvu
Eb
Xwtdmfqoeyhsqwasjkjvu


Iteration: 2000, Loss: 27.884160

Liusskeomnolxeros
Hmdaairus
Hytroligoraurus
Lecalosapaus
Xusicikoraurus
Abalpsamantisaurus
Tpraneronxeros


Iteration: 4000, Loss: 25.901815

Mivrosaurus
Inee
Ivtroplisaurus
Mbaaisaurus
Wusichisaurus
Cabaselachus
Toraperlethosdarenitochusthiamamumamaon


Iteration: 6000, Loss: 24.608779

Onwusceomosaurus
Lieeaerosaurus
Lxussaurus
Oma
Xusteonosaurus
Eeahosaurus
Toreonosaurus


Iteration: 8000, Loss: 24.070350

Onxusichepriuon
Kilabersaurus
Lutrodon
Omaaerosaurus
Xutrcheps
Edaksoje
Trodiktonus


Iteration: 10000, Loss: 23.844446

Onyusaurus
Klecalosaurus
Lustodon
Ola
Xusodonia
Eeaeosaurus
Troceosaurus


Iteration: 12000, Loss: 23.291971

Onyxosaurus
Kica
Lustrepiosaurus
Olaagrraiansaurus
Yuspangosaurus
Eealosaurus
Trognesaurus


Iteration: 14000, Loss: 23.382339

Meutromodromurus
Inda
Iutroinatorsaurus
Maca
Yusteratoptititan
Ca
Troclosaurus


Iteration: 16000, Loss: 23.288447

Meuspsangosaurus
Ingaa
Iusosaurus
Macalosaurus
Yushanis
Daalosaurus
Trpandon


Iteration: 18000, Loss: 22.823526

Phytrolonhonyg
Mela
Mustrerasaurus
Peg
Ytronorosaurus
Ehalosaurus
Trolomeehus


Iteration: 20000, Loss: 23.041871

Nousmofonosaurus
Loma
Lytrognatiasaurus
Ngaa
Ytroenetiaudostarmilus
Eiafosaurus
Troenchulunosaurus


Iteration: 22000, Loss: 22.728849

Piutyrangosaurus
Midaa
Myroranisaurus
Pedadosaurus
Ytrodon
Eiadosaurus
Trodoniomusitocorces


Iteration: 24000, Loss: 22.683403

Meutromeisaurus
Indeceratlapsaurus
Jurosaurus
Ndaa
Yusicheropterus
Eiaeropectus
Trodonasaurus


Iteration: 26000, Loss: 22.554523

Phyusaurus
Liceceron
Lyusichenodylus
Pegahus
Yustenhtonthosaurus
Elagosaurus
Trodontonsaurus


Iteration: 28000, Loss: 22.484472

Onyutimaerihus
Koia
Lytusaurus
Ola
Ytroheltorus
Eiadosaurus
Trofiashates


Iteration: 30000, Loss: 22.774404

Phytys
Lica
Lysus
Pacalosaurus
Ytrochisaurus
Eiacosaurus
Trochesaurus


Iteration: 32000, Loss: 22.209473

Mawusaurus
Jica
Lustoia
Macaisaurus
Yusolenqtesaurus
Eeaeosaurus
Trnanatrax


Iteration: 34000, Loss: 22.396744

Mavptokekus
Ilabaisaurus
Itosaurus
Macaesaurus
Yrosaurus
Eiaeosaurus
Trodon


</code></pre><h2 class="mume-header" id="%E7%BB%93%E8%AE%BA">&#x7ED3;&#x8BBA;</h2>

<p>&#x4F60;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#xFF0C;&#x5728;&#x8BAD;&#x7EC3;&#x63A5;&#x8FD1;&#x5C3E;&#x58F0;&#x65F6;&#xFF0C;&#x4F60;&#x7684;&#x7B97;&#x6CD5;&#x5DF2;&#x7ECF;&#x5F00;&#x59CB;&#x751F;&#x6210;&#x6BD4;&#x8F83;&#x53EF;&#x4FE1;&#x7684;&#x6050;&#x9F99;&#x540D;&#x79F0;&#x3002;&#x4E00;&#x5F00;&#x59CB;&#xFF0C;&#x5B83;&#x662F;&#x968F;&#x673A;&#x4EA7;&#x751F;&#x7684;&#x89D2;&#x8272;&#xFF0C;&#x4F46;&#x6700;&#x540E;&#x4F60;&#x4F1A;&#x770B;&#x5230;&#x6050;&#x9F99;&#x7684;&#x540D;&#x5B57;&#x6709;&#x5F88;&#x9177;&#x7684;&#x7ED3;&#x5C3E;&#x3002;&#x60A8;&#x53EF;&#x4EE5;&#x7EE7;&#x7EED;&#x8FD0;&#x884C;&#x8BE5;&#x7B97;&#x6CD5;&#xFF0C;&#x5E76;&#x4F7F;&#x7528;&#x8D85;&#x53C2;&#x6570;&#x6765;&#x67E5;&#x770B;&#x662F;&#x5426;&#x53EF;&#x4EE5;&#x5F97;&#x5230;&#x66F4;&#x597D;&#x7684;&#x7ED3;&#x679C;&#x3002;&#x6211;&#x4EEC;&#x7684;&#x5B9E;&#x73B0;&#x4EA7;&#x751F;&#x4E86;&#x4E00;&#x4E9B;&#x975E;&#x5E38;&#x9177;&#x7684;&#x540D;&#x5B57;&#xFF0C;&#x6BD4;&#x5982;<code>maconucon</code>&#x3001;<code>marloralus</code>&#x548C;<code>macingsersaurus</code>&#x3002;&#x5E0C;&#x671B;&#x4F60;&#x7684;&#x6A21;&#x578B;&#x8FD8;&#x4E86;&#x89E3;&#x5230;&#xFF0C;&#x6050;&#x9F99;&#x7684;&#x540D;&#x5B57;&#x5F80;&#x5F80;&#x4EE5; <code>saurus</code>, <code>don</code>, <code>aura</code>, <code>tor</code>&#x7B49;&#x7ED3;&#x5C3E;&#x3002;</p>
<p>&#x5982;&#x679C;&#x60A8;&#x7684;&#x6A21;&#x578B;&#x751F;&#x6210;&#x4E86;&#x4E00;&#x4E9B;&#x4E0D;&#x9177;&#x7684;&#x540D;&#x79F0;&#xFF0C;&#x4E0D;&#x8981;&#x5B8C;&#x5168;&#x602A;&#x6A21;&#x578B;&#x2014;&#x2014;&#x4E0D;&#x662F;&#x6240;&#x6709;&#x5B9E;&#x9645;&#x7684;&#x6050;&#x9F99;&#x540D;&#x79F0;&#x542C;&#x8D77;&#x6765;&#x90FD;&#x5F88;&#x9177;&#x3002;(&#x4F8B;&#x5982;&#xFF0C;<code>dromaeosauroides</code>&#x662F;&#x4E00;&#x4E2A;&#x771F;&#x5B9E;&#x7684;&#x6050;&#x9F99;&#x540D;&#x5B57;&#xFF0C;&#x5B83;&#x4E5F;&#x5728;&#x8BAD;&#x7EC3;&#x96C6;&#x4E2D;&#x3002;)&#x4F46;&#x662F;&#x8FD9;&#x4E2A;&#x6A21;&#x578B;&#x5E94;&#x8BE5;&#x7ED9;&#x4F60;&#x4E00;&#x7EC4;&#x5019;&#x9009;&#x8005;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x4ECE;&#x4E2D;&#x9009;&#x62E9;&#x6700;&#x9177;&#x7684;!</p>
<p>&#x8FD9;&#x4E2A;&#x4EFB;&#x52A1;&#x4F7F;&#x7528;&#x4E86;&#x4E00;&#x4E2A;&#x76F8;&#x5BF9;&#x8F83;&#x5C0F;&#x7684;&#x6570;&#x636E;&#x96C6;&#xFF0C;&#x56E0;&#x6B64;&#x60A8;&#x53EF;&#x4EE5;&#x5728;CPU&#x4E0A;&#x5FEB;&#x901F;&#x8BAD;&#x7EC3;RNN&#x3002;&#x8BAD;&#x7EC3;&#x82F1;&#x8BED;&#x6A21;&#x578B;&#x9700;&#x8981;&#x66F4;&#x5927;&#x7684;&#x6570;&#x636E;&#x96C6;&#xFF0C;&#x901A;&#x5E38;&#x9700;&#x8981;&#x66F4;&#x591A;&#x7684;&#x8BA1;&#x7B97;&#xFF0C;&#x5E76;&#x4E14;&#x53EF;&#x4EE5;&#x5728;gpu&#x4E0A;&#x8FD0;&#x884C;&#x6570;&#x5C0F;&#x65F6;&#x3002;&#x6211;&#x4EEC;&#x7ED9;&#x6050;&#x9F99;&#x8D77;&#x540D;&#x5B57;&#x5DF2;&#x7ECF;&#x6709;&#x4E00;&#x6BB5;&#x65F6;&#x95F4;&#x4E86;&#xFF0C;&#x5230;&#x76EE;&#x524D;&#x4E3A;&#x6B62;&#xFF0C;&#x6211;&#x4EEC;&#x6700;&#x559C;&#x6B22;&#x7684;&#x540D;&#x5B57;&#x662F;&#x4F1F;&#x5927;&#x7684;&#x3001;&#x4E0D;&#x53EF;&#x6218;&#x80DC;&#x7684;&#x3001;&#x51F6;&#x731B;&#x7684;:Mangosaurus!</p>
<h2 class="mume-header" id="%E5%83%8F%E8%8E%8E%E5%A3%AB%E6%AF%94%E4%BA%9A%E4%B8%80%E6%A0%B7%E4%B9%A6%E5%86%99">&#x50CF;&#x838E;&#x58EB;&#x6BD4;&#x4E9A;&#x4E00;&#x6837;&#x4E66;&#x5199;</h2>

<p>&#x672C;&#x7B14;&#x8BB0;&#x672C;&#x7684;&#x5176;&#x4F59;&#x90E8;&#x5206;&#x662F;&#x53EF;&#x9009;&#x7684;&#xFF0C;&#x4E0D;&#x8BC4;&#x5206;&#xFF0C;&#x4F46;&#x6211;&#x4EEC;&#x5E0C;&#x671B;&#x4F60;&#x4EEC;&#x80FD;&#x505A;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x5F88;&#x6709;&#x8DA3;&#xFF0C;&#x4E5F;&#x80FD;&#x63D0;&#x4F9B;&#x4FE1;&#x606F;&#x3002;</p>
<p>&#x4E00;&#x4E2A;&#x7C7B;&#x4F3C;&#x7684;(&#x4F46;&#x66F4;&#x590D;&#x6742;&#x7684;)&#x4EFB;&#x52A1;&#x662F;&#x751F;&#x6210;&#x838E;&#x58EB;&#x6BD4;&#x4E9A;&#x7684;&#x8BD7;&#x6B4C;&#x3002;&#x4F60;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x838E;&#x58EB;&#x6BD4;&#x4E9A;&#x7684;&#x8BD7;&#x6B4C;&#x96C6;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x4ECE;&#x6050;&#x9F99;&#x540D;&#x5B57;&#x7684;&#x6570;&#x636E;&#x96C6;&#x4E2D;&#x5B66;&#x4E60;&#x3002;&#x4F7F;&#x7528;LSTM&#x5355;&#x5143;&#x683C;&#xFF0C;&#x60A8;&#x53EF;&#x4EE5;&#x4E86;&#x89E3;&#x6587;&#x672C;&#x4E2D;&#x8DE8;<strong>&#x591A;&#x4E2A;&#x5B57;&#x7B26;&#x7684;&#x957F;&#x671F;&#x4F9D;&#x8D56;&#x5173;&#x7CFB;</strong>&#x2014;&#x2014;&#x4F8B;&#x5982;&#x3002;&#xFF0C;&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x51FA;&#x73B0;&#x5728;&#x5E8F;&#x5217;&#x7684;&#x67D0;&#x4E2A;&#x4F4D;&#x7F6E;&#xFF0C;&#x90A3;&#x4E48;&#x5B83;&#x53EF;&#x80FD;&#x4F1A;&#x5F71;&#x54CD;&#x4EE5;&#x540E;&#x5728;&#x5E8F;&#x5217;&#x4E2D;&#x51FA;&#x73B0;&#x7684;&#x4E0D;&#x540C;&#x5B57;&#x7B26;&#x3002;&#x8FD9;&#x4E9B;&#x957F;&#x671F;&#x7684;&#x4F9D;&#x8D56;&#x5173;&#x7CFB;&#x5BF9;&#x4E8E;&#x6050;&#x9F99;&#x7684;&#x540D;&#x5B57;&#x6765;&#x8BF4;&#x4E0D;&#x90A3;&#x4E48;&#x91CD;&#x8981;&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x4EEC;&#x7684;&#x540D;&#x5B57;&#x90FD;&#x5F88;&#x77ED;&#x3002;</p>
<p>&#x6211;&#x4EEC;&#x4F7F;&#x7528;Keras&#x5B9E;&#x73B0;&#x4E86;&#x4E00;&#x4E2A;&#x838E;&#x58EB;&#x6BD4;&#x4E9A;&#x8BD7;&#x6B4C;&#x751F;&#x6210;&#x5668;&#x3002;&#x8FD0;&#x884C;&#x4EE5;&#x4E0B;&#x5355;&#x5143;&#x683C;&#x4EE5;&#x52A0;&#x8F7D;&#x6240;&#x9700;&#x7684;&#x5305;&#x548C;&#x6A21;&#x578B;&#x3002;&#x8FD9;&#x53EF;&#x80FD;&#x9700;&#x8981;&#x51E0;&#x5206;&#x949F;&#x3002;</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">from</span> __future__ <span class="token keyword">import</span> print_function
<span class="token keyword">from</span> keras<span class="token punctuation">.</span>callbacks <span class="token keyword">import</span> LambdaCallback
<span class="token keyword">from</span> keras<span class="token punctuation">.</span>models <span class="token keyword">import</span> Model<span class="token punctuation">,</span> load_model<span class="token punctuation">,</span> Sequential
<span class="token keyword">from</span> keras<span class="token punctuation">.</span>layers <span class="token keyword">import</span> Dense<span class="token punctuation">,</span> Activation<span class="token punctuation">,</span> Dropout<span class="token punctuation">,</span> Input<span class="token punctuation">,</span> Masking
<span class="token keyword">from</span> keras<span class="token punctuation">.</span>layers <span class="token keyword">import</span> LSTM
<span class="token keyword">from</span> keras<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>data_utils <span class="token keyword">import</span> get_file
<span class="token keyword">from</span> keras<span class="token punctuation">.</span>preprocessing<span class="token punctuation">.</span>sequence <span class="token keyword">import</span> pad_sequences
<span class="token keyword">from</span> shakespeare_utils <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> sys
<span class="token keyword">import</span> io
</pre><p>&#x4E3A;&#x4E86;&#x8282;&#x7701;&#x4F60;&#x7684;&#x65F6;&#x95F4;&#xFF0C;&#x6211;&#x4EEC;&#x5DF2;&#x7ECF;&#x8BAD;&#x7EC3;&#x4E86;&#x4E00;&#x4E2A;&#x6A21;&#x578B;&#xFF0C;&#x4E3A;1000&#x4E2A;&#x65F6;&#x4EE3;&#x7684;&#x838E;&#x58EB;&#x6BD4;&#x4E9A;&#x8BD7;&#x96C6;&#x79F0;&#x4E3A;<a href="shakespeare.txt"><em>&#x201C;&#x5341;&#x56DB;&#x884C;&#x8BD7;&#x201D;</em></a>&#x3002;</p>
<p>&#x8BA9;&#x6211;&#x4EEC;&#x518D;&#x8BAD;&#x7EC3;&#x8FD9;&#x4E2A;&#x6A21;&#x578B;&#x4E00;&#x4E2A;&#x65F6;&#x4EE3;&#x3002;&#x5F53;&#x5B83;&#x5B8C;&#x6210;&#x4E00;&#x4E2A;epoch&#x7684;&#x8BAD;&#x7EC3;&#x65F6;(&#x8FD9;&#x4E5F;&#x9700;&#x8981;&#x51E0;&#x5206;&#x949F;)&#xFF0C;&#x60A8;&#x53EF;&#x4EE5;&#x8FD0;&#x884C;<code>generate_output</code>&#xFF0C;&#x5B83;&#x5C06;&#x63D0;&#x793A;&#x60A8;&#x8F93;&#x5165;(<code>&lt;</code>40&#x4E2A;&#x5B57;&#x7B26;)&#x3002;&#x8FD9;&#x9996;&#x8BD7;&#x5C06;&#x4EE5;&#x4F60;&#x7684;&#x53E5;&#x5B50;&#x5F00;&#x59CB;&#xFF0C;&#x6211;&#x4EEC;&#x7684;RNN-Shakespeare&#x5C06;&#x4E3A;&#x4F60;&#x5B8C;&#x6210;&#x8FD9;&#x9996;&#x8BD7;&#x7684;&#x5176;&#x4F59;&#x90E8;&#x5206;!&#x4F8B;&#x5982;&#xFF0C;&#x5C1D;&#x8BD5;&#x201C;Forsooth this make eth no sense&#x201D;(&#x4E0D;&#x8981;&#x8F93;&#x5165;&#x5F15;&#x53F7;)&#x3002;&#x53D6;&#x51B3;&#x4E8E;&#x662F;&#x5426;&#x5728;&#x672B;&#x5C3E;&#x5305;&#x542B;&#x7A7A;&#x683C;&#xFF0C;&#x7ED3;&#x679C;&#x4E5F;&#x53EF;&#x80FD;&#x4E0D;&#x540C;&#x2014;&#x2014;&#x5C1D;&#x8BD5;&#x4E24;&#x79CD;&#x65B9;&#x6CD5;&#xFF0C;&#x5E76;&#x5C1D;&#x8BD5;&#x5176;&#x4ED6;&#x8F93;&#x5165;&#x3002;</p>
<pre data-role="codeBlock" data-info="python" class="language-python">print_callback <span class="token operator">=</span> LambdaCallback<span class="token punctuation">(</span>on_epoch_end<span class="token operator">=</span>on_epoch_end<span class="token punctuation">)</span>
model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">128</span><span class="token punctuation">,</span> epochs<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> callbacks<span class="token operator">=</span><span class="token punctuation">[</span>print_callback<span class="token punctuation">]</span><span class="token punctuation">)</span>
</pre><h3 class="mume-header" id="%E7%BB%93%E6%9E%9C-6">&#x7ED3;&#x679C;</h3>

<pre data-role="codeBlock" data-info class="language-"><code>Epoch 1/1
31412/31412 [==============================] - 60s 2ms/step - loss: 2.5428
</code></pre><h3 class="mume-header" id="%E8%BF%90%E8%A1%8C">&#x8FD0;&#x884C;</h3>

<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># &#x8FD0;&#x884C;&#x6B64;&#x5355;&#x5143;&#x683C;&#x4EE5;&#x5C1D;&#x8BD5;&#x4F7F;&#x7528;&#x4E0D;&#x540C;&#x7684;&#x8F93;&#x5165;&#xFF0C;&#x800C;&#x4E0D;&#x5FC5;&#x91CD;&#x65B0;&#x8BAD;&#x7EC3;&#x6A21;&#x578B;</span>
generate_output<span class="token punctuation">(</span><span class="token punctuation">)</span>
</pre><h3 class="mume-header" id="%E7%BB%93%E6%9E%9C-7">&#x7ED3;&#x679C;</h3>

<pre data-role="codeBlock" data-info class="language-"><code>Write the beginning of your poem, the Shakespeare machine will complete it. Your input is: Forsooth this maketh no sense


Here is your poem: 

Forsooth this maketh no sense.
hens co betheregor there beauny thou oft
paintame caom marsing worden wise dith ind,
whench to be the ssast though in moin aed,
again, then hid ploce time the these disthing to boust.
thee i then on thuth you thle anstiuns astien,
to grow&apos;n when lose so inof and o&apos;h, and now,
delerge onfouch, my it?ning the wam ma rove,
thine in leapl thous for great the dos, not wor a sacons,
hin womnt in my th
</code></pre><p>RNN-Shakespeare&#x6A21;&#x578B;&#x4E0E;&#x60A8;&#x4E3A;&#x6050;&#x9F99;&#x547D;&#x540D;&#x6240;&#x6784;&#x5EFA;&#x7684;&#x6A21;&#x578B;&#x975E;&#x5E38;&#x76F8;&#x4F3C;&#x3002;&#x552F;&#x4E00;&#x7684;&#x4E3B;&#x8981;&#x533A;&#x522B;&#x662F;:</p>
<ul>
<li>
<p>&#x7528;LSTM&#x4EE3;&#x66FF;&#x57FA;&#x672C;&#x7684;RNN&#x6765;&#x6355;&#x83B7;&#x66F4;&#x957F;&#x7684;&#x4F9D;&#x8D56;&#x5173;&#x7CFB;</p>
</li>
<li>
<p>&#x8BE5;&#x6A21;&#x578B;&#x662F;&#x4E00;&#x4E2A;&#x8F83;&#x6DF1;&#x7684;&#x591A;&#x5C42;LSTM&#x6A21;&#x578B;(2&#x5C42;)</p>
</li>
<li>
<p>&#x4F7F;&#x7528;Keras&#x800C;&#x4E0D;&#x662F;python&#x6765;&#x7B80;&#x5316;&#x4EE3;&#x7801;</p>
</li>
</ul>
<p>&#x5982;&#x679C;&#x60A8;&#x60F3;&#x4E86;&#x89E3;&#x66F4;&#x591A;&#xFF0C;&#x60A8;&#x8FD8;&#x53EF;&#x4EE5;&#x5728;GitHub&#x4E0A;&#x67E5;&#x770B;Keras&#x56E2;&#x961F;&#x7684;&#x6587;&#x672C;&#x751F;&#x6210;&#x5B9E;&#x73B0;:<a href="https://github.com/keras">https://github.com/keras</a> team/keras/blob/master/examples/lstm_text_generation.py&#x3002;</p>
<h2 class="mume-header" id="%E5%8F%82%E8%80%83">&#x53C2;&#x8003;</h2>

<ul>
<li>This exercise took inspiration from Andrej Karpathy&apos;s implementation: <a href="https://gist.github.com/karpathy/d4dee566867f8291f086">https://gist.github.com/karpathy/d4dee566867f8291f086</a>. To learn more about text generation, also check out Karpathy&apos;s <a href="http://karpathy.github.io/2015/05/21/rnn-effectiveness/">blog post</a>.</li>
<li>For the Shakespearian poem generator, our implementation was based on the implementation of an LSTM text generator by the Keras team: <a href="https://github.com/keras-team/keras/blob/master/examples/lstm_text_generation.py">https://github.com/keras-team/keras/blob/master/examples/lstm_text_generation.py</a></li>
</ul>

      </div>
      
      
    
    
    
    
    
    
    
    
  
    </body></html>