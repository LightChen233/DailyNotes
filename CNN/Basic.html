<!DOCTYPE html>
<html>
  <head>
      <title>Emojify</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({"extensions":["tex2jax.js"],"jax":["input/TeX","output/HTML-CSS"],"messageStyle":"none","tex2jax":{"processEnvironments":false,"processEscapes":true,"inlineMath":[["$","$"],["\\(","\\)"]],"displayMath":[["$$","$$"],["\\[","\\]"]]},"TeX":{"extensions":["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]},"HTML-CSS":{"availableFonts":["TeX"]}});
        </script>
        <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
        <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.3.1/css/bootstrap.min.css">
        <script src="https://cdn.staticfile.org/jquery/3.2.1/jquery.min.js"></script>
        <script src="https://cdn.staticfile.org/twitter-bootstrap/4.3.1/js/bootstrap.min.js"></script>
      <style>
      /**
 * prism.js Github theme based on GitHub's theme.
 * @author Sam Clarke
 */
code[class*="language-"],
pre[class*="language-"] {
  color: #333;
  background: none;
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.4;

  -moz-tab-size: 8;
  -o-tab-size: 8;
  tab-size: 8;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
  padding: .8em;
  overflow: auto;
  /* border: 1px solid #ddd; */
  border-radius: 3px;
  /* background: #fff; */
  background: #f5f5f5;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
  padding: .1em;
  border-radius: .3em;
  white-space: normal;
  background: #f5f5f5;
}

.token.comment,
.token.blockquote {
  color: #969896;
}

.token.cdata {
  color: #183691;
}

.token.doctype,
.token.punctuation,
.token.variable,
.token.macro.property {
  color: #333;
}

.token.operator,
.token.important,
.token.keyword,
.token.rule,
.token.builtin {
  color: #a71d5d;
}

.token.string,
.token.url,
.token.regex,
.token.attr-value {
  color: #183691;
}

.token.property,
.token.number,
.token.boolean,
.token.entity,
.token.atrule,
.token.constant,
.token.symbol,
.token.command,
.token.code {
  color: #0086b3;
}

.token.tag,
.token.selector,
.token.prolog {
  color: #63a35c;
}

.token.function,
.token.namespace,
.token.pseudo-element,
.token.class,
.token.class-name,
.token.pseudo-class,
.token.id,
.token.url-reference .token.variable,
.token.attr-name {
  color: #795da3;
}

.token.entity {
  cursor: help;
}

.token.title,
.token.title .token.punctuation {
  font-weight: bold;
  color: #1d3e81;
}

.token.list {
  color: #ed6a43;
}

.token.inserted {
  background-color: #eaffea;
  color: #55a532;
}

.token.deleted {
  background-color: #ffecec;
  color: #bd2c00;
}

.token.bold {
  font-weight: bold;
}

.token.italic {
  font-style: italic;
}


/* JSON */
.language-json .token.property {
  color: #183691;
}

.language-markup .token.tag .token.punctuation {
  color: #333;
}

/* CSS */
code.language-css,
.language-css .token.function {
  color: #0086b3;
}

/* YAML */
.language-yaml .token.atrule {
  color: #63a35c;
}

code.language-yaml {
  color: #183691;
}

/* Ruby */
.language-ruby .token.function {
  color: #333;
}

/* Markdown */
.language-markdown .token.url {
  color: #795da3;
}

/* Makefile */
.language-makefile .token.symbol {
  color: #795da3;
}

.language-makefile .token.variable {
  color: #183691;
}

.language-makefile .token.builtin {
  color: #0086b3;
}

/* Bash */
.language-bash .token.keyword {
  color: #0086b3;
}

/* highlight */
pre[data-line] {
  position: relative;
  padding: 1em 0 1em 3em;
}
pre[data-line] .line-highlight-wrapper {
  position: absolute;
  top: 0;
  left: 0;
  background-color: transparent;
  display: block;
  width: 100%;
}

pre[data-line] .line-highlight {
  position: absolute;
  left: 0;
  right: 0;
  padding: inherit 0;
  margin-top: 1em;
  background: hsla(24, 20%, 50%,.08);
  background: linear-gradient(to right, hsla(24, 20%, 50%,.1) 70%, hsla(24, 20%, 50%,0));
  pointer-events: none;
  line-height: inherit;
  white-space: pre;
}

pre[data-line] .line-highlight:before, 
pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-start);
  position: absolute;
  top: .4em;
  left: .6em;
  min-width: 1em;
  padding: 0 .5em;
  background-color: hsla(24, 20%, 50%,.4);
  color: hsl(24, 20%, 95%);
  font: bold 65%/1.5 sans-serif;
  text-align: center;
  vertical-align: .3em;
  border-radius: 999px;
  text-shadow: none;
  box-shadow: 0 1px white;
}

pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-end);
  top: auto;
  bottom: .4em;
}html body{font-family:"Helvetica Neue",Helvetica,"Segoe UI",Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ul,html body>ol{margin-bottom:16px}html body ul,html body ol{padding-left:2em}html body ul.no-list,html body ol.no-list{padding:0;list-style-type:none}html body ul ul,html body ul ol,html body ol ol,html body ol ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:bold;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:bold}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em !important;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::before,html body code::after{letter-spacing:-0.2em;content:"\00a0"}html body pre>code{padding:0;margin:0;font-size:.85em !important;word-break:normal;white-space:pre;background:transparent;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;font-size:.85em !important;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:before,html body pre tt:before,html body pre code:after,html body pre tt:after{content:normal}html body p,html body blockquote,html body ul,html body ol,html body dl,html body pre{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body pre,html body code{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview .pagebreak,.markdown-preview .newpage{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center !important}.markdown-preview:not([for="preview"]) .code-chunk .btn-group{display:none}.markdown-preview:not([for="preview"]) .code-chunk .status{display:none}.markdown-preview:not([for="preview"]) .code-chunk .output-div{margin-bottom:16px}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0}@media screen and (min-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{font-size:14px !important;padding:1em}}@media print{html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,0.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{padding:0 1.6em;margin-top:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc li{margin-bottom:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{list-style-type:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% -  300px);padding:2em calc(50% - 457px -  150px);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */

      </style>
    </head>
    <body for="html-export">
      <nav class="navbar navbar-expand-sm bg-dark navbar-dark fixed-top">
        <!-- Brand -->
        <img src="../logo.jpg">
      
        <!-- Links -->
        <ul class="navbar-nav">
          <li class="nav-item dropdown">
            <a class="nav-link" href="../index.html">主页</a>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link" href="../PyTorch.html">Pytorch</a>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link" href="../DeepLearning/DeepNetwork.html">人工智能</a>
          </li>
        </ul>
      </nav>
      <br>
      <br>
      <br>
      <div class="container-fluid">
        <div class="row">
          <nav class="col-md-2 d-none d-md-block bg-light sidebar fixed-bottom">
          <div class="sidebar-sticky">
            <ul class="nav flex-column">
              <li class="nav-item">
                <a class="nav-link active" href="#">
                  计算机视觉
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">
                  边缘检测问题
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">
                  卷积
                </a>
              </li>
            </ul>
            <br><br><br><br><br><br><br><br><br><br>
            <br><br><br><br><br><br><br><br><br><br>
          </div>
          </nav>
          <main role="main" class="col-md-9 ml-sm-auto col-lg-10 pt-3 px-4">
            <div class="mume markdown-preview  ">
              <h1 class="mume-header" id="%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80">&#x5377;&#x79EF;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x57FA;&#x7840;</h1>
        
        <h2 class="mume-header" id="%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89">&#x8BA1;&#x7B97;&#x673A;&#x89C6;&#x89C9;</h2>
        
        <h3 class="mume-header" id="%E5%BA%94%E7%94%A8%E5%88%86%E7%B1%BB">&#x5E94;&#x7528;&#x5206;&#x7C7B;</h3>
        
        <p>&#x673A;&#x5668;&#x89C6;&#x89C9;&#xFF08;Computer Vision&#xFF09;&#x662F;&#x6DF1;&#x5EA6;&#x5B66;&#x4E60;&#x5E94;&#x7528;&#x7684;&#x4E3B;&#x8981;&#x65B9;&#x5411;&#x4E4B;&#x4E00;&#x3002;&#x4E00;&#x822C;&#x7684;CV&#x95EE;&#x9898;&#x5305;&#x62EC;&#x4EE5;&#x4E0B;&#x4E09;&#x7C7B;&#xFF1A;</p>
        <ul>
        <li><strong>&#x56FE;&#x50CF;&#x5206;&#x7C7B;</strong></li>
        <li><strong>&#x76EE;&#x6807;&#x68C0;&#x6D4B;</strong></li>
        <li><strong>&#x795E;&#x7ECF;&#x98CE;&#x683C;&#x8FC1;&#x79FB;</strong></li>
        </ul>
        <p>&#x4E0B;&#x56FE;&#x5C55;&#x793A;&#x4E86;&#x4E00;&#x4E2A;&#x795E;&#x7ECF;&#x98CE;&#x683C;&#x8FC1;&#x79FB;&#xFF08;Neural Style Transfer&#xFF09;&#x7684;&#x4F8B;&#x5B50;&#xFF1A;</p>
        <p><img src="img/3.jpg" alt></p>
        <h3 class="mume-header" id="%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E9%97%AE%E9%A2%98%E4%BB%A5%E5%8F%8A%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95">&#x56FE;&#x50CF;&#x5904;&#x7406;&#x95EE;&#x9898;&#x4EE5;&#x53CA;&#x89E3;&#x51B3;&#x65B9;&#x6CD5;</h3>
        
        <p>&#x4F7F;&#x7528;&#x4F20;&#x7EDF;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x5904;&#x7406;&#x673A;&#x5668;&#x89C6;&#x89C9;&#x7684;&#x4E00;&#x4E2A;&#x4E3B;&#x8981;&#x95EE;&#x9898;&#x662F;&#x8F93;&#x5165;&#x5C42;&#x7EF4;&#x5EA6;&#x5F88;&#x5927;&#x3002;&#x4F8B;&#x5982;&#x4E00;&#x5F20;64x64x3&#x7684;&#x56FE;&#x7247;&#xFF0C;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x8F93;&#x5165;&#x5C42;&#x7684;&#x7EF4;&#x5EA6;&#x4E3A;12288&#x3002;&#x5982;&#x679C;&#x56FE;&#x7247;&#x5C3A;&#x5BF8;&#x8F83;&#x5927;&#xFF0C;&#x4F8B;&#x5982;&#x4E00;&#x5F20;1000x1000x3&#x7684;&#x56FE;&#x7247;&#xFF0C;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x8F93;&#x5165;&#x5C42;&#x7684;&#x7EF4;&#x5EA6;&#x5C06;&#x8FBE;&#x5230;3&#x767E;&#x4E07;&#xFF0C;&#x4F7F;&#x5F97;&#x7F51;&#x7EDC;&#x6743;&#x91CD;W&#x975E;&#x5E38;&#x5E9E;&#x5927;&#x3002;&#x8FD9;&#x6837;&#x4F1A;&#x9020;&#x6210;&#x4E24;&#x4E2A;&#x540E;&#x679C;&#xFF0C;&#x4E00;&#x662F;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x7ED3;&#x6784;&#x590D;&#x6742;&#xFF0C;&#x6570;&#x636E;&#x91CF;&#x76F8;&#x5BF9;&#x4E0D;&#x591F;&#xFF0C;&#x5BB9;&#x6613;&#x51FA;&#x73B0;&#x8FC7;&#x62DF;&#x5408;&#xFF1B;&#x4E8C;&#x662F;&#x6240;&#x9700;&#x5185;&#x5B58;&#x3001;&#x8BA1;&#x7B97;&#x91CF;&#x8F83;&#x5927;&#x3002;&#x89E3;&#x51B3;&#x8FD9;&#x4E00;&#x95EE;&#x9898;&#x7684;&#x65B9;&#x6CD5;&#x5C31;&#x662F;&#x4F7F;&#x7528;<strong>&#x5377;&#x79EF;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;</strong>&#xFF08;CNN&#xFF09;&#x3002;</p>
        <h2 class="mume-header" id="%E8%BE%B9%E7%BC%98%E6%A3%80%E6%B5%8B%E9%97%AE%E9%A2%98">&#x8FB9;&#x7F18;&#x68C0;&#x6D4B;&#x95EE;&#x9898;</h2>
        
        <p>&#x5BF9;&#x4E8E;CV&#x95EE;&#x9898;&#xFF0C;&#x6211;&#x4EEC;&#x5728;&#x4E4B;&#x524D;&#x7684;&#x7B14;&#x8BB0;&#x4E2D;&#x4ECB;&#x7ECD;&#x8FC7;&#xFF0C;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x7531;&#x6D45;&#x5C42;&#x5230;&#x6DF1;&#x5C42;&#xFF0C;&#x5206;&#x522B;&#x53EF;&#x4EE5;&#x68C0;&#x6D4B;&#x51FA;&#x56FE;&#x7247;&#x7684;<strong>&#x8FB9;&#x7F18;&#x7279;&#x5F81;</strong> &#x3001;<strong>&#x5C40;&#x90E8;&#x7279;&#x5F81;</strong>&#xFF08;&#x4F8B;&#x5982;&#x773C;&#x775B;&#x3001;&#x9F3B;&#x5B50;&#x7B49;&#xFF09;&#x3001;<strong>&#x6574;&#x4F53;&#x9762;&#x90E8;&#x8F6E;&#x5ED3;</strong>&#x3002;</p>
        <p><img src="img/4.jpg" alt></p>
        <p>&#x8FD9;&#x4E00;&#x5C0F;&#x8282;&#x6211;&#x4EEC;&#x5C06;&#x4ECB;&#x7ECD;&#x5982;&#x4F55;&#x68C0;&#x6D4B;&#x56FE;&#x7247;&#x7684;&#x8FB9;&#x7F18;&#x3002;</p>
        <p>&#x6700;&#x5E38;&#x68C0;&#x6D4B;&#x7684;&#x56FE;&#x7247;&#x8FB9;&#x7F18;&#x6709;&#x4E24;&#x7C7B;&#xFF1A;&#x4E00;&#x662F;<strong>&#x5782;&#x76F4;&#x8FB9;&#x7F18;</strong>&#xFF08;vertical edges&#xFF09;&#xFF0C;&#x4E8C;&#x662F;<strong>&#x6C34;&#x5E73;&#x8FB9;&#x7F18;</strong>&#xFF08;horizontal edges&#xFF09;&#x3002;</p>
        <p><img src="img/5.jpg" alt></p>
        <h3 class="mume-header" id="%E5%8D%B7%E7%A7%AF">&#x5377;&#x79EF;</h3>
        
        <p>&#x56FE;&#x7247;&#x7684;&#x8FB9;&#x7F18;&#x68C0;&#x6D4B;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4E0E;&#x76F8;&#x5E94;&#x6EE4;&#x6CE2;&#x5668;&#x8FDB;&#x884C;&#x5377;&#x79EF;&#x6765;&#x5B9E;&#x73B0;&#x3002;&#x4EE5;&#x5782;&#x76F4;&#x8FB9;&#x7F18;&#x68C0;&#x6D4B;&#x4E3A;&#x4F8B;&#xFF0C;&#x539F;&#x59CB;&#x56FE;&#x7247;&#x5C3A;&#x5BF8;&#x4E3A;6x6&#xFF0C;&#x6EE4;&#x6CE2;&#x5668;filter&#x5C3A;&#x5BF8;&#x4E3A;3x3&#xFF0C;&#x5377;&#x79EF;&#x540E;&#x7684;&#x56FE;&#x7247;&#x5C3A;&#x5BF8;&#x4E3A;4x4&#xFF0C;&#x5F97;&#x5230;&#x7ED3;&#x679C;&#x5982;&#x4E0B;&#xFF1A;</p>
        <p><img src="img/6.jpg" alt></p>
        <p>&#x4E0A;&#x56FE;&#x53EA;&#x663E;&#x793A;&#x4E86;&#x5377;&#x79EF;&#x540E;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x503C;&#x548C;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x503C;&#x3002;</p>
        <p>&quot; * &quot;&#x8868;&#x793A;&#x5377;&#x79EF;&#x64CD;&#x4F5C;&#x3002;python&#x4E2D;&#xFF0C;&#x5377;&#x79EF;&#x7528;conv_forward()&#x8868;&#x793A;&#xFF1B;</p>
        <h3 class="mume-header" id="%E8%BE%B9%E7%BC%98%E6%A3%80%E6%B5%8B">&#x8FB9;&#x7F18;&#x68C0;&#x6D4B;</h3>
        
        <h4 class="mume-header" id="%E5%9E%82%E7%9B%B4%E8%BE%B9%E7%BC%98%E6%A3%80%E6%B5%8B">&#x5782;&#x76F4;&#x8FB9;&#x7F18;&#x68C0;&#x6D4B;</h4>
        
        <p><strong>&#x5782;&#x76F4;&#x8FB9;&#x7F18;&#x68C0;&#x6D4B;</strong>&#x80FD;&#x591F;&#x68C0;&#x6D4B;&#x56FE;&#x7247;&#x7684;&#x5782;&#x76F4;&#x65B9;&#x5411;&#x8FB9;&#x7F18;&#x3002;&#x4E0B;&#x56FE;&#x5BF9;&#x5E94;&#x4E00;&#x4E2A;&#x5782;&#x76F4;&#x8FB9;&#x7F18;&#x68C0;&#x6D4B;&#x7684;&#x4F8B;&#x5B50;&#xFF1A;</p>
        <p><img src="img/7.jpg" alt></p>
        <h4 class="mume-header" id="%E6%B8%90%E5%8F%98%E5%BD%B1%E5%93%8D">&#x6E10;&#x53D8;&#x5F71;&#x54CD;</h4>
        
        <p>&#x56FE;&#x7247;&#x8FB9;&#x7F18;&#x6709;&#x4E24;&#x79CD;&#x6E10;&#x53D8;&#x65B9;&#x5F0F;&#xFF0C;&#x4E00;&#x79CD;&#x662F;&#x7531;&#x660E;&#x53D8;&#x6697;&#xFF0C;&#x53E6;&#x4E00;&#x79CD;&#x662F;&#x7531;&#x6697;&#x53D8;&#x660E;&#x3002;&#x4EE5;&#x5782;&#x76F4;&#x8FB9;&#x7F18;&#x68C0;&#x6D4B;&#x4E3A;&#x4F8B;&#xFF0C;&#x4E0B;&#x56FE;&#x5C55;&#x793A;&#x4E86;&#x4E24;&#x79CD;&#x65B9;&#x5F0F;&#x7684;&#x533A;&#x522B;&#x3002;&#x5B9E;&#x9645;&#x5E94;&#x7528;&#x4E2D;&#xFF0C;&#x8FD9;&#x4E24;&#x79CD;&#x6E10;&#x53D8;&#x65B9;&#x5F0F;&#x5E76;&#x4E0D;&#x5F71;&#x54CD;&#x8FB9;&#x7F18;&#x68C0;&#x6D4B;&#x7ED3;&#x679C;&#xFF0C;&#x53EF;&#x4EE5;&#x5BF9;&#x8F93;&#x51FA;&#x56FE;&#x7247;&#x53D6;&#x7EDD;&#x5BF9;&#x503C;&#x64CD;&#x4F5C;&#xFF0C;&#x5F97;&#x5230;<strong>&#x540C;&#x6837;&#x7684;&#x7ED3;&#x679C;</strong>&#x3002;</p>
        <p><img src="img/8.jpg" alt></p>
        <h4 class="mume-header" id="%E6%B0%B4%E5%B9%B3%E8%BE%B9%E7%BC%98%E6%A3%80%E6%B5%8B">&#x6C34;&#x5E73;&#x8FB9;&#x7F18;&#x68C0;&#x6D4B;</h4>
        
        <p>&#x5782;&#x76F4;&#x8FB9;&#x7F18;&#x68C0;&#x6D4B;&#x548C;&#x6C34;&#x5E73;&#x8FB9;&#x7F18;&#x68C0;&#x6D4B;&#x7684;&#x6EE4;&#x6CE2;&#x5668;&#x7B97;&#x5B50;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;</p>
        <p><img src="img/9.jpg" alt></p>
        <p>&#x4E0B;&#x56FE;&#x5C55;&#x793A;&#x4E00;&#x4E2A;&#x6C34;&#x5E73;&#x8FB9;&#x7F18;&#x68C0;&#x6D4B;&#x7684;&#x4F8B;&#x5B50;&#xFF1A;</p>
        <p><img src="img/10.jpg" alt></p>
        <h4 class="mume-header" id="%E5%85%B6%E5%AE%83%E5%B8%B8%E7%94%A8%E7%9A%84%E6%BB%A4%E6%B3%A2%E5%99%A8">&#x5176;&#x5B83;&#x5E38;&#x7528;&#x7684;&#x6EE4;&#x6CE2;&#x5668;</h4>
        
        <p>&#x9664;&#x4E86;&#x4E0A;&#x9762;&#x63D0;&#x5230;&#x7684;&#x8FD9;&#x79CD;&#x7B80;&#x5355;&#x7684;&#x5782;&#x76F4;&#x3001;&#x6C34;&#x5E73;&#x6EE4;&#x6CE2;&#x5668;&#x4E4B;&#x5916;&#xFF0C;&#x8FD8;&#x6709;&#x5176;&#x5B83;&#x5E38;&#x7528;&#x7684;&#x6EE4;&#x6CE2;&#x5668;&#xFF0C;&#x4F8B;&#x5982;Sobel&#x6EE4;&#x6CE2;&#x5668;&#x548C;Scharr&#x6EE4;&#x6CE2;&#x5668;&#x3002;&#x8FD9;&#x4E24;&#x79CD;&#x6EE4;&#x6CE2;&#x5668;&#x7684;&#x7279;&#x70B9;&#x662F;<strong>&#x589E;&#x52A0;&#x56FE;&#x7247;&#x4E2D;&#x5FC3;&#x533A;&#x57DF;&#x7684;&#x6743;&#x91CD;</strong>&#x3002;</p>
        <p><img src="img/11.jpg" alt></p>
        <p>&#x4E0A;&#x56FE;&#x5C55;&#x793A;&#x7684;&#x662F;&#x5782;&#x76F4;&#x8FB9;&#x7F18;&#x68C0;&#x6D4B;&#x7B97;&#x5B50;&#xFF0C;&#x6C34;&#x5E73;&#x8FB9;&#x7F18;&#x68C0;&#x6D4B;&#x7B97;&#x5B50;&#x53EA;&#x9700;&#x5C06;&#x4E0A;&#x56FE;&#x987A;&#x65F6;&#x9488;&#x7FFB;&#x8F6C;90&#x5EA6;&#x5373;&#x53EF;&#x3002;</p>
        <p>&#x5728;&#x6DF1;&#x5EA6;&#x5B66;&#x4E60;&#x4E2D;&#xFF0C;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x60F3;&#x68C0;&#x6D4B;&#x56FE;&#x7247;&#x7684;&#x5404;&#x79CD;&#x8FB9;&#x7F18;&#x7279;&#x5F81;&#xFF0C;&#x800C;&#x4E0D;&#x4EC5;&#x9650;&#x4E8E;&#x5782;&#x76F4;&#x8FB9;&#x7F18;&#x548C;&#x6C34;&#x5E73;&#x8FB9;&#x7F18;&#xFF0C;&#x90A3;&#x4E48;&#x6EE4;&#x6CE2;&#x5668;&#x7684;&#x6570;&#x503C;&#x4E00;&#x822C;&#x9700;&#x8981;&#x901A;&#x8FC7;&#x6A21;&#x578B;&#x8BAD;&#x7EC3;&#x5F97;&#x5230;&#xFF0C;&#x7C7B;&#x4F3C;&#x4E8E;&#x6807;&#x51C6;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x4E2D;&#x7684;&#x6743;&#x91CD;W&#x4E00;&#x6837;&#x7531;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;&#x7B97;&#x6CD5;&#x53CD;&#x590D;&#x8FED;&#x4EE3;&#x6C42;&#x5F97;&#x3002;CNN&#x7684;&#x4E3B;&#x8981;&#x76EE;&#x7684;&#x5C31;&#x662F;&#x8BA1;&#x7B97;&#x51FA;&#x8FD9;&#x4E9B;&#x6EE4;&#x6CE2;&#x5668;&#x7684;&#x6570;&#x503C;&#x3002;&#x786E;&#x5B9A;&#x5F97;&#x5230;&#x4E86;&#x8FD9;&#x4E9B;&#x6EE4;&#x6CE2;&#x5668;&#x540E;&#xFF0C;CNN&#x6D45;&#x5C42;&#x7F51;&#x7EDC;&#x4E5F;&#x5C31;&#x5B9E;&#x73B0;&#x4E86;&#x5BF9;&#x56FE;&#x7247;&#x6240;&#x6709;&#x8FB9;&#x7F18;&#x7279;&#x5F81;&#x7684;&#x68C0;&#x6D4B;&#x3002;</p>
        <h2 class="mume-header" id="%E5%A1%AB%E5%85%85padding">&#x586B;&#x5145;&#xFF08;padding&#xFF09;</h2>
        
        <p>&#x6309;&#x7167;&#x6211;&#x4EEC;&#x4E0A;&#x9762;&#x8BB2;&#x7684;&#x56FE;&#x7247;&#x5377;&#x79EF;&#xFF0C;&#x5982;&#x679C;&#x539F;&#x59CB;&#x56FE;&#x7247;&#x5C3A;&#x5BF8;&#x4E3A;n x n&#xFF0C;&#x6EE4;&#x6CE2;&#x5668;&#x5C3A;&#x5BF8;&#x4E3A;f x f&#xFF0C;&#x5219;&#x5377;&#x79EF;&#x540E;&#x7684;&#x56FE;&#x7247;&#x5C3A;&#x5BF8;&#x4E3A;(n-f+1) x (n-f+1)&#xFF0C;&#x6CE8;&#x610F;f&#x4E00;&#x822C;&#x4E3A;&#x5947;&#x6570;&#x3002;&#x8FD9;&#x6837;&#x4F1A;&#x5E26;&#x6765;&#x4E24;&#x4E2A;&#x95EE;&#x9898;&#xFF1A;</p>
        <ul>
        <li><strong>&#x5377;&#x79EF;&#x8FD0;&#x7B97;&#x540E;&#xFF0C;&#x8F93;&#x51FA;&#x56FE;&#x7247;&#x5C3A;&#x5BF8;&#x7F29;&#x5C0F;</strong></li>
        <li><strong>&#x539F;&#x59CB;&#x56FE;&#x7247;&#x8FB9;&#x7F18;&#x4FE1;&#x606F;&#x5BF9;&#x8F93;&#x51FA;&#x8D21;&#x732E;&#x5F97;&#x5C11;&#xFF0C;&#x8F93;&#x51FA;&#x56FE;&#x7247;&#x4E22;&#x5931;&#x8FB9;&#x7F18;&#x4FE1;&#x606F;</strong></li>
        </ul>
        <p>&#x4E3A;&#x4E86;&#x89E3;&#x51B3;&#x56FE;&#x7247;&#x7F29;&#x5C0F;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x586B;&#x5145;&#x65B9;&#x6CD5;&#xFF0C;&#x5373;&#x628A;&#x539F;&#x59CB;&#x56FE;&#x7247;&#x5C3A;&#x5BF8;&#x8FDB;&#x884C;&#x6269;&#x5C55;&#xFF0C;&#x6269;&#x5C55;&#x533A;&#x57DF;&#x8865;&#x96F6;&#xFF0C;&#x7528;p&#x6765;&#x8868;&#x793A;&#x6BCF;&#x4E2A;&#x65B9;&#x5411;&#x6269;&#x5C55;&#x7684;&#x5BBD;&#x5EA6;&#x3002;</p>
        <p><img src="img/12.jpg" alt></p>
        <p>&#x7ECF;&#x8FC7;padding&#x4E4B;&#x540E;&#xFF0C;&#x539F;&#x59CB;&#x56FE;&#x7247;&#x5C3A;&#x5BF8;&#x4E3A;(n+2p) x (n+2p)&#xFF0C;filter&#x5C3A;&#x5BF8;&#x4E3A;f x f&#xFF0C;&#x5219;&#x5377;&#x79EF;&#x540E;&#x7684;&#x56FE;&#x7247;&#x5C3A;&#x5BF8;&#x4E3A;(n+2p-f+1) x (n+2p-f+1)&#x3002;&#x82E5;&#x8981;&#x4FDD;&#x8BC1;&#x5377;&#x79EF;&#x524D;&#x540E;&#x56FE;&#x7247;&#x5C3A;&#x5BF8;&#x4E0D;&#x53D8;&#xFF0C;&#x5219;p&#x5E94;&#x6EE1;&#x8DB3;&#xFF1A;<br>
        </p><div class="mathjax-exps">$$p=\frac{f-1}{2}$$</div><br>
        &#x6CA1;&#x6709;&#x586B;&#x5145;&#x64CD;&#x4F5C;&#xFF0C;p=0&#xFF0C;&#x6211;&#x4EEC;&#x79F0;&#x4E4B;&#x4E3A;&#x201C;&#x7A7A;&#x5377;&#x79EF;&#x201D;&#xFF1B;&#x6709;&#x586B;&#x5145;&#x64CD;&#x4F5C;&#xFF0C;<span class="mathjax-exps">$p=\frac{f-1}{2}$</span>&#xFF0C;&#x6211;&#x4EEC;&#x79F0;&#x4E4B;&#x4E3A;&#x201C;&#x76F8;&#x540C;&#x5377;&#x79EF;&#x201D;&#x3002;<p></p>
        <h2 class="mume-header" id="%E5%8D%B7%E7%A7%AF%E6%AD%A5%E9%95%BFstrided-convolutions">&#x5377;&#x79EF;&#x6B65;&#x957F;&#xFF08;Strided Convolutions&#xFF09;</h2>
        
        <p>&#x6B65;&#x957F;stride&#x8868;&#x793A;&#x8FC7;&#x6EE4;&#x5668;&#x5728;&#x539F;&#x56FE;&#x7247;&#x4E2D;&#x6C34;&#x5E73;&#x65B9;&#x5411;&#x548C;&#x5782;&#x76F4;&#x65B9;&#x5411;&#x6BCF;&#x6B21;&#x7684;&#x6B65;&#x8FDB;&#x957F;&#x5EA6;&#x3002;&#x4E4B;&#x524D;&#x6211;&#x4EEC;&#x9ED8;&#x8BA4;stride=1&#x3002;&#x82E5;stride=2&#xFF0C;&#x5219;&#x8868;&#x793A;&#x8FC7;&#x6EE4;&#x5668;&#x6BCF;&#x6B21;&#x6B65;&#x8FDB;&#x957F;&#x5EA6;&#x4E3A;2&#xFF0C;&#x5373;&#x9694;&#x4E00;&#x70B9;&#x79FB;&#x52A8;&#x4E00;&#x6B21;&#x3002;</p>
        <p><img src="img/13.jpg" alt></p>
        <p>&#x6211;&#x4EEC;&#x7528;s&#x8868;&#x793A;&#x6B65;&#x957F;&#xFF0C;p&#x8868;&#x793A;&#x586B;&#x5145;&#x957F;&#x5EA6;&#xFF0C;&#x5982;&#x679C;&#x539F;&#x59CB;&#x56FE;&#x7247;&#x5C3A;&#x5BF8;&#x4E3A;n x n&#xFF0C;&#x6EE4;&#x6CE2;&#x5668;&#x5C3A;&#x5BF8;&#x4E3A;f x f&#xFF0C;&#x5219;&#x5377;&#x79EF;&#x540E;&#x7684;&#x56FE;&#x7247;&#x5C3A;&#x5BF8;&#x4E3A;&#xFF1A;<br>
        </p><div class="mathjax-exps">$$\lfloor\frac{n+2p-f}{s}+1\rfloor\ X\ \lfloor\frac{n+2p-f}{s}+1\rfloor$$</div><br>
        &#x4E0A;&#x5F0F;&#x4E2D;&#xFF0C;<span class="mathjax-exps">$\lfloor\cdots\rfloor$</span>&#x8868;&#x793A;&#x5411;&#x4E0B;&#x53D6;&#x6574;&#x3002;<p></p>
        <p>&#x503C;&#x5F97;&#x4E00;&#x63D0;&#x7684;&#x662F;&#xFF0C;<strong>&#x76F8;&#x5173;&#x7CFB;&#x6570;</strong>&#xFF08;cross-correlations&#xFF09;&#x4E0E;<strong>&#x5377;&#x79EF;</strong>&#xFF08;convolutions&#xFF09;&#x4E4B;&#x95F4;&#x662F;&#x6709;&#x533A;&#x522B;&#x7684;&#x3002;&#x5B9E;&#x9645;&#x4E0A;&#xFF0C;&#x771F;&#x6B63;&#x7684;&#x5377;&#x79EF;&#x8FD0;&#x7B97;&#x4F1A;&#x5148;&#x5C06;&#x6EE4;&#x6CE2;&#x5668;&#x7ED5;&#x5176;<strong>&#x4E2D;&#x5FC3;&#x65CB;&#x8F6C;</strong>180&#x5EA6;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x5C06;&#x65CB;&#x8F6C;&#x540E;&#x7684;&#x6EE4;&#x6CE2;&#x5668;&#x5728;&#x539F;&#x59CB;&#x56FE;&#x7247;&#x4E0A;&#x8FDB;&#x884C;<strong>&#x6ED1;&#x52A8;&#x8BA1;&#x7B97;</strong>&#x3002;&#x6EE4;&#x6CE2;&#x5668;&#x65CB;&#x8F6C;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;</p>
        <p><img src="img/14.jpg" alt></p>
        <p>&#x6BD4;&#x8F83;&#x800C;&#x8A00;&#xFF0C;&#x76F8;&#x5173;&#x7CFB;&#x6570;&#x7684;&#x8BA1;&#x7B97;&#x8FC7;&#x7A0B;&#x5219;<strong>&#x4E0D;&#x4F1A;</strong>&#x5BF9;&#x6EE4;&#x6CE2;&#x5668;&#x8FDB;&#x884C;<strong>&#x65CB;&#x8F6C;</strong>&#xFF0C;&#x800C;&#x662F;&#x76F4;&#x63A5;&#x5728;&#x539F;&#x59CB;&#x56FE;&#x7247;&#x4E0A;&#x8FDB;&#x884C;&#x6ED1;&#x52A8;&#x8BA1;&#x7B97;&#x3002;</p>
        <p>&#x5176;&#x5B9E;&#xFF0C;&#x76EE;&#x524D;&#x4E3A;&#x6B62;&#x6211;&#x4EEC;&#x4ECB;&#x7ECD;&#x7684;CNN&#x5377;&#x79EF;&#x5B9E;&#x9645;&#x4E0A;&#x8BA1;&#x7B97;&#x7684;&#x662F;&#x76F8;&#x5173;&#x7CFB;&#x6570;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x6570;&#x5B66;&#x610F;&#x4E49;&#x4E0A;&#x7684;&#x5377;&#x79EF;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x4E3A;&#x4E86;<strong>&#x7B80;&#x5316;&#x8BA1;&#x7B97;</strong>&#xFF0C;&#x6211;&#x4EEC;&#x4E00;&#x822C;&#x628A;CNN&#x4E2D;&#x7684;&#x8FD9;&#x79CD;&#x201C;&#x76F8;&#x5173;&#x7CFB;&#x6570;&#x201D;&#x5C31;&#x79F0;&#x4F5C;&#x5377;&#x79EF;&#x8FD0;&#x7B97;&#x3002;</p>
        <p>&#x4E4B;&#x6240;&#x4EE5;&#x53EF;&#x4EE5;&#x8FD9;&#x4E48;&#x7B49;&#x6548;&#xFF0C;&#x662F;&#x56E0;&#x4E3A;&#x6EE4;&#x6CE2;&#x5668;&#x7B97;&#x5B50;&#x4E00;&#x822C;&#x662F;&#x6C34;&#x5E73;&#x6216;&#x5782;&#x76F4;&#x5BF9;&#x79F0;&#x7684;&#xFF0C;180&#x5EA6;&#x65CB;&#x8F6C;&#x5F71;&#x54CD;&#x4E0D;&#x5927;&#xFF1B;&#x800C;&#x4E14;&#x6700;&#x7EC8;&#x6EE4;&#x6CE2;&#x5668;&#x7B97;&#x5B50;&#x9700;&#x8981;&#x901A;&#x8FC7;CNN&#x7F51;&#x7EDC;&#x68AF;&#x5EA6;&#x4E0B;&#x964D;&#x7B97;&#x6CD5;&#x8BA1;&#x7B97;&#x5F97;&#x5230;&#xFF0C;&#x65CB;&#x8F6C;&#x90E8;&#x5206;&#x53EF;&#x4EE5;&#x770B;&#x4F5C;&#x662F;&#x5305;&#x542B;&#x5728;CNN&#x6A21;&#x578B;&#x7B97;&#x6CD5;&#x4E2D;&#x3002;&#x603B;&#x7684;&#x6765;&#x8BF4;&#xFF0C;&#x5FFD;&#x7565;&#x65CB;&#x8F6C;&#x8FD0;&#x7B97;&#x53EF;&#x4EE5;&#x5927;&#x5927;&#x63D0;&#x9AD8;CNN&#x7F51;&#x7EDC;&#x8FD0;&#x7B97;&#x901F;&#x5EA6;&#xFF0C;&#x800C;&#x4E14;&#x4E0D;&#x5F71;&#x54CD;&#x6A21;&#x578B;&#x6027;&#x80FD;&#x3002;</p>
        <p>&#x5377;&#x79EF;&#x8FD0;&#x7B97;&#x670D;&#x4ECE;&#x7ED3;&#x5408;&#x5F8B;&#xFF1A;<br>
        </p><div class="mathjax-exps">$$(A&#x2217;B)&#x2217;C=A&#x2217;(B&#x2217;C)$$</div><p></p>
        <h2 class="mume-header" id="%E5%8D%B7%E7%A7%AF%E4%B8%BA%E4%BD%95%E6%9C%89%E6%95%88">&#x5377;&#x79EF;&#x4E3A;&#x4F55;&#x6709;&#x6548;</h2>
        
        <p>&#x5BF9;&#x4E8E;3&#x901A;&#x9053;&#x7684;RGB&#x56FE;&#x7247;&#xFF0C;&#x5176;&#x5BF9;&#x5E94;&#x7684;&#x6EE4;&#x6CE2;&#x5668;&#x7B97;&#x5B50;&#x540C;&#x6837;&#x4E5F;&#x662F;3&#x901A;&#x9053;&#x7684;&#x3002;&#x4F8B;&#x5982;&#x4E00;&#x4E2A;&#x56FE;&#x7247;&#x662F;6 x 6 x 3&#xFF0C;&#x5206;&#x522B;&#x8868;&#x793A;&#x56FE;&#x7247;&#x7684;&#x9AD8;&#x5EA6;&#xFF08;height&#xFF09;&#x3001;&#x5BBD;&#x5EA6;&#xFF08;weight&#xFF09;&#x548C;&#x901A;&#x9053;&#xFF08;channel&#xFF09;&#x3002;</p>
        <p>3&#x901A;&#x9053;&#x56FE;&#x7247;&#x7684;&#x5377;&#x79EF;&#x8FD0;&#x7B97;&#x4E0E;&#x5355;&#x901A;&#x9053;&#x56FE;&#x7247;&#x7684;&#x5377;&#x79EF;&#x8FD0;&#x7B97;&#x57FA;&#x672C;&#x4E00;&#x81F4;&#x3002;&#x8FC7;&#x7A0B;&#x662F;&#x5C06;&#x6BCF;&#x4E2A;&#x5355;&#x901A;&#x9053;&#xFF08;R&#xFF0C;G&#xFF0C;B&#xFF09;&#x4E0E;&#x5BF9;&#x5E94;&#x7684;filter&#x8FDB;&#x884C;&#x5377;&#x79EF;&#x8FD0;&#x7B97;&#x6C42;&#x548C;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x5C06;3&#x901A;&#x9053;&#x7684;&#x548C;&#x76F8;&#x52A0;&#xFF0C;&#x5F97;&#x5230;&#x8F93;&#x51FA;&#x56FE;&#x7247;&#x7684;&#x4E00;&#x4E2A;&#x50CF;&#x7D20;&#x503C;&#x3002;</p>
        <p><img src="img/15.jpg" alt></p>
        <p>&#x4E0D;&#x540C;&#x901A;&#x9053;&#x7684;&#x6EE4;&#x6CE2;&#x7B97;&#x5B50;&#x53EF;&#x4EE5;&#x4E0D;&#x76F8;&#x540C;&#x3002;&#x4F8B;&#x5982;R&#x901A;&#x9053;&#x6EE4;&#x6CE2;&#x5668;&#x5B9E;&#x73B0;&#x5782;&#x76F4;&#x8FB9;&#x7F18;&#x68C0;&#x6D4B;&#xFF0C;G&#x548C;B&#x901A;&#x9053;&#x4E0D;&#x8FDB;&#x884C;&#x8FB9;&#x7F18;&#x68C0;&#x6D4B;&#xFF0C;&#x5168;&#x90E8;&#x7F6E;&#x96F6;&#xFF0C;&#x6216;&#x8005;&#x5C06;R&#xFF0C;G&#xFF0C;B&#x4E09;&#x901A;&#x9053;&#x6EE4;&#x6CE2;&#x5668;&#x5168;&#x90E8;&#x8BBE;&#x7F6E;&#x4E3A;&#x6C34;&#x5E73;&#x8FB9;&#x7F18;&#x68C0;&#x6D4B;&#x3002;</p>
        <p>&#x4E3A;&#x4E86;&#x8FDB;&#x884C;&#x591A;&#x4E2A;&#x5377;&#x79EF;&#x8FD0;&#x7B97;&#xFF0C;&#x5B9E;&#x73B0;&#x66F4;&#x591A;&#x8FB9;&#x7F18;&#x68C0;&#x6D4B;&#xFF0C;&#x53EF;&#x4EE5;&#x589E;&#x52A0;&#x66F4;&#x591A;&#x7684;&#x6EE4;&#x6CE2;&#x5668;&#x7EC4;&#x3002;&#x4F8B;&#x5982;&#x8BBE;&#x7F6E;&#x7B2C;&#x4E00;&#x4E2A;&#x6EE4;&#x6CE2;&#x5668;&#x7EC4;&#x5B9E;&#x73B0;&#x5782;&#x76F4;&#x8FB9;&#x7F18;&#x68C0;&#x6D4B;&#xFF0C;&#x7B2C;&#x4E8C;&#x4E2A;&#x6EE4;&#x6CE2;&#x5668;&#x7EC4;&#x5B9E;&#x73B0;&#x6C34;&#x5E73;&#x8FB9;&#x7F18;&#x68C0;&#x6D4B;&#x3002;&#x8FD9;&#x6837;&#xFF0C;&#x4E0D;&#x540C;&#x6EE4;&#x6CE2;&#x5668;&#x7EC4;&#x5377;&#x79EF;&#x5F97;&#x5230;&#x4E0D;&#x540C;&#x7684;&#x8F93;&#x51FA;&#xFF0C;&#x4E2A;&#x6570;&#x7531;&#x6EE4;&#x6CE2;&#x5668;&#x7EC4;&#x51B3;&#x5B9A;&#x3002;</p>
        <p><img src="img/16.jpg" alt></p>
        <p>&#x82E5;&#x8F93;&#x5165;&#x56FE;&#x7247;&#x7684;&#x5C3A;&#x5BF8;&#x4E3A;<span class="mathjax-exps">$n &#xD7; n &#xD7; n_c$</span>&#xFF0C;&#x6EE4;&#x6CE2;&#x5668;&#x5C3A;&#x5BF8;&#x4E3A;<span class="mathjax-exps">$f &#xD7; f &#xD7; n_c$</span>&#xFF0C;&#x5219;&#x5377;&#x79EF;&#x540E;&#x7684;&#x56FE;&#x7247;&#x5C3A;&#x5BF8;&#x4E3A;<span class="mathjax-exps">$(n-f+1) &#xD7; (n-f+1) &#xD7; n_c&apos;$</span>&#x3002;&#x5176;&#x4E2D;&#xFF0C;<span class="mathjax-exps">$n_c$</span>&#x4E3A;<strong>&#x56FE;&#x7247;&#x901A;&#x9053;</strong>&#x6570;&#x76EE;&#xFF0C;<span class="mathjax-exps">$n_c&apos;$</span>&#x4E3A;<strong>&#x6EE4;&#x6CE2;&#x5668;&#x7EC4;</strong>&#x4E2A;&#x6570;&#x3002;</p>
        <h2 class="mume-header" id="%E5%8D%95%E5%B1%82%E5%8D%B7%E7%A7%AF%E7%BD%91%E7%BB%9C">&#x5355;&#x5C42;&#x5377;&#x79EF;&#x7F51;&#x7EDC;</h2>
        
        <p>&#x5377;&#x79EF;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x7684;&#x5355;&#x5C42;&#x7ED3;&#x6784;&#x5982;&#x4E0B;&#x6240;&#x793A;&#xFF1A;</p>
        <p><img src="img/17.jpg" alt></p>
        <p>&#x76F8;&#x6BD4;&#x4E4B;&#x524D;&#x7684;&#x5377;&#x79EF;&#x8FC7;&#x7A0B;&#xFF0C;CNN&#x7684;&#x5355;&#x5C42;&#x7ED3;&#x6784;&#x591A;&#x4E86;&#x6FC0;&#x6D3B;&#x51FD;&#x6570;ReLU&#x548C;&#x504F;&#x79FB;&#x91CF;b&#x3002;&#x6574;&#x4E2A;&#x8FC7;&#x7A0B;&#x4E0E;&#x6807;&#x51C6;&#x7684;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x5355;&#x5C42;&#x7ED3;&#x6784;&#x975E;&#x5E38;&#x7C7B;&#x4F3C;&#xFF1A;<br>
        </p><div class="mathjax-exps">$$Z^{[l]}=W^{[l]}A^{[l-1]}+b$$</div><p></p>
        <p></p><div class="mathjax-exps">$$A^{[l]}=g^{[l]}(Z^{[l]})$$</div><p></p>
        <p>&#x76F8;&#x6BD4;&#x4E4B;&#x524D;&#x7684;&#x5377;&#x79EF;&#x8FC7;&#x7A0B;&#xFF0C;CNN&#x7684;&#x5355;&#x5C42;&#x7ED3;&#x6784;&#x591A;&#x4E86;&#x6FC0;&#x6D3B;&#x51FD;&#x6570;ReLU&#x548C;&#x504F;&#x79FB;&#x91CF;b&#x3002;&#x6574;&#x4E2A;&#x8FC7;&#x7A0B;&#x4E0E;&#x6807;&#x51C6;&#x7684;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x5355;&#x5C42;&#x7ED3;&#x6784;&#x975E;&#x5E38;&#x7C7B;&#x4F3C;&#xFF1A;</p>
        <p>&#x5377;&#x79EF;&#x8FD0;&#x7B97;&#x5BF9;&#x5E94;&#x7740;&#x4E0A;&#x5F0F;&#x4E2D;&#x7684;&#x4E58;&#x79EF;&#x8FD0;&#x7B97;&#xFF0C;<strong>&#x6EE4;&#x6CE2;&#x5668;&#x7EC4;&#x6570;&#x503C;&#x5BF9;&#x5E94;&#x7740;&#x6743;&#x91CD;</strong><span class="mathjax-exps">$W^{[l]}$</span>&#xFF0C;&#x6240;&#x9009;&#x7684;&#x6FC0;&#x6D3B;&#x51FD;&#x6570;&#x4E3A;ReLU&#x3002;</p>
        <p>&#x6211;&#x4EEC;&#x6765;&#x8BA1;&#x7B97;&#x4E00;&#x4E0B;&#x4E0A;&#x56FE;&#x4E2D;&#x53C2;&#x6570;&#x7684;&#x6570;&#x76EE;&#xFF1A;&#x6BCF;&#x4E2A;&#x6EE4;&#x6CE2;&#x5668;&#x7EC4;&#x6709;3x3x3=27&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x8FD8;&#x6709;1&#x4E2A;&#x504F;&#x79FB;&#x91CF;b&#xFF0C;&#x5219;&#x6BCF;&#x4E2A;&#x6EE4;&#x6CE2;&#x5668;&#x7EC4;&#x6709;27+1=28&#x4E2A;&#x53C2;&#x6570;&#xFF0C;&#x4E24;&#x4E2A;&#x6EE4;&#x6CE2;&#x5668;&#x7EC4;&#x603B;&#x5171;&#x5305;&#x542B;28x2=56&#x4E2A;&#x53C2;&#x6570;&#x3002;&#x6211;&#x4EEC;&#x53D1;&#x73B0;&#xFF0C;&#x9009;&#x5B9A;&#x6EE4;&#x6CE2;&#x5668;&#x7EC4;&#x540E;&#xFF0C;&#x53C2;&#x6570;&#x6570;&#x76EE;&#x4E0E;&#x8F93;&#x5165;&#x56FE;&#x7247;&#x5C3A;&#x5BF8;&#x65E0;&#x5173;&#x3002;&#x6240;&#x4EE5;&#xFF0C;&#x5C31;&#x4E0D;&#x5B58;&#x5728;&#x7531;&#x4E8E;&#x56FE;&#x7247;&#x5C3A;&#x5BF8;&#x8FC7;&#x5927;&#xFF0C;&#x9020;&#x6210;&#x53C2;&#x6570;&#x8FC7;&#x591A;&#x7684;&#x60C5;&#x51B5;&#x3002;&#x4F8B;&#x5982;&#x4E00;&#x5F20;1000x1000x3&#x7684;&#x56FE;&#x7247;&#xFF0C;&#x6807;&#x51C6;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x8F93;&#x5165;&#x5C42;&#x7684;&#x7EF4;&#x5EA6;&#x5C06;&#x8FBE;&#x5230;3&#x767E;&#x4E07;&#xFF0C;&#x800C;&#x5728;CNN&#x4E2D;&#xFF0C;&#x53C2;&#x6570;&#x6570;&#x76EE;&#x53EA;&#x7531;&#x6EE4;&#x6CE2;&#x5668;&#x7EC4;&#x51B3;&#x5B9A;&#xFF0C;&#x6570;&#x76EE;&#x76F8;&#x5BF9;&#x6765;&#x8BF4;&#x8981;&#x5C11;&#x5F97;&#x591A;&#xFF0C;&#x8FD9;&#x662F;CNN&#x7684;&#x4F18;&#x52BF;&#x4E4B;&#x4E00;&#x3002;</p>
        <p>&#x6700;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x603B;&#x7ED3;&#x4E00;&#x4E0B;CNN&#x5355;&#x5C42;&#x7ED3;&#x6784;&#x7684;&#x6240;&#x6709;&#x6807;&#x8BB0;&#x7B26;&#x53F7;&#xFF0C;&#x8BBE;&#x5C42;&#x6570;&#x4E3A;<span class="mathjax-exps">$l$</span>&#x3002;</p>
        <ul>
        <li><span class="mathjax-exps">$f^{[l]}$</span>= &#x6EE4;&#x6CE2;&#x5668;&#x5927;&#x5C0F;</li>
        <li><span class="mathjax-exps">$p^{[l]}$</span> = &#x586B;&#x5145;</li>
        <li><span class="mathjax-exps">$s^{[l]}$</span>= &#x6B65;&#x957F;</li>
        <li><span class="mathjax-exps">$n_c^{[l]}$</span> = &#x6EE4;&#x6CE2;&#x5668;&#x7EC4;&#x6570;&#x91CF;</li>
        </ul>
        <p>&#x8F93;&#x5165;&#x7EF4;&#x5EA6;&#x4E3A;&#xFF1A;<span class="mathjax-exps">$n_H^{[l-1]}&#xD7;n_W^{[l-1]}&#xD7;n_c^{[l-1]}$</span></p>
        <p>&#x6BCF;&#x4E2A;&#x6EE4;&#x6CE2;&#x5668;&#x7EC4;&#x7EF4;&#x5EA6;&#x4E3A;&#xFF1A;<span class="mathjax-exps">$f^{[l]} &#xD7; f^{[l]} &#xD7; n_c^{[l-1]}$</span></p>
        <p>&#x6743;&#x91CD;&#x7EF4;&#x5EA6;&#x4E3A;&#xFF1A;<span class="mathjax-exps">$f^{[l]}&#xD7;f^{[l]}&#xD7;n_c^{[l-1]}&#xD7;n_c^{[l]}$</span></p>
        <p>&#x504F;&#x7F6E;&#x7EF4;&#x5EA6;&#x4E3A;&#xFF1A;<span class="mathjax-exps">$1 &#xD7; 1 &#xD7; 1 &#xD7;n_c^{[l]}$</span></p>
        <p>&#x8F93;&#x51FA;&#x7EF4;&#x5EA6;&#x4E3A;&#xFF1A;<span class="mathjax-exps">$n_H^{[l]}&#xD7;n_W^{[l]}&#xD7;n_c^{[l]}$</span></p>
        <p>&#x5176;&#x4E2D;&#xFF0C;</p>
        <p></p><div class="mathjax-exps">$$n_H^{[l]}=\lfloor \frac{n_H^{[l-1]}+2p^{[l]}-f^{[l]}}{s^{[l]}}+1 \rfloor$$</div><p></p>
        <p></p><div class="mathjax-exps">$$n_W^{[l]}=\lfloor \frac{n_W^{[l-1]}+2p^{[l]}-f^{[l]}}{s^{[l]}}+1 \rfloor$$</div><p></p>
        <p>&#x5982;&#x679C;&#x6709;m&#x4E2A;&#x6837;&#x672C;&#xFF0C;&#x8FDB;&#x884C;&#x5411;&#x91CF;&#x5316;&#x8FD0;&#x7B97;&#xFF0C;&#x76F8;&#x5E94;&#x7684;&#x8F93;&#x51FA;&#x7EF4;&#x5EA6;&#x4E3A;&#xFF1A;</p><div class="mathjax-exps">$$m &#xD7; n_H^{[l]}&#xD7;n_W^{[l]}&#xD7;n_c^{[l]}$$</div><p></p>
        <h2 class="mume-header" id="%E7%AE%80%E5%8D%95%E7%9A%84%E5%8D%B7%E7%A7%AF%E7%BD%91%E7%BB%9C%E7%A4%BA%E4%BE%8B">&#x7B80;&#x5355;&#x7684;&#x5377;&#x79EF;&#x7F51;&#x7EDC;&#x793A;&#x4F8B;</h2>
        
        <p>&#x4E0B;&#x9762;&#x4ECB;&#x7ECD;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;CNN&#x7F51;&#x7EDC;&#x6A21;&#x578B;&#xFF1A;</p>
        <p><img src="img/18.jpg" alt></p>
        <p>&#x8BE5;CNN&#x6A21;&#x578B;&#x5404;&#x5C42;&#x7ED3;&#x6784;&#x5982;&#x4E0A;&#x56FE;&#x6240;&#x793A;&#x3002;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;&#xFF0C;<span class="mathjax-exps">$a^{[3]}$</span>&#x7684;&#x7EF4;&#x5EA6;&#x662F;7 x 7 x 40&#xFF0C;&#x5C06;<span class="mathjax-exps">$a^{[3]}$</span>&#x6392;&#x5217;&#x6210;1&#x5217;&#xFF0C;&#x7EF4;&#x5EA6;&#x4E3A;1960 x 1&#xFF0C;&#x7136;&#x540E;&#x8FDE;&#x63A5;&#x6700;&#x540E;&#x4E00;&#x7EA7;&#x8F93;&#x51FA;&#x5C42;&#x3002;&#x8F93;&#x51FA;&#x5C42;&#x53EF;&#x4EE5;&#x662F;&#x4E00;&#x4E2A;&#x795E;&#x7ECF;&#x5143;&#xFF0C;&#x5373;&#x4E8C;&#x5143;&#x5206;&#x7C7B;&#xFF08;logistic&#xFF09;&#xFF1B;&#x4E5F;&#x53EF;&#x4EE5;&#x662F;&#x591A;&#x4E2A;&#x795E;&#x7ECF;&#x5143;&#xFF0C;&#x5373;&#x591A;&#x5143;&#x5206;&#x7C7B;&#xFF08;softmax&#xFF09;&#x3002;&#x6700;&#x540E;&#x5F97;&#x5230;&#x9884;&#x6D4B;&#x8F93;&#x51FA;<span class="mathjax-exps">$\hat y$</span>&#x3002;</p>
        <p>&#x503C;&#x5F97;&#x4E00;&#x63D0;&#x7684;&#x662F;&#xFF0C;&#x968F;&#x7740;CNN&#x5C42;&#x6570;&#x589E;&#x52A0;&#xFF0C;<span class="mathjax-exps">$n_H^{[l]}$</span>&#x548C;<span class="mathjax-exps">$n_W^{[l]}$</span>&#x4E00;&#x822C;&#x9010;&#x6E10;&#x51CF;&#x5C0F;&#xFF0C;&#x800C;<span class="mathjax-exps">$n_c^{[l]}$</span>&#x4E00;&#x822C;&#x9010;&#x6E10;&#x589E;&#x5927;&#x3002;</p>
        <p>CNN&#x6709;&#x4E09;&#x79CD;&#x5C42;&#xFF1A;</p>
        <ul>
        <li><strong>&#x5377;&#x79EF;&#x5C42;&#xFF08;CONV&#xFF09;</strong></li>
        <li><strong>&#x6C60;&#x5316;&#x5C42;&#xFF08;POOL&#xFF09;</strong></li>
        <li><strong>&#x5168;&#x8FDE;&#x63A5;&#x5C42;&#xFF08;FC&#xFF09;</strong></li>
        </ul>
        <p>CONV&#x6700;&#x4E3A;&#x5E38;&#x89C1;&#x4E5F;&#x6700;&#x91CD;&#x8981;&#xFF0C;&#x5173;&#x4E8E;POOL&#x548C;FC&#x6211;&#x4EEC;&#x4E4B;&#x540E;&#x518D;&#x4ECB;&#x7ECD;&#x3002;</p>
        <h2 class="mume-header" id="%E6%B1%A0%E5%8C%96%E5%B1%82">&#x6C60;&#x5316;&#x5C42;</h2>
        
        <p>&#x6C60;&#x5316;&#x5C42;&#x662F;CNN&#x4E2D;&#x7528;&#x6765;&#x51CF;&#x5C0F;&#x5C3A;&#x5BF8;&#xFF0C;<strong>&#x63D0;&#x9AD8;&#x8FD0;&#x7B97;&#x901F;&#x5EA6;</strong>&#x7684;&#xFF0C;&#x540C;&#x6837;&#x80FD;<strong>&#x51CF;&#x5C0F;&#x566A;&#x58F0;&#x5F71;&#x54CD;</strong>&#xFF0C;&#x8BA9;&#x5404;&#x7279;&#x5F81;&#x66F4;&#x5177;&#x6709;&#x5065;&#x58EE;&#x6027;&#x3002;</p>
        <p>&#x6C60;&#x5316;&#x5C42;&#x7684;&#x505A;&#x6CD5;&#x6BD4;&#x5377;&#x79EF;&#x5C42;&#x7B80;&#x5355;&#x8BB8;&#x591A;&#xFF0C;&#x6CA1;&#x6709;&#x5377;&#x79EF;&#x8FD0;&#x7B97;&#xFF0C;&#x4EC5;&#x4EC5;&#x662F;&#x5728;&#x6EE4;&#x6CE2;&#x5668;&#x7B97;&#x5B50;&#x6ED1;&#x52A8;&#x533A;&#x57DF;&#x5185;&#x53D6;&#x6700;&#x5927;&#x503C;&#xFF0C;&#x5373;&#x6700;&#x5927;&#x6C60;&#x5316;(max pooling)&#xFF0C;&#x8FD9;&#x662F;&#x6700;&#x5E38;&#x7528;&#x7684;&#x505A;&#x6CD5;&#x3002;&#x6CE8;&#x610F;&#xFF0C;&#x8D85;&#x53C2;&#x6570;p&#x5F88;&#x5C11;&#x5728;&#x6C60;&#x5316;&#x5C42;&#x4E2D;&#x4F7F;&#x7528;&#x3002;</p>
        <p><img src="img/19.jpg" alt></p>
        <p>&#x6700;&#x5927;&#x6C60;&#x5316;&#x7684;&#x597D;&#x5904;&#x662F;&#x53EA;&#x4FDD;&#x7559;&#x533A;&#x57DF;&#x5185;&#x7684;&#x6700;&#x5927;&#x503C;&#xFF08;&#x7279;&#x5F81;&#xFF09;&#xFF0C;&#x5FFD;&#x7565;&#x5176;&#x5B83;&#x503C;&#xFF0C;<strong>&#x964D;&#x4F4E;&#x566A;&#x58F0;&#x5F71;&#x54CD;</strong>&#xFF0C;&#x63D0;&#x9AD8;&#x6A21;&#x578B;&#x5065;&#x58EE;&#x6027;&#x3002;&#x800C;&#x4E14;&#xFF0C;&#x566A;&#x58F0;&#x9700;&#x8981;&#x7684;&#x8D85;&#x53C2;&#x6570;&#x4EC5;&#x4E3A;&#x6EE4;&#x6CE2;&#x5668;&#x5C3A;&#x5BF8;f&#x548C;&#x6EE4;&#x6CE2;&#x5668;&#x6B65;&#x8FDB;&#x957F;&#x5EA6;s&#xFF0C;&#x6CA1;&#x6709;&#x5176;&#x4ED6;&#x53C2;&#x6570;&#x9700;&#x8981;&#x6A21;&#x578B;&#x8BAD;&#x7EC3;&#x5F97;&#x5230;&#xFF0C;&#x8BA1;&#x7B97;&#x91CF;&#x5F88;&#x5C0F;&#x3002;</p>
        <p>&#x5982;&#x679C;&#x662F;&#x591A;&#x4E2A;&#x901A;&#x9053;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x6BCF;&#x4E2A;&#x901A;&#x9053;&#x5355;&#x72EC;&#x8FDB;&#x884C;&#x6700;&#x5927;&#x6C60;&#x5316;&#x64CD;&#x4F5C;&#x3002;</p>
        <p>&#x9664;&#x4E86;&#x6700;&#x5927;&#x6C60;&#x5316;&#x4E4B;&#x5916;&#xFF0C;&#x8FD8;&#x6709;&#x4E00;&#x79CD;&#x505A;&#x6CD5;&#xFF1A;&#x5E73;&#x5747;&#x6C60;&#x5316;(average pooling)&#x3002;&#x987E;&#x540D;&#x601D;&#x4E49;&#xFF0C;&#x5E73;&#x5747;&#x6C60;&#x5316;&#x5C31;&#x662F;&#x5728;&#x6EE4;&#x6CE2;&#x5668;&#x7B97;&#x5B50;&#x6ED1;&#x52A8;&#x533A;&#x57DF;&#x8BA1;&#x7B97;&#x5E73;&#x5747;&#x503C;&#x3002;</p>
        <p><img src="img/20.jpg" alt></p>
        <p>&#x5B9E;&#x9645;&#x5E94;&#x7528;&#x4E2D;&#xFF0C;&#x6700;&#x5927;&#x6C60;&#x5316;&#x6BD4;&#x5E73;&#x5747;&#x6C60;&#x5316;&#x66F4;&#x4E3A;&#x5E38;&#x7528;&#x3002;</p>
        <h2 class="mume-header" id="cnn%E7%A4%BA%E4%BE%8B">CNN&#x793A;&#x4F8B;</h2>
        
        <p>&#x4E0B;&#x9762;&#x4ECB;&#x7ECD;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x6570;&#x5B57;&#x8BC6;&#x522B;&#x7684;CNN&#x4F8B;&#x5B50;&#xFF1A;</p>
        <p><img src="img/21.jpg" alt></p>
        <p>&#x56FE;&#x4E2D;&#xFF0C;CON&#x5C42;&#x540E;&#x9762;&#x7D27;&#x63A5;&#x4E00;&#x4E2A;POOL&#x5C42;&#xFF0C;CONV1&#x548C;POOL1&#x6784;&#x6210;&#x7B2C;&#x4E00;&#x5C42;&#xFF0C;CONV2&#x548C;POOL2&#x6784;&#x6210;&#x7B2C;&#x4E8C;&#x5C42;&#x3002;&#x7279;&#x522B;&#x6CE8;&#x610F;&#x7684;&#x662F;FC3&#x548C;FC4&#x4E3A;&#x5168;&#x8FDE;&#x63A5;&#x5C42;FC&#xFF0C;&#x5B83;&#x8DDF;&#x6807;&#x51C6;&#x7684;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x7ED3;&#x6784;&#x4E00;&#x81F4;&#x3002;&#x6700;&#x540E;&#x7684;&#x8F93;&#x51FA;&#x5C42;&#xFF08;softmax&#xFF09;&#x7531;10&#x4E2A;&#x795E;&#x7ECF;&#x5143;&#x6784;&#x6210;&#x3002;</p>
        <p>&#x6574;&#x4E2A;&#x7F51;&#x7EDC;&#x5404;&#x5C42;&#x7684;&#x5C3A;&#x5BF8;&#x548C;&#x53C2;&#x6570;&#x5982;&#x4E0B;&#x8868;&#x683C;&#x6240;&#x793A;&#xFF1A;</p>
        <p><img src="img/22.jpg" alt></p>
        <h2 class="mume-header" id="%E4%BD%BF%E7%94%A8%E5%8D%B7%E7%A7%AF%E7%9A%84%E5%8E%9F%E5%9B%A0">&#x4F7F;&#x7528;&#x5377;&#x79EF;&#x7684;&#x539F;&#x56E0;</h2>
        
        <p>&#x76F8;&#x6BD4;&#x6807;&#x51C6;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#xFF0C;CNN&#x7684;&#x4F18;&#x52BF;&#x4E4B;&#x4E00;&#x5C31;&#x662F;&#x53C2;&#x6570;&#x6570;&#x76EE;&#x8981;&#x5C11;&#x5F97;&#x591A;&#x3002;&#x53C2;&#x6570;&#x6570;&#x76EE;&#x5C11;&#x7684;&#x539F;&#x56E0;&#x6709;&#x4E24;&#x4E2A;&#xFF1A;</p>
        <ul>
        <li><strong>&#x53C2;&#x6570;&#x5171;&#x4EAB;&#xFF1A;&#x4E00;&#x4E2A;&#x7279;&#x5F81;&#x68C0;&#x6D4B;&#x5668;&#xFF08;&#x4F8B;&#x5982;&#x5782;&#x76F4;&#x8FB9;&#x7F18;&#x68C0;&#x6D4B;&#xFF09;&#x5BF9;&#x56FE;&#x7247;&#x67D0;&#x5757;&#x533A;&#x57DF;&#x6709;&#x7528;&#xFF0C;&#x540C;&#x65F6;&#x4E5F;&#x53EF;&#x80FD;&#x4F5C;&#x7528;&#x5728;&#x56FE;&#x7247;&#x5176;&#x5B83;&#x533A;&#x57DF;&#x3002;</strong></li>
        <li><strong>&#x8FDE;&#x63A5;&#x7684;&#x7A00;&#x758F;&#x6027;&#xFF1A;&#x56E0;&#x4E3A;&#x6EE4;&#x6CE2;&#x5668;&#x7B97;&#x5B50;&#x5C3A;&#x5BF8;&#x9650;&#x5236;&#xFF0C;&#x6BCF;&#x4E00;&#x5C42;&#x7684;&#x6BCF;&#x4E2A;&#x8F93;&#x51FA;&#x53EA;&#x4E0E;&#x8F93;&#x5165;&#x90E8;&#x5206;&#x533A;&#x57DF;&#x5185;&#x6709;&#x5173;&#x3002;</strong></li>
        </ul>
        <p>&#x9664;&#x6B64;&#x4E4B;&#x5916;&#xFF0C;&#x7531;&#x4E8E;CNN&#x53C2;&#x6570;&#x6570;&#x76EE;&#x8F83;&#x5C0F;&#xFF0C;&#x6240;&#x9700;&#x7684;&#x8BAD;&#x7EC3;&#x6837;&#x672C;&#x5C31;&#x76F8;&#x5BF9;&#x8F83;&#x5C11;&#xFF0C;&#x4ECE;&#x800C;&#x4E00;&#x5B9A;&#x7A0B;&#x5EA6;&#x4E0A;&#x4E0D;&#x5BB9;&#x6613;&#x53D1;&#x751F;&#x8FC7;&#x62DF;&#x5408;&#x73B0;&#x8C61;&#x3002;&#x800C;&#x4E14;&#xFF0C;CNN&#x6BD4;&#x8F83;&#x64C5;&#x957F;&#x6355;&#x6349;&#x533A;&#x57DF;&#x4F4D;&#x7F6E;&#x504F;&#x79FB;&#x3002;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;CNN&#x8FDB;&#x884C;&#x7269;&#x4F53;&#x68C0;&#x6D4B;&#x65F6;&#xFF0C;&#x4E0D;&#x592A;&#x53D7;&#x7269;&#x4F53;&#x6240;&#x5904;&#x56FE;&#x7247;&#x4F4D;&#x7F6E;&#x7684;&#x5F71;&#x54CD;&#xFF0C;&#x589E;&#x52A0;&#x68C0;&#x6D4B;&#x7684;&#x51C6;&#x786E;&#x6027;&#x548C;&#x7CFB;&#x7EDF;&#x7684;&#x5065;&#x58EE;&#x6027;&#x3002;</p>
        <h1 class="mume-header" id="%E4%B8%80%E6%AD%A5%E4%B8%80%E6%AD%A5%E5%AE%9E%E7%8E%B0cnn">&#x4E00;&#x6B65;&#x4E00;&#x6B65;&#x5B9E;&#x73B0;CNN</h1>
        
        <p>&#x8FD9;&#x91CC;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x4F1A;&#x7528;numpy&#x5B9E;&#x73B0;&#x5377;&#x79EF;(CONV)&#x548C;&#x6C60;&#x5316;(POOL)&#x5C42;, &#x5305;&#x62EC;&#x6B63;&#x5411;&#x548C;&#x53CD;&#x5411;&#x4F20;&#x64AD;&#x3002;</p>
        <h2 class="mume-header" id="%E7%AC%A6%E5%8F%B7%E6%B3%A8%E9%87%8A">&#x7B26;&#x53F7;&#x6CE8;&#x91CA;</h2>
        
        <ul>
        <li>
        <p>&#x4E0A;&#x6807; <span class="mathjax-exps">$[l]$</span> &#x8868;&#x793A;&#x7B2C; <span class="mathjax-exps">$l$</span> &#x5C42;&#x7684;&#x53C2;&#x6570;</p>
        </li>
        <li>
        <p>&#x4E0A;&#x6807; <span class="mathjax-exps">$(i)$</span> &#x8868;&#x793A;&#x7B2C; <span class="mathjax-exps">$i$</span> &#x4E2A;&#x6837;&#x672C;</p>
        </li>
        <li>
        <p>&#x4E0B;&#x6807; <span class="mathjax-exps">$i$</span> &#x8868;&#x793A;&#x7B2C;<span class="mathjax-exps">$i$</span> &#x4E2A;&#x5411;&#x91CF;&#x5206;&#x91CF;</p>
        </li>
        <li>
        <p><span class="mathjax-exps">$n_H$</span>, <span class="mathjax-exps">$n_W$</span> &#x548C; <span class="mathjax-exps">$n_C$</span> &#x8868;&#x793A;&#x6240;&#x7ED9;&#x5C42;&#x7684;&#x9AD8;&#xFF0C;&#x5BBD;&#x548C;&#x901A;&#x9053;&#x6570;&#x91CF;</p>
        </li>
        <li>
        <p><span class="mathjax-exps">$n_{H_{prev}}$</span>, <span class="mathjax-exps">$n_{W_{prev}}$</span> &#x548C; <span class="mathjax-exps">$n_{C_{prev}}$</span> &#x4E0A;&#x4E00;&#x5C42;&#x5C42;&#x7684;&#x9AD8;&#xFF0C;&#x5BBD;&#x548C;&#x901A;&#x9053;&#x6570;&#x91CF;</p>
        </li>
        </ul>
        <h2 class="mume-header" id="%E5%AF%BC%E5%8C%85">&#x5BFC;&#x5305;</h2>
        
        <pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
        <span class="token keyword">import</span> h5py
        <span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
        
        <span class="token operator">%</span>matplotlib inline
        plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">&apos;figure.figsize&apos;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token number">4.0</span><span class="token punctuation">)</span> <span class="token comment"># set default size of plots</span>
        plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">&apos;image.interpolation&apos;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&apos;nearest&apos;</span>
        plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">&apos;image.cmap&apos;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&apos;gray&apos;</span>
        
        <span class="token operator">%</span>load_ext autoreload
        <span class="token operator">%</span>autoreload <span class="token number">2</span>
        
        np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        </pre><h2 class="mume-header" id="%E4%BB%BB%E5%8A%A1%E5%A4%A7%E7%BA%B2">&#x4EFB;&#x52A1;&#x5927;&#x7EB2;</h2>
        
        <p>&#x60A8;&#x5C06;&#x5B9E;&#x73B0;&#x5377;&#x79EF;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x7684;&#x6784;&#x5EFA;&#x5757;!&#x60A8;&#x5C06;&#x5B9E;&#x73B0;&#x7684;&#x6BCF;&#x4E2A;&#x51FD;&#x6570;&#x90FD;&#x6709;&#x8BE6;&#x7EC6;&#x7684;&#x8BF4;&#x660E;&#xFF0C;&#x8FD9;&#x4E9B;&#x8BF4;&#x660E;&#x5C06;&#x6307;&#x5BFC;&#x60A8;&#x5B8C;&#x6210;&#x6240;&#x9700;&#x7684;&#x6B65;&#x9AA4;</p>
        <ul>
        <li>&#x5377;&#x79EF;&#x51FD;&#x6570;&#xFF0C;&#x5305;&#x62EC;&#xFF1A;
        <ul>
        <li>&#x96F6;&#x586B;&#x5145;(Zero Padding)</li>
        <li>&#x5377;&#x79EF;&#x7A97;&#x53E3;(Convolve window)</li>
        <li>&#x6B63;&#x5411;&#x5377;&#x79EF;(Convolution forward)</li>
        <li>&#x53CD;&#x5411;&#x5377;&#x79EF;(Convolution backward)&#x3010;&#x9009;&#x505A;&#x3011;</li>
        </ul>
        </li>
        <li>&#x6C60;&#x5316;&#x51FD;&#x6570;&#xFF0C;&#x5305;&#x62EC;&#xFF1A;
        <ul>
        <li>&#x6B63;&#x5411;&#x6C60;&#x5316;(Pooling forward)</li>
        <li>&#x521B;&#x5EFA;&#x8499;&#x7248;(Create mask)</li>
        <li>&#x5206;&#x914D;&#x6570;&#x503C;(Distribute value)</li>
        <li>&#x53CD;&#x5411;&#x6C60;&#x5316;(Pooling backward) &#x3010;&#x9009;&#x505A;&#x3011;</li>
        </ul>
        </li>
        </ul>
        <p>&#x8FD9;&#x91CC;&#x662F;&#x7528;<code>numpy</code>&#x4ECE;&#x96F6;&#x5F00;&#x59CB;&#x642D;&#x5EFA;CNN&#xFF0C;&#x4E0B;&#x4E00;&#x7AE0;&#x4F1A;&#x4F7F;&#x7528;TensorFlow&#x5B9E;&#x73B0;&#x3010;&#x4E5F;&#x53EF;&#x4EE5;&#x53BB;&#x8BD5;&#x8BD5;pytorch&#x54E6;&#x3011;&#x3002;</p>
        <p><strong>&#x6CE8;&#x610F;</strong>&#xFF1A;</p>
        <p>&#x5BF9;&#x4E8E;&#x6BCF;&#x4E2A;&#x6B63;&#x5411;&#x51FD;&#x6570;&#xFF0C;&#x90FD;&#x6709;&#x5BF9;&#x5E94;&#x7684;&#x53CD;&#x5411;&#x7B49;&#x4EF7;&#x51FD;&#x6570;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x5728;&#x8F6C;&#x53D1;&#x6A21;&#x5757;&#x7684;&#x6BCF;&#x4E00;&#x6B65;&#x4E2D;&#xFF0C;&#x60A8;&#x5C06;&#x5728;&#x7F13;&#x5B58;&#x4E2D;&#x5B58;&#x50A8;&#x4E00;&#x4E9B;&#x53C2;&#x6570;&#x3002;&#x8FD9;&#x4E9B;&#x53C2;&#x6570;&#x7528;&#x4E8E;&#x8BA1;&#x7B97;&#x53CD;&#x5411;&#x4F20;&#x64AD;&#x8FC7;&#x7A0B;&#x4E2D;&#x7684;&#x68AF;&#x5EA6;&#x3002;</p>
        <h2 class="mume-header" id="cnn">CNN</h2>
        
        <p>&#x5C3D;&#x7BA1;&#x7F16;&#x7A0B;&#x6846;&#x67B6;&#x4F7F;&#x5377;&#x79EF;&#x6613;&#x4E8E;&#x4F7F;&#x7528;&#xFF0C;&#x4F46;&#x5B83;&#x4EEC;&#x4ECD;&#x7136;&#x662F;&#x6DF1;&#x5EA6;&#x5B66;&#x4E60;&#x4E2D;&#x6700;&#x96BE;&#x7406;&#x89E3;&#x7684;&#x6982;&#x5FF5;&#x4E4B;&#x4E00;&#x3002;&#x3010;&#x5377;&#x79EF;&#x5C42;&#x4E3B;&#x8981;&#x662F;&#x5C06;&#x8F93;&#x5165;&#x91CF;&#x8F6C;&#x6362;&#x4E3A;&#x4E0D;&#x540C;&#x5927;&#x5C0F;&#x7684;&#x8F93;&#x51FA;&#x91CF;&#x3002;&#x3011;</p>
        <h3 class="mume-header" id="%E9%9B%B6%E5%A1%AB%E5%85%85">&#x96F6;&#x586B;&#x5145;</h3>
        
        <p>&#x586B;&#x5145;&#x7684;&#x4E3B;&#x8981;&#x4F18;&#x70B9;&#x5982;&#x4E0B;</p>
        <ul>
        <li>&#x5B83;&#x5141;&#x8BB8;&#x4F60;&#x4F7F;&#x7528;CONV&#x5C42;&#xFF0C;&#x800C;&#x4E0D;&#x5FC5;&#x7F29;&#x5C0F;&#x6837;&#x672C;&#x7684;&#x9AD8;&#x5EA6;&#x548C;&#x5BBD;&#x5EA6;&#x3002;&#x9AD8;&#x5EA6;/&#x5BBD;&#x5EA6;&#x4E0D;&#x4F1A;&#x968F;&#x7740;&#x4F60;&#x8FDB;&#x5165;&#x66F4;&#x6DF1;&#x5C42;&#x6B21;&#x800C;&#x7F29;&#x5C0F;&#xFF0C;&#x6240;&#x4EE5;&#x6709;&#x5229;&#x4E8E;&#x5EFA;&#x7ACB;&#x66F4;&#x6DF1;&#x5C42;&#x6B21;&#x7684;&#x7F51;&#x7EDC;&#x3002;&#x4E00;&#x4E2A;&#x91CD;&#x8981;&#x7684;&#x7279;&#x6B8A;&#x60C5;&#x51B5;&#x662F;&#x201C;&#x76F8;&#x540C;&#x201D;&#x5377;&#x79EF;&#xFF0C;&#x5373;&#x9AD8;&#x5EA6;/&#x5BBD;&#x5EA6;&#x5728;&#x4E00;&#x5C42;&#x4E4B;&#x540E;&#x88AB;&#x5B8C;&#x5168;&#x4FDD;&#x7559;&#x3002;</li>
        <li>&#x5B83;&#x5E2E;&#x52A9;&#x6211;&#x4EEC;&#x5728;&#x56FE;&#x50CF;&#x7684;<strong>&#x8FB9;&#x754C;</strong>&#x4E0A;&#x4FDD;&#x7559;&#x66F4;&#x591A;&#x7684;&#x4FE1;&#x606F;&#x3002;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x586B;&#x5145;&#xFF0C;&#x5F88;&#x5C11;&#x6709;&#x4E0B;&#x4E00;&#x5C42;&#x7684;&#x503C;&#x4F1A;&#x88AB;&#x4F5C;&#x4E3A;&#x56FE;&#x50CF;&#x8FB9;&#x7F18;&#x7684;&#x50CF;&#x7D20;&#x6240;&#x5F71;&#x54CD;&#x3002;</li>
        </ul>
        <pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># GRADED FUNCTION: zero_pad</span>
        
        <span class="token keyword">def</span> <span class="token function">zero_pad</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> pad<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token triple-quoted-string string">&quot;&quot;&quot;
            Pad with zeros all images of the dataset X. The padding is applied to the height and width of an image, 
            as illustrated in Figure 1.
            
            Argument:
            X -- python numpy array of shape (m, n_H, n_W, n_C) representing a batch of m images
            pad -- integer, amount of padding around each image on vertical and horizontal dimensions
            
            Returns:
            X_pad -- padded image of shape (m, n_H + 2*pad, n_W + 2*pad, n_C)
            &quot;&quot;&quot;</span>
            
            <span class="token comment">### START CODE HERE ### (&#x2248; 1 line)</span>
            <span class="token comment">#np.pad&#x7684;&#x53C2;&#x6570;(&#x8981;&#x6269;&#x5145;&#x7684;&#x6570;&#x7EC4;,((&#x7B2C;1&#x7EF4;&#x5EA6;&#x4E0A;&#x524D;/&#x540E;&#x6269;&#x5145;&#x591A;&#x5C11;),...),&#x56FA;&#x5B9A;&#x503C;)</span>
            X_pad <span class="token operator">=</span> np<span class="token punctuation">.</span>pad<span class="token punctuation">(</span>X<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>pad<span class="token punctuation">,</span> pad<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>pad<span class="token punctuation">,</span> pad<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&apos;constant&apos;</span><span class="token punctuation">)</span>
            <span class="token comment">### END CODE HERE ###</span>
            
            <span class="token keyword">return</span> X_pad
        </pre><p>&#x793A;&#x4F8B;</p>
        <pre data-role="codeBlock" data-info="python" class="language-python">np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        x <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
        x_pad <span class="token operator">=</span> zero_pad<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;x.shape =&quot;</span><span class="token punctuation">,</span> x<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
        <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;x_pad.shape =&quot;</span><span class="token punctuation">,</span> x_pad<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
        <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;x[1,1] =&quot;</span><span class="token punctuation">,</span> x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;x_pad[1,1] =&quot;</span><span class="token punctuation">,</span> x_pad<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        
        fig<span class="token punctuation">,</span> axarr <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
        axarr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">&apos;x&apos;</span><span class="token punctuation">)</span>
        axarr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        axarr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">&apos;x_pad&apos;</span><span class="token punctuation">)</span>
        axarr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>x_pad<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        </pre><p>&#x7ED3;&#x679C;</p>
        <p><img src="img/QQ%E6%88%AA%E5%9B%BE20200819185510.jpg" alt></p>
        <h3 class="mume-header" id="%E5%8D%95%E6%AD%A5%E5%8D%B7%E7%A7%AF">&#x5355;&#x6B65;&#x5377;&#x79EF;</h3>
        
        <p>&#x5728;&#x8FD9;&#x4E00;&#x90E8;&#x5206;&#x4E2D;&#xFF0C;&#x6267;&#x884C;&#x4E00;&#x4E2A;&#x5377;&#x79EF;&#x7684;&#x6B65;&#x9AA4;&#xFF0C;&#x5728;&#x8FD9;&#x4E2A;&#x6B65;&#x9AA4;&#x4E2D;&#xFF0C;&#x4F60;&#x5C06;&#x6EE4;&#x6CE2;&#x5668;&#x5E94;&#x7528;&#x5230;&#x8F93;&#x5165;&#x7684;&#x5355;&#x4E00;&#x4F4D;&#x7F6E;&#x3002;&#x8FD9;&#x5C06;&#x7528;&#x6765;&#x6784;&#x5EFA;&#x5377;&#x79EF;&#x5355;&#x5143;&#xFF0C;&#x5176;&#x4E2D;:</p>
        <ul>
        <li>&#x83B7;&#x53D6;&#x4E00;&#x4E2A;&#x8F93;&#x5165;</li>
        <li>&#x5728;&#x6BCF;&#x4E00;&#x4E2A;&#x8F93;&#x51FA;&#x4F4D;&#x7F6E;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x6EE4;&#x6CE2;&#x5668;</li>
        <li>&#x8F93;&#x51FA;&#xFF08;&#x5F80;&#x5F80;&#x4E0E;&#x8F93;&#x5165;shape&#x4E0D;&#x540C;&#xFF09;</li>
        </ul>
        <pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># GRADED FUNCTION: conv_single_step</span>
        
        <span class="token keyword">def</span> <span class="token function">conv_single_step</span><span class="token punctuation">(</span>a_slice_prev<span class="token punctuation">,</span> W<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token triple-quoted-string string">&quot;&quot;&quot;
            Apply one filter defined by parameters W on a single slice (a_slice_prev) of the output activation 
            of the previous layer.
            
            Arguments:
            a_slice_prev -- slice of input data of shape (f, f, n_C_prev)
            W -- Weight parameters contained in a window - matrix of shape (f, f, n_C_prev)
            b -- Bias parameters contained in a window - matrix of shape (1, 1, 1)
            
            Returns:
            Z -- a scalar value, result of convolving the sliding window (W, b) on a slice x of the input data
            &quot;&quot;&quot;</span>
        
            <span class="token comment">### START CODE HERE ### (&#x2248; 2 lines of code)</span>
            <span class="token comment"># &#x6C42;&#x53D6; a_slice &#x548C; W &#x7684;&#x5143;&#x7D20;&#x79EF;</span>
            s <span class="token operator">=</span> a_slice_prev <span class="token operator">*</span> W
            <span class="token comment"># &#x6C42; s &#x4E2D;&#x6240;&#x6709;&#x5143;&#x7D20;&#x7684;&#x548C;.</span>
            Z <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
            <span class="token comment"># &#x6DFB;&#x52A0;&#x504F;&#x7F6E; b &#x3010;&#x7528;float(),&#x4F7F;&#x7ED3;&#x679C;Z&#x4E3A;&#x6807;&#x91CF;&#x3011;</span>
            Z <span class="token operator">=</span> <span class="token builtin">float</span><span class="token punctuation">(</span>Z <span class="token operator">+</span> b<span class="token punctuation">)</span>
            <span class="token comment">### END CODE HERE ###</span>
        
            <span class="token keyword">return</span> Z
        </pre><h4 class="mume-header" id="%E7%A4%BA%E4%BE%8B">&#x793A;&#x4F8B;</h4>
        
        <pre data-role="codeBlock" data-info="python" class="language-python">np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        a_slice_prev <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
        W <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
        b <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
        
        Z <span class="token operator">=</span> conv_single_step<span class="token punctuation">(</span>a_slice_prev<span class="token punctuation">,</span> W<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Z =&quot;</span><span class="token punctuation">,</span> Z<span class="token punctuation">)</span>
        </pre><h4 class="mume-header" id="%E7%BB%93%E6%9E%9C">&#x7ED3;&#x679C;</h4>
        
        <pre data-role="codeBlock" data-info class="language-"><code>Z = -6.999089450680221
        </code></pre><h3 class="mume-header" id="%E5%89%8D%E9%A6%88">&#x524D;&#x9988;</h3>
        
        <p>&#x5728;&#x524D;&#x9988;&#x4E2D;&#xFF0C;&#x5C06;&#x4F7F;&#x7528;&#x8BB8;&#x591A;&#x8FC7;&#x6EE4;&#x5668;&#x5E76;&#x5BF9;&#x8F93;&#x5165;&#x8FDB;&#x884C;&#x5377;&#x79EF;&#x3002;&#x6BCF;&#x4E2A;&#x201C;&#x5377;&#x79EF;&#x201D;&#x90FD;&#x7ED9;&#x4F60;&#x4E00;&#x4E2A;2D&#x77E9;&#x9635;&#x8F93;&#x51FA;&#x3002;&#x7136;&#x540E;&#x60A8;&#x5C06;&#x5806;&#x53E0;&#x8FD9;&#x4E9B;&#x8F93;&#x51FA;&#xFF0C;&#x4EE5;&#x83B7;&#x5F97;&#x4E09;&#x7EF4;&#x4F53;&#x79EF;:</p>
        <h4 class="mume-header" id="%E5%89%8D%E6%8E%92%E6%8F%90%E9%86%92">&#x524D;&#x6392;&#x63D0;&#x9192;&#xFF1A;</h4>
        
        <p>&#x5377;&#x79EF;&#x7684;&#x8F93;&#x51FA;&#x5F62;&#x72B6;&#x4E0E;&#x8F93;&#x5165;&#x5F62;&#x72B6;&#x7684;&#x5173;&#x7CFB;&#x5F0F;&#x4E3A;&#xFF1A;<br>
        </p><div class="mathjax-exps">$$n_H = \lfloor \frac{n_{H_{prev}} - f + 2 \times pad}{stride} \rfloor +1$$</div><p></p>
        <p></p><div class="mathjax-exps">$$n_W = \lfloor \frac{n_{W_{prev}} - f + 2 \times pad}{stride} \rfloor +1$$</div><p></p>
        <p></p><div class="mathjax-exps">$$n_C = \text{&#x7528;&#x4E8E;&#x5377;&#x79EF;&#x7684;&#x8FC7;&#x6EE4;&#x5668;&#x6570;&#x91CF;}$$</div><p></p>
        <p>&#x5728;&#x8FD9;&#x4E2A;&#x7EC3;&#x4E60;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x4E0D;&#x9700;&#x8981;&#x62C5;&#x5FC3;&#x77E2;&#x91CF;&#x5316;&#xFF0C;&#x53EA;&#x9700;&#x8981;&#x7528;For&#x5FAA;&#x73AF;&#x6765;&#x5B9E;&#x73B0;&#x6240;&#x6709;&#x7684;&#x4E1C;&#x897F;&#x3002;</p>
        <pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># GRADED FUNCTION: conv_forward</span>
        
        <span class="token keyword">def</span> <span class="token function">conv_forward</span><span class="token punctuation">(</span>A_prev<span class="token punctuation">,</span> W<span class="token punctuation">,</span> b<span class="token punctuation">,</span> hparameters<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token triple-quoted-string string">&quot;&quot;&quot;
            Implements the forward propagation for a convolution function
            
            Arguments:
            A_prev -- output activations of the previous layer, numpy array of shape (m, n_H_prev, n_W_prev, n_C_prev)
            W -- Weights, numpy array of shape (f, f, n_C_prev, n_C)
            b -- Biases, numpy array of shape (1, 1, 1, n_C)
            hparameters -- python dictionary containing &quot;stride&quot; and &quot;pad&quot;
                
            Returns:
            Z -- conv output, numpy array of shape (m, n_H, n_W, n_C)
            cache -- cache of values needed for the conv_backward() function
            &quot;&quot;&quot;</span>
            
            <span class="token comment">### START CODE HERE ###</span>
            <span class="token comment"># A_prev&#x7684;shape&#x4E2D;&#x83B7;&#x5F97;&#x7EF4;&#x6570;  (&#x2248;1 line)  </span>
            <span class="token punctuation">(</span>m<span class="token punctuation">,</span> n_H_prev<span class="token punctuation">,</span> n_W_prev<span class="token punctuation">,</span> n_C_prev<span class="token punctuation">)</span> <span class="token operator">=</span> A_prev<span class="token punctuation">.</span>shape
            
            <span class="token comment"># W&#x7684;shape&#x4E2D;&#x83B7;&#x5F97;&#x7EF4;&#x6570; (&#x2248;1 line)</span>
            <span class="token punctuation">(</span>f<span class="token punctuation">,</span> f<span class="token punctuation">,</span> n_C_prev<span class="token punctuation">,</span> n_C<span class="token punctuation">)</span> <span class="token operator">=</span> W<span class="token punctuation">.</span>shape
            
            <span class="token comment"># &quot;hparameters&quot;&#x4E2D;&#x83B7;&#x5F97;&#x6570;&#x636E; (&#x2248;2 lines)</span>
            stride <span class="token operator">=</span> hparameters<span class="token punctuation">[</span><span class="token string">&apos;stride&apos;</span><span class="token punctuation">]</span>
            pad <span class="token operator">=</span> hparameters<span class="token punctuation">[</span><span class="token string">&apos;pad&apos;</span><span class="token punctuation">]</span>
            
            <span class="token comment"># &#x8BA1;&#x7B97;CONV&#x8F93;&#x51FA;&#x7684;&#x7EF4;&#x6570; &#x3010;&#x6CE8;&#xFF1A;&#x7528;int() &#x6765;&#x5B8C;&#x6210; floor&#x7684;&#x529F;&#x80FD;&#x3011; (&#x2248;2 lines)</span>
            n_H <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token punctuation">(</span>n_H_prev <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">*</span> pad <span class="token operator">-</span> f<span class="token punctuation">)</span> <span class="token operator">/</span> stride <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
            n_W <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token punctuation">(</span>n_W_prev <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">*</span> pad <span class="token operator">-</span> f<span class="token punctuation">)</span> <span class="token operator">/</span> stride <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
            
            <span class="token comment"># Z&#x8FDB;&#x884C;&#x96F6;&#x521D;&#x59CB;&#x5316;. (&#x2248;1 line)</span>
            Z <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> n_H<span class="token punctuation">,</span> n_W<span class="token punctuation">,</span> n_C<span class="token punctuation">)</span><span class="token punctuation">)</span>
            
            <span class="token comment"># &#x586B;&#x5145; A_prev</span>
            A_prev_pad <span class="token operator">=</span> zero_pad<span class="token punctuation">(</span>A_prev<span class="token punctuation">,</span> pad<span class="token punctuation">)</span>
            <span class="token comment"># &#x5FAA;&#x73AF;&#x904D;&#x5386;&#x8FD9;&#x6279;&#x8BAD;&#x7EC3;&#x6837;&#x672C;</span>
            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token comment"># &#x9009;&#x62E9;&#x7B2C;i&#x4E2A;&#x8BAD;&#x7EC3;&#x6837;&#x672C;&#x7684;&#x586B;&#x5145;&#x6FC0;&#x6D3B;</span>
                a_prev_pad <span class="token operator">=</span> A_prev_pad<span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>
                <span class="token comment"># &#x5FAA;&#x73AF;&#x904D;&#x5386;&#x7684;&#x5782;&#x76F4;&#x8F74;&#x4E0A;&#x7684;&#x8F93;&#x51FA;&#x6570;&#x503C;</span>
                <span class="token keyword">for</span> h <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n_H<span class="token punctuation">)</span><span class="token punctuation">:</span>
                    <span class="token comment"># &#x5FAA;&#x73AF;&#x904D;&#x5386;&#x7684;&#x6C34;&#x5E73;&#x8F74;&#x4E0A;&#x7684;&#x8F93;&#x51FA;&#x6570;&#x503C;</span>
                    <span class="token keyword">for</span> w <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n_W<span class="token punctuation">)</span><span class="token punctuation">:</span>
                        <span class="token comment"># &#x5FAA;&#x73AF;&#x904D;&#x5386;&#x7684;&#x901A;&#x9053;&#x4E0A;&#x7684;&#x8F93;&#x51FA;&#x6570;&#x503C;</span>
                        <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n_C<span class="token punctuation">)</span><span class="token punctuation">:</span>                   
                            
                            <span class="token comment"># &#x5BFB;&#x627E;&#x73B0;&#x5728;&#x7684;&quot;slice&quot;&#x3010;&#x5207;&#x7247;&#x3011; (&#x2248;4 lines)</span>
                            vert_start <span class="token operator">=</span> h <span class="token operator">*</span> stride
                            vert_end <span class="token operator">=</span> vert_start <span class="token operator">+</span> f
                            horiz_start <span class="token operator">=</span> w <span class="token operator">*</span> stride
                            horiz_end <span class="token operator">=</span> horiz_start <span class="token operator">+</span> f
                            
                            <span class="token comment"># &#x53D6;&#x51FA;&#x8981;&#x5377;&#x79EF;&#x7684;&#x90A3;&#x90E8;&#x5206;&#xFF08;3D&#xFF09; (&#x2248;1 line)</span>
                            a_slice_prev <span class="token operator">=</span> a_prev_pad<span class="token punctuation">[</span>vert_start <span class="token punctuation">:</span> vert_end<span class="token punctuation">,</span> horiz_start <span class="token punctuation">:</span> horiz_end<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>
                            
                            <span class="token comment"># &#x7528;&#x5408;&#x9002;&#x7684;&#x6EE4;&#x6CE2;&#x5668;W&#x548C;&#x504F;&#x7F6E;b&#x5BF9;(3D)&#x7247;&#x8FDB;&#x884C;&#x5377;&#x79EF;&#xFF0C;&#x5F97;&#x5230;&#x4E00;&#x4E2A;&#x8F93;&#x51FA;&#x795E;&#x7ECF;&#x5143;&#x3002; (&#x2248;1 line)</span>
                            Z<span class="token punctuation">[</span>i<span class="token punctuation">,</span> h<span class="token punctuation">,</span> w<span class="token punctuation">,</span> c<span class="token punctuation">]</span> <span class="token operator">=</span> conv_single_step<span class="token punctuation">(</span>a_slice_prev<span class="token punctuation">,</span> W<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span>c<span class="token punctuation">]</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span>c<span class="token punctuation">]</span><span class="token punctuation">)</span>
                                                
            <span class="token comment">### END CODE HERE ###</span>
            
            <span class="token comment"># &#x786E;&#x4FDD;&#x8F93;&#x51FA;&#x7684;shape&#x6B63;&#x786E;</span>
            <span class="token keyword">assert</span><span class="token punctuation">(</span>Z<span class="token punctuation">.</span>shape <span class="token operator">==</span> <span class="token punctuation">(</span>m<span class="token punctuation">,</span> n_H<span class="token punctuation">,</span> n_W<span class="token punctuation">,</span> n_C<span class="token punctuation">)</span><span class="token punctuation">)</span>
            
            <span class="token comment"># &#x4E3A;&#x53CD;&#x5411;&#x4F20;&#x64AD;&#x7F13;&#x5B58;</span>
            cache <span class="token operator">=</span> <span class="token punctuation">(</span>A_prev<span class="token punctuation">,</span> W<span class="token punctuation">,</span> b<span class="token punctuation">,</span> hparameters<span class="token punctuation">)</span>
            
            <span class="token keyword">return</span> Z<span class="token punctuation">,</span> cache
        </pre><h5 class="mume-header" id="%E7%A4%BA%E4%BE%8B-1">&#x793A;&#x4F8B;</h5>
        
        <pre data-role="codeBlock" data-info="python" class="language-python">np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        A_prev <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
        W <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span>
        b <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span>
        hparameters <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;pad&quot;</span> <span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
                       <span class="token string">&quot;stride&quot;</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">}</span>
        
        Z<span class="token punctuation">,</span> cache_conv <span class="token operator">=</span> conv_forward<span class="token punctuation">(</span>A_prev<span class="token punctuation">,</span> W<span class="token punctuation">,</span> b<span class="token punctuation">,</span> hparameters<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Z&apos;s mean =&quot;</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>Z<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Z[3,2,1] =&quot;</span><span class="token punctuation">,</span> Z<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;cache_conv[0][1][2][3] =&quot;</span><span class="token punctuation">,</span> cache_conv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        </pre><h5 class="mume-header" id="%E7%BB%93%E6%9E%9C-1">&#x7ED3;&#x679C;</h5>
        
        <pre data-role="codeBlock" data-info class="language-"><code>Z&apos;s mean = 0.0489952035289
        Z[3,2,1] = [-0.61490741 -6.7439236  -2.55153897  1.75698377  3.56208902  0.53036437
          5.18531798  8.75898442]
        cache_conv[0][1][2][3] = [-0.20075807  0.18656139  0.41005165]
        </code></pre><p>&#x6700;&#x540E;&#xFF0C;CONV&#x5C42;&#x8FD8;&#x5E94;&#x8BE5;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x6FC0;&#x6D3B;&#xFF0C;&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x6DFB;&#x52A0;&#x4EE5;&#x4E0B;&#x4EE3;&#x7801;&#x884C;</p>
        <pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># &#x5377;&#x79EF;&#x7A97;&#x53E3;&#x5F97;&#x5230;&#x4E00;&#x4E2A;&#x8F93;&#x51FA;&#x795E;&#x7ECF;&#x5143;</span>
        Z<span class="token punctuation">[</span>i<span class="token punctuation">,</span> h<span class="token punctuation">,</span> w<span class="token punctuation">,</span> c<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token comment"># &#x6FC0;&#x6D3B;&#x51FD;&#x6570;</span>
        A<span class="token punctuation">[</span>i<span class="token punctuation">,</span> h<span class="token punctuation">,</span> w<span class="token punctuation">,</span> c<span class="token punctuation">]</span> <span class="token operator">=</span> activation<span class="token punctuation">(</span>Z<span class="token punctuation">[</span>i<span class="token punctuation">,</span> h<span class="token punctuation">,</span> w<span class="token punctuation">,</span> c<span class="token punctuation">]</span><span class="token punctuation">)</span>
        </pre><h2 class="mume-header" id="%E6%B1%A0%E5%8C%96%E5%B1%82-1">&#x6C60;&#x5316;&#x5C42;</h2>
        
        <p>&#x6C60;&#x5316; (POOL) &#x5C42;&#x51CF;&#x5C11;&#x4E86;&#x8F93;&#x5165;&#x7684;&#x5BBD;&#x548C;&#x9AD8;&#x3002;&#x5B83;&#x6709;&#x6548;&#x5730;&#x51CF;&#x5C11;&#x4E86;&#x8BA1;&#x7B97;&#x91CF;&#xFF0C;&#x800C;&#x4E14;&#x4E5F;&#x6709;&#x52A9;&#x4E8E;&#x4F7F;&#x7279;&#x5F81;&#x68C0;&#x6D4B;&#x5668;&#x5BF9;&#x5176;&#x5728;&#x8F93;&#x5165;&#x4E2D;&#x7684;&#x4F4D;&#x7F6E;&#x4FDD;&#x6301;&#x4E0D;&#x53D8;&#x6027;&#x3002;</p>
        <h3 class="mume-header" id="%E5%B8%B8%E8%A7%81%E7%9A%84%E4%B8%A4%E7%A7%8Dpool%E5%B1%82">&#x5E38;&#x89C1;&#x7684;&#x4E24;&#x79CD;POOL&#x5C42;</h3>
        
        <ul>
        <li>
        <p><strong>&#x6700;&#x5927;&#x6C60;&#x5316;&#x5C42;</strong>(Max-pooling layer)&#xFF1A;&#x5728;&#x8F93;&#x5165;&#x4E0A;&#x6ED1;&#x52A8;&#x4E00;&#x4E2A; (<span class="mathjax-exps">$f, f$</span>) &#x7A97;&#x53E3; &#x5E76;&#x4E14;&#x5728;&#x8F93;&#x51FA;&#x91CC;&#x5B58;&#x50A8;&#x7A97;&#x53E3;&#x5143;&#x7D20;&#x7684;&#x6700;&#x5927;&#x503C;&#x3002;</p>
        </li>
        <li>
        <p><strong>&#x5E73;&#x5747;&#x6C60;&#x5316;&#x5C42;</strong>(Average-pooling layer)&#xFF1A;&#x5728;&#x8F93;&#x5165;&#x4E0A;&#x6ED1;&#x52A8;&#x4E00;&#x4E2A; (<span class="mathjax-exps">$f, f$</span>) &#x7A97;&#x53E3; &#x5E76;&#x4E14;&#x5728;&#x8F93;&#x51FA;&#x91CC;&#x5B58;&#x50A8;&#x7A97;&#x53E3;&#x5143;&#x7D20;&#x7684;&#x5E73;&#x5747;&#x503C;&#x3002;</p>
        </li>
        </ul>
        <p>&#x8FD9;&#x4E9B;&#x6C60;&#x5316;&#x5C42;&#x6CA1;&#x6709;&#x53C2;&#x6570;&#x4F9B;&#x53CD;&#x5411;&#x4F20;&#x64AD;&#x8BAD;&#x7EC3;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x5B83;&#x4EEC;&#x6709;&#x8D85;&#x53C2;&#x6570;&#xFF0C;&#x6BD4;&#x5982;&#x7A97;&#x53E3;&#x5927;&#x5C0F;<span class="mathjax-exps">$f$</span>&#x3002;&#x8FD9;&#x91CC;&#x6307;&#x5B9A;&#x4E86;&#x8981;&#x8BA1;&#x7B97;&#x6700;&#x5927;&#x503C;&#x6216;&#x5E73;&#x5747;&#x503C;&#x7684; <span class="mathjax-exps">$f&#xD7;f$</span> &#x7A97;&#x53E3;&#x7684;&#x9AD8;&#x5EA6;&#x548C;&#x5BBD;&#x5EA6;&#x3002;</p>
        <h3 class="mume-header" id="%E6%AD%A3%E5%90%91%E6%B1%A0%E5%8C%96">&#x6B63;&#x5411;&#x6C60;&#x5316;</h3>
        
        <p>&#x7531;&#x4E8E;&#x6CA1;&#x6709;&#x586B;&#x5145;&#xFF0C;&#x56E0;&#x6B64;&#x5C06;&#x6C60;&#x7684;&#x8F93;&#x51FA;&#x5F62;&#x72B6;&#x7ED1;&#x5B9A;&#x5230;&#x8F93;&#x5165;&#x5F62;&#x72B6;&#x7684;&#x516C;&#x5F0F;&#x4E3A;<br>
        </p><div class="mathjax-exps">$$n_H = \lfloor \frac{n_{H_{prev}} - f}{stride} \rfloor +1$$</div><p></p>
        <p></p><div class="mathjax-exps">$$n_W = \lfloor \frac{n_{W_{prev}} - f}{stride} \rfloor +1$$</div><p></p>
        <p></p><div class="mathjax-exps">$$n_C = n_{C_{prev}}$$</div><p></p>
        <pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># GRADED FUNCTION: pool_forward</span>
        
        <span class="token keyword">def</span> <span class="token function">pool_forward</span><span class="token punctuation">(</span>A_prev<span class="token punctuation">,</span> hparameters<span class="token punctuation">,</span> mode <span class="token operator">=</span> <span class="token string">&quot;max&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token triple-quoted-string string">&quot;&quot;&quot;
            Implements the forward pass of the pooling layer
            
            Arguments:
            A_prev -- Input data, numpy array of shape (m, n_H_prev, n_W_prev, n_C_prev)
            hparameters -- python dictionary containing &quot;f&quot; and &quot;stride&quot;
            mode -- the pooling mode you would like to use, defined as a string (&quot;max&quot; or &quot;average&quot;)
            
            Returns:
            A -- output of the pool layer, a numpy array of shape (m, n_H, n_W, n_C)
            cache -- cache used in the backward pass of the pooling layer, contains the input and hparameters 
            &quot;&quot;&quot;</span>
            
            <span class="token punctuation">(</span>m<span class="token punctuation">,</span> n_H_prev<span class="token punctuation">,</span> n_W_prev<span class="token punctuation">,</span> n_C_prev<span class="token punctuation">)</span> <span class="token operator">=</span> A_prev<span class="token punctuation">.</span>shape
            f <span class="token operator">=</span> hparameters<span class="token punctuation">[</span><span class="token string">&quot;f&quot;</span><span class="token punctuation">]</span>
            stride <span class="token operator">=</span> hparameters<span class="token punctuation">[</span><span class="token string">&quot;stride&quot;</span><span class="token punctuation">]</span>
            
            <span class="token comment"># &#x5B9A;&#x4E49;&#x8F93;&#x51FA;&#x7684;&#x7EF4;&#x5EA6;</span>
            n_H <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> <span class="token punctuation">(</span>n_H_prev <span class="token operator">-</span> f<span class="token punctuation">)</span> <span class="token operator">/</span> stride<span class="token punctuation">)</span>
            n_W <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> <span class="token punctuation">(</span>n_W_prev <span class="token operator">-</span> f<span class="token punctuation">)</span> <span class="token operator">/</span> stride<span class="token punctuation">)</span>
            n_C <span class="token operator">=</span> n_C_prev
            
            <span class="token comment"># &#x521D;&#x59CB;&#x5316;&#x8F93;&#x51FA;&#x77E9;&#x9635; A</span>
            A <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> n_H<span class="token punctuation">,</span> n_W<span class="token punctuation">,</span> n_C<span class="token punctuation">)</span><span class="token punctuation">)</span>              
            
            <span class="token comment">### START CODE HERE ###</span>
            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>                         
                <span class="token keyword">for</span> h <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n_H<span class="token punctuation">)</span><span class="token punctuation">:</span>                     
                    <span class="token keyword">for</span> w <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n_W<span class="token punctuation">)</span><span class="token punctuation">:</span>                
                        <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token builtin">range</span> <span class="token punctuation">(</span>n_C<span class="token punctuation">)</span><span class="token punctuation">:</span>         
                            vert_start <span class="token operator">=</span> h <span class="token operator">*</span> stride
                            vert_end <span class="token operator">=</span> vert_start <span class="token operator">+</span> f
                            horiz_start <span class="token operator">=</span> w <span class="token operator">*</span> stride
                            horiz_end <span class="token operator">=</span> horiz_start <span class="token operator">+</span> f
                            a_prev_slice <span class="token operator">=</span> A_prev<span class="token punctuation">[</span>i<span class="token punctuation">,</span> vert_start<span class="token punctuation">:</span>vert_end<span class="token punctuation">,</span> horiz_start<span class="token punctuation">:</span>horiz_end<span class="token punctuation">,</span> c<span class="token punctuation">]</span>
                            
                            <span class="token comment"># &#x5728;&#x5207;&#x7247;&#x4E0A;&#x8FDB;&#x884C;&#x6C60;&#x5316;&#x64CD;&#x4F5C;&#x3002;&#x3010;&#x8FD9;&#x91CC;&#x7528;mode&#x5207;&#x6362;&#x6A21;&#x5F0F;&#x3011;</span>
                            <span class="token keyword">if</span> mode <span class="token operator">==</span> <span class="token string">&quot;max&quot;</span><span class="token punctuation">:</span>
                                A<span class="token punctuation">[</span>i<span class="token punctuation">,</span> h<span class="token punctuation">,</span> w<span class="token punctuation">,</span> c<span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>a_prev_slice<span class="token punctuation">)</span>
                            <span class="token keyword">elif</span> mode <span class="token operator">==</span> <span class="token string">&quot;average&quot;</span><span class="token punctuation">:</span>
                                A<span class="token punctuation">[</span>i<span class="token punctuation">,</span> h<span class="token punctuation">,</span> w<span class="token punctuation">,</span> c<span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>a_prev_slice<span class="token punctuation">)</span>
            
            <span class="token comment">### END CODE HERE ###</span>
            
            cache <span class="token operator">=</span> <span class="token punctuation">(</span>A_prev<span class="token punctuation">,</span> hparameters<span class="token punctuation">)</span>
            
            <span class="token keyword">assert</span><span class="token punctuation">(</span>A<span class="token punctuation">.</span>shape <span class="token operator">==</span> <span class="token punctuation">(</span>m<span class="token punctuation">,</span> n_H<span class="token punctuation">,</span> n_W<span class="token punctuation">,</span> n_C<span class="token punctuation">)</span><span class="token punctuation">)</span>
            
            <span class="token keyword">return</span> A<span class="token punctuation">,</span> cache
        </pre><h4 class="mume-header" id="%E7%A4%BA%E4%BE%8B-2">&#x793A;&#x4F8B;</h4>
        
        <pre data-role="codeBlock" data-info="python" class="language-python">np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        A_prev <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
        hparameters <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;stride&quot;</span> <span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;f&quot;</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">}</span>
        
        A<span class="token punctuation">,</span> cache <span class="token operator">=</span> pool_forward<span class="token punctuation">(</span>A_prev<span class="token punctuation">,</span> hparameters<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;mode = max&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;A =&quot;</span><span class="token punctuation">,</span> A<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        A<span class="token punctuation">,</span> cache <span class="token operator">=</span> pool_forward<span class="token punctuation">(</span>A_prev<span class="token punctuation">,</span> hparameters<span class="token punctuation">,</span> mode <span class="token operator">=</span> <span class="token string">&quot;average&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;mode = average&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;A =&quot;</span><span class="token punctuation">,</span> A<span class="token punctuation">)</span>
        </pre><h4 class="mume-header" id="%E7%BB%93%E6%9E%9C-2">&#x7ED3;&#x679C;</h4>
        
        <pre data-role="codeBlock" data-info class="language-"><code>mode = max
        A = [[[[ 1.74481176  0.86540763  1.13376944]]]
             [[[ 1.13162939  1.51981682  2.18557541]]]]
        
        mode = average
        A = [[[[ 0.02105773 -0.20328806 -0.40389855]]]
             [[[-0.22154621  0.51716526  0.48155844]]]]
        </code></pre><h2 class="mume-header" id="cnn%E7%9A%84%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD-%E9%80%89%E5%81%9A">CNN&#x7684;&#x53CD;&#x5411;&#x4F20;&#x64AD; (&#x9009;&#x505A;)</h2>
        
        <p>&#x5728;&#x73B0;&#x4EE3;&#x7684;&#x6DF1;&#x5EA6;&#x5B66;&#x4E60;&#x6846;&#x67B6;&#x4E2D;&#xFF0C;&#x4F60;&#x53EA;&#x9700;&#x8981;&#x5B9E;&#x73B0;&#x524D;&#x5411;&#x4F20;&#x9012;&#xFF0C;&#x800C;&#x6846;&#x67B6;&#x4F1A;&#x5904;&#x7406;&#x540E;&#x5411;&#x4F20;&#x9012;&#xFF0C;&#x6240;&#x4EE5;&#x5927;&#x591A;&#x6570;&#x6DF1;&#x5EA6;&#x5B66;&#x4E60;&#x5DE5;&#x7A0B;&#x5E08;&#x4E0D;&#x9700;&#x8981;&#x8D39;&#x5FC3;&#x5904;&#x7406;&#x540E;&#x5411;&#x4F20;&#x9012;&#x7684;&#x7EC6;&#x8282;&#x3002;&#x5377;&#x79EF;&#x7F51;&#x7EDC;&#x7684;&#x53CD;&#x5411;&#x4F20;&#x9012;&#x662F;&#x590D;&#x6742;&#x7684;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x5982;&#x679C;&#x60A8;&#x613F;&#x610F;&#xFF0C;&#x60A8;&#x53EF;&#x4EE5;&#x67E5;&#x770B;&#x8FD9;&#x4E2A;&#x7B14;&#x8BB0;&#x7684;&#x53EF;&#x9009;&#x90E8;&#x5206;&#xFF0C;&#x4EE5;&#x4E86;&#x89E3;&#x5377;&#x79EF;&#x7F51;&#x7EDC;&#x4E2D;&#x7684;&#x53CD;&#x9988;&#x662F;&#x4EC0;&#x4E48;&#x6837;&#x5B50;&#x3002;</p>
        <p>&#x5728;&#x524D;&#x9762;&#x7684;&#x8BFE;&#x7A0B;&#x4E2D;&#xFF0C;&#x60A8;&#x5B9E;&#x73B0;&#x4E86;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;(&#x5168;&#x8FDE;&#x63A5;)&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#xFF0C;&#x60A8;&#x4F7F;&#x7528;&#x4E86;&#x53CD;&#x5411;&#x4F20;&#x64AD;&#x6765;&#x8BA1;&#x7B97;&#x4E0E;&#x66F4;&#x65B0;&#x53C2;&#x6570;&#x7684;&#x4EE3;&#x4EF7;&#x76F8;&#x5173;&#x7684;&#x5BFC;&#x6570;&#x3002;&#x7C7B;&#x4F3C;&#x5730;&#xFF0C;&#x5728;&#x5377;&#x79EF;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x4E2D;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x8BA1;&#x7B97;&#x5173;&#x4E8E;&#x4EE3;&#x4EF7;&#x7684;&#x5BFC;&#x6570;&#x6765;&#x66F4;&#x65B0;&#x53C2;&#x6570;&#x3002;&#x8FD9;&#x4E9B;&#x53CD;&#x5411;&#x4F20;&#x64AD;&#x516C;&#x5F0F;&#x5E76;&#x4E0D;&#x7B80;&#x5355;&#xFF0C;&#x6211;&#x4EEC;&#x5728;&#x8BFE;&#x5802;&#x4E0A;&#x6CA1;&#x6709;&#x63A8;&#x5BFC;&#x8FC7;&#x5B83;&#x4EEC;&#xFF0C;&#x4F46;&#x6211;&#x4EEC;&#x5728;&#x4E0B;&#x9762;&#x7B80;&#x8981;&#x4ECB;&#x7ECD;&#x4E86;&#x5B83;&#x4EEC;&#x3002;&#x3010;<strong>&#x4E0D;&#x7528;&#x5F04;&#x61C2;&#x600E;&#x4E48;&#x6C42;&#xFF0C;&#x77E5;&#x9053;&#x5373;&#x53EF;</strong>&#x3011;</p>
        <h3 class="mume-header" id="%E5%8D%B7%E7%A7%AF%E5%B1%82%E5%8F%8D%E9%A6%88">&#x5377;&#x79EF;&#x5C42;&#x53CD;&#x9988;</h3>
        
        <h4 class="mume-header" id="%E8%AE%A1%E7%AE%97da">&#x8BA1;&#x7B97;dA:</h4>
        
        <p>&#x8FD9;&#x662F;&#x8BA1;&#x7B97; <span class="mathjax-exps">$dA$</span> &#x5173;&#x4E8E;&#x5BF9;&#x4E8E;&#x7279;&#x5B9A;&#x7684;&#x8FC7;&#x6EE4;&#x5668;<span class="mathjax-exps">$W_c$</span>&#x548C;&#x4E00;&#x4E2A;&#x7ED9;&#x5B9A;&#x7684;&#x8BAD;&#x7EC3;&#x6837;&#x672C;&#x7684;&#x7684;cost&#x516C;&#x5F0F;:</p>
        <p></p><div class="mathjax-exps">$$dA += \sum _{h=0} ^{n_H} \sum_{w=0} ^{n_W} W_c \times dZ_{hw}$$</div><p></p>
        <p><span class="mathjax-exps">$W_c$</span> &#x662F;&#x4E00;&#x4E2A;&#x6EE4;&#x6CE2;&#x5668;&#x4E14; <span class="mathjax-exps">$dZ_{hw}$</span>&#x662F;&#x4E00;&#x4E2A;&#x6807;&#x91CF;&#xFF0C;&#x5BF9;&#x5E94;&#x4E8E;cost&#x76F8;&#x5BF9;&#x4E8E;conv&#x5C42;Z&#x5728;&#x7B2C;h&#x884C;&#x548C;&#x7B2C;w&#x5217;&#x7684;&#x8F93;&#x51FA;&#x7684;&#x68AF;&#x5EA6;(&#x5BF9;&#x5E94;&#x4E8E;&#x7B2C;i&#x6B65;&#x5411;&#x5DE6;&#x548C;&#x7B2C;j&#x6B65;&#x5411;&#x4E0B;&#x7684;&#x70B9;&#x79EF;)&#x3002;</p>
        <p>&#x6CE8;&#x610F;&#xFF0C;&#x5728;&#x6BCF;&#x6B21;&#x66F4;&#x65B0;dA&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x90FD;&#x5C06;&#x76F8;&#x540C;&#x7684;&#x8FC7;&#x6EE4;&#x5668;<span class="mathjax-exps">$W_c$</span>&#x4E58;&#x4EE5;&#x4E0D;&#x540C;&#x7684;dZ&#x3002;&#x6211;&#x4EEC;&#x8FD9;&#x6837;&#x505A;&#x7684;&#x4E3B;&#x8981;&#x539F;&#x56E0;&#x662F;&#xFF0C;&#x5728;&#x8BA1;&#x7B97;&#x6B63;&#x5411;&#x4F20;&#x64AD;&#x65F6;&#xFF0C;&#x6BCF;&#x4E2A;&#x8FC7;&#x6EE4;&#x5668;&#x90FD;&#x7531;&#x4E00;&#x4E2A;&#x4E0D;&#x540C;&#x7684;a_slice&#x70B9;&#x52A0;&#x548C;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x5F53;&#x8BA1;&#x7B97;dA&#x7684;&#x53CD;&#x5411;&#x4F20;&#x64AD;&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x53EA;&#x662F;&#x6DFB;&#x52A0;&#x4E86;&#x6240;&#x6709;a_slice&#x7684;&#x68AF;&#x5EA6;&#x3002;</p>
        <p>python&#x7684;&#x516C;&#x5F0F;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
        <pre data-role="codeBlock" data-info="python" class="language-python">da_prev_pad<span class="token punctuation">[</span>vert_start<span class="token punctuation">:</span>vert_end<span class="token punctuation">,</span> horiz_start<span class="token punctuation">:</span>horiz_end<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">+=</span> W<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span>c<span class="token punctuation">]</span> <span class="token operator">*</span> dZ<span class="token punctuation">[</span>i<span class="token punctuation">,</span> h<span class="token punctuation">,</span> w<span class="token punctuation">,</span> c<span class="token punctuation">]</span>
        </pre><h4 class="mume-header" id="%E8%AE%A1%E7%AE%97dw">&#x8BA1;&#x7B97;dW:</h4>
        
        <p>&#x4EE5;&#x4E0B;&#x662F;<span class="mathjax-exps">$dW_c$</span> (<span class="mathjax-exps">$dW_c$</span>&#x662F;&#x4E00;&#x4E2A;&#x8FC7;&#x6EE4;&#x5668;&#x7684;&#x5BFC;&#x6570;)&#x8BA1;&#x7B97;&#x635F;&#x5931;&#x7684;&#x516C;&#x5F0F;:</p>
        <p></p><div class="mathjax-exps">$$dW_c  += \sum _{h=0} ^{n_H} \sum_{w=0} ^ {n_W} a_{slice} \times dZ_{hw}$$</div><p></p>
        <p>&#x5176;&#x4E2D;<span class="mathjax-exps">$a_{slice}$</span>&#x5BF9;&#x5E94;&#x4E8E;&#x7528;&#x4E8E;&#x751F;&#x6210;&#x6FC0;&#x6D3B; <span class="mathjax-exps">$Z_{ij}$</span>&#x7684;&#x5207;&#x7247;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x8FD9;&#x5C31;&#x7ED9;&#x4E86;&#x6211;&#x4EEC;&#x5173;&#x4E8E;&#x90A3;&#x4E2A;&#x5207;&#x7247;<span class="mathjax-exps">$W$</span>&#x7684;&#x68AF;&#x5EA6;&#x3002;&#x56E0;&#x4E3A;&#x5B83;&#x662F;&#x76F8;&#x540C;&#x7684;<span class="mathjax-exps">$W$</span>&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x6240;&#x6709;&#x8FD9;&#x4E9B;&#x68AF;&#x5EA6;&#x76F8;&#x52A0;&#x5F97;&#x5230;<span class="mathjax-exps">$dW$</span>&#x3002;</p>
        <p>python&#x7684;&#x516C;&#x5F0F;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
        <pre data-role="codeBlock" data-info="python" class="language-python">dW<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span>c<span class="token punctuation">]</span> <span class="token operator">+=</span> a_slice <span class="token operator">*</span> dZ<span class="token punctuation">[</span>i<span class="token punctuation">,</span> h<span class="token punctuation">,</span> w<span class="token punctuation">,</span> c<span class="token punctuation">]</span>
        </pre><h4 class="mume-header" id="%E8%AE%A1%E7%AE%97db">&#x8BA1;&#x7B97;db:</h4>
        
        <p>&#x8FD9;&#x662F;&#x8BA1;&#x7B97;<span class="mathjax-exps">$db$</span>&#x76F8;&#x5BF9;&#x4E8E;&#x67D0;&#x4E2A;&#x8FC7;&#x6EE4;&#x5668;&#x7684;&#x6210;&#x672C;&#x7684;&#x516C;&#x5F0F;:</p>
        <p></p><div class="mathjax-exps">$$db = \sum_h \sum_w dZ_{hw} \tag{3}$$</div><p></p>
        <p>&#x6B63;&#x5982;&#x60A8;&#x4E4B;&#x524D;&#x5728;&#x57FA;&#x672C;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x4E2D;&#x770B;&#x5230;&#x7684;&#xFF0C;<span class="mathjax-exps">$db$</span>&#x662F;&#x7531;<span class="mathjax-exps">$dZ$</span>&#x7684;&#x603B;&#x548C;&#x8BA1;&#x7B97;&#x51FA;&#x6765;&#x7684;&#x3002;&#x5728;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x60A8;&#x53EA;&#x662F;&#x5C06;conv&#x8F93;&#x51FA;(Z)&#x76F8;&#x5BF9;&#x4E8E;cost&#x7684;&#x6240;&#x6709;&#x68AF;&#x5EA6;&#x76F8;&#x52A0;&#x3002;</p>
        <p>python&#x7684;&#x516C;&#x5F0F;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
        <pre data-role="codeBlock" data-info="python" class="language-python">db<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span>c<span class="token punctuation">]</span> <span class="token operator">+=</span> dZ<span class="token punctuation">[</span>i<span class="token punctuation">,</span> h<span class="token punctuation">,</span> w<span class="token punctuation">,</span> c<span class="token punctuation">]</span>
        </pre><pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">def</span> <span class="token function">conv_backward</span><span class="token punctuation">(</span>dZ<span class="token punctuation">,</span> cache<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token triple-quoted-string string">&quot;&quot;&quot;
            Implement the backward propagation for a convolution function
            
            Arguments:
            dZ -- gradient of the cost with respect to the output of the conv layer (Z), numpy array of shape (m, n_H, n_W, n_C)
            cache -- cache of values needed for the conv_backward(), output of conv_forward()
            
            Returns:
            dA_prev -- gradient of the cost with respect to the input of the conv layer (A_prev),
                       numpy array of shape (m, n_H_prev, n_W_prev, n_C_prev)
            dW -- gradient of the cost with respect to the weights of the conv layer (W)
                  numpy array of shape (f, f, n_C_prev, n_C)
            db -- gradient of the cost with respect to the biases of the conv layer (b)
                  numpy array of shape (1, 1, 1, n_C)
            &quot;&quot;&quot;</span>
            
            <span class="token comment">### START CODE HERE ###</span>
            
            <span class="token punctuation">(</span>A_prev<span class="token punctuation">,</span> W<span class="token punctuation">,</span> b<span class="token punctuation">,</span> hparameters<span class="token punctuation">)</span> <span class="token operator">=</span> cache
            
            
            <span class="token punctuation">(</span>m<span class="token punctuation">,</span> n_H_prev<span class="token punctuation">,</span> n_W_prev<span class="token punctuation">,</span> n_C_prev<span class="token punctuation">)</span> <span class="token operator">=</span> A_prev<span class="token punctuation">.</span>shape
            
            
            <span class="token punctuation">(</span>f<span class="token punctuation">,</span> f<span class="token punctuation">,</span> n_C_prev<span class="token punctuation">,</span> n_C<span class="token punctuation">)</span> <span class="token operator">=</span> W<span class="token punctuation">.</span>shape
            
            
            stride <span class="token operator">=</span> hparameters<span class="token punctuation">[</span><span class="token string">&apos;stride&apos;</span><span class="token punctuation">]</span>
            pad <span class="token operator">=</span> hparameters<span class="token punctuation">[</span><span class="token string">&apos;pad&apos;</span><span class="token punctuation">]</span>
            
            
            <span class="token punctuation">(</span>m<span class="token punctuation">,</span> n_H<span class="token punctuation">,</span> n_W<span class="token punctuation">,</span> n_C<span class="token punctuation">)</span> <span class="token operator">=</span> dZ<span class="token punctuation">.</span>shape
            
            
            dA_prev <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> n_H_prev<span class="token punctuation">,</span> n_W_prev<span class="token punctuation">,</span> n_C_prev<span class="token punctuation">)</span><span class="token punctuation">)</span>                           
            dW <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> f<span class="token punctuation">,</span> n_C_prev<span class="token punctuation">,</span> n_C<span class="token punctuation">)</span><span class="token punctuation">)</span>
            db <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> n_C<span class="token punctuation">)</span><span class="token punctuation">)</span>
        
            
            A_prev_pad <span class="token operator">=</span> zero_pad<span class="token punctuation">(</span>A_prev<span class="token punctuation">,</span> pad<span class="token punctuation">)</span>
            dA_prev_pad <span class="token operator">=</span> zero_pad<span class="token punctuation">(</span>dA_prev<span class="token punctuation">,</span> pad<span class="token punctuation">)</span>
            
            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>                       
                
                
                a_prev_pad <span class="token operator">=</span> A_prev_pad<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
                da_prev_pad <span class="token operator">=</span> dA_prev_pad<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
                
                <span class="token keyword">for</span> h <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n_H<span class="token punctuation">)</span><span class="token punctuation">:</span>                  
                    <span class="token keyword">for</span> w <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n_W<span class="token punctuation">)</span><span class="token punctuation">:</span>               
                        <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n_C<span class="token punctuation">)</span><span class="token punctuation">:</span>           
        
                            vert_start <span class="token operator">=</span> h <span class="token operator">*</span> stride
                            vert_end <span class="token operator">=</span> vert_start <span class="token operator">+</span> f
                            horiz_start <span class="token operator">=</span> w <span class="token operator">*</span> stride
                            horiz_end <span class="token operator">=</span> horiz_start <span class="token operator">+</span> f
                            
                            a_slice <span class="token operator">=</span> a_prev_pad<span class="token punctuation">[</span>vert_start<span class="token punctuation">:</span>vert_end<span class="token punctuation">,</span> horiz_start<span class="token punctuation">:</span>horiz_end<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>
        
                            <span class="token comment"># &#x4F7F;&#x7528;&#x4E0A;&#x9762;&#x7ED9;&#x51FA;&#x7684;&#x4EE3;&#x7801;&#x516C;&#x5F0F;&#x66F4;&#x65B0;&#x7A97;&#x53E3;&#x7684;&#x68AF;&#x5EA6;&#x548C;&#x8FC7;&#x6EE4;&#x5668;&#x7684;&#x53C2;&#x6570;</span>
                            da_prev_pad<span class="token punctuation">[</span>vert_start<span class="token punctuation">:</span>vert_end<span class="token punctuation">,</span> horiz_start<span class="token punctuation">:</span>horiz_end<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">+=</span> W<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span>c<span class="token punctuation">]</span> <span class="token operator">*</span> dZ<span class="token punctuation">[</span>i<span class="token punctuation">,</span> h<span class="token punctuation">,</span> w<span class="token punctuation">,</span> c<span class="token punctuation">]</span>
                            dW<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span>c<span class="token punctuation">]</span> <span class="token operator">+=</span> a_slice <span class="token operator">*</span> dZ<span class="token punctuation">[</span>i<span class="token punctuation">,</span> h<span class="token punctuation">,</span> w<span class="token punctuation">,</span> c<span class="token punctuation">]</span>
                            db<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span>c<span class="token punctuation">]</span> <span class="token operator">+=</span> dZ<span class="token punctuation">[</span>i<span class="token punctuation">,</span> h<span class="token punctuation">,</span> w<span class="token punctuation">,</span> c<span class="token punctuation">]</span>
                            
                <span class="token comment"># &#x8BBE;&#x7F6E;&#x7B2C;i&#x4E2A;&#x8BAD;&#x7EC3;&#x6837;&#x672C;&#x7684; dA_prev &#x4E3A;&#x672A;&#x586B;&#x5145;&#x7684; da_prev_pad</span>
                dA_prev<span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">=</span> da_prev_pad<span class="token punctuation">[</span>pad<span class="token punctuation">:</span><span class="token operator">-</span>pad<span class="token punctuation">,</span> pad<span class="token punctuation">:</span><span class="token operator">-</span>pad<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>
            <span class="token comment">### END CODE HERE ###</span>
            
            <span class="token keyword">assert</span><span class="token punctuation">(</span>dA_prev<span class="token punctuation">.</span>shape <span class="token operator">==</span> <span class="token punctuation">(</span>m<span class="token punctuation">,</span> n_H_prev<span class="token punctuation">,</span> n_W_prev<span class="token punctuation">,</span> n_C_prev<span class="token punctuation">)</span><span class="token punctuation">)</span>
            
            <span class="token keyword">return</span> dA_prev<span class="token punctuation">,</span> dW<span class="token punctuation">,</span> db
        </pre><h4 class="mume-header" id="%E7%A4%BA%E4%BE%8B-3">&#x793A;&#x4F8B;</h4>
        
        <pre data-role="codeBlock" data-info="python" class="language-python">np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        dA<span class="token punctuation">,</span> dW<span class="token punctuation">,</span> db <span class="token operator">=</span> conv_backward<span class="token punctuation">(</span>Z<span class="token punctuation">,</span> cache_conv<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;dA_mean =&quot;</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>dA<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;dW_mean =&quot;</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>dW<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;db_mean =&quot;</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">)</span>
        </pre><h4 class="mume-header" id="%E7%BB%93%E6%9E%9C-3">&#x7ED3;&#x679C;</h4>
        
        <pre data-role="codeBlock" data-info class="language-"><code>dA_mean = 1.45243777754
        dW_mean = 1.72699145831
        db_mean = 7.83923256462
        </code></pre><h2 class="mume-header" id="%E5%8F%8D%E5%90%91%E6%B1%A0%E5%8C%96">&#x53CD;&#x5411;&#x6C60;&#x5316;</h2>
        
        <p>&#x63A5;&#x4E0B;&#x6765;&#xFF0C;&#x8BA9;&#x6211;&#x4EEC;&#x5B9E;&#x73B0;&#x6C60;&#x5316;&#x5C42;&#x7684;&#x53CD;&#x5411;&#x4F20;&#x64AD;&#xFF0C;&#x4ECE;&#x6700;&#x5927;&#x6C60;&#x5C42;&#x5F00;&#x59CB;&#x3002;&#x5373;&#x4F7F;&#x6C60;&#x5316;&#x5C42;&#x6CA1;&#x6709;&#x53CD;&#x5411;&#x4F20;&#x64AD;&#x8981;&#x66F4;&#x65B0;&#x7684;&#x53C2;&#x6570;&#xFF0C;&#x60A8;&#x4ECD;&#x7136;&#x9700;&#x8981;&#x901A;&#x8FC7;&#x6C60;&#x5316;&#x5C42;&#x53CD;&#x5411;&#x4F20;&#x64AD;&#x68AF;&#x5EA6;&#xFF0C;<strong>&#x4EE5;&#x4FBF;&#x8BA1;&#x7B97;</strong>&#x5728;&#x6C60;&#x5316;&#x5C42;&#x4E4B;&#x524D;&#x51FA;&#x73B0;&#x7684;&#x5C42;&#x7684;<strong>&#x68AF;&#x5EA6;</strong>&#x3002;</p>
        <h3 class="mume-header" id="%E6%9C%80%E5%A4%A7%E6%B1%A0%E5%8C%96%E5%8F%8D%E9%A6%88">&#x6700;&#x5927;&#x6C60;&#x5316;&#xFF08;&#x53CD;&#x9988;&#xFF09;</h3>
        
        <p>&#x5728;&#x8FDB;&#x5165;&#x6C60;&#x5316;&#x5C42;&#x7684;&#x53CD;&#x5411;&#x4F20;&#x64AD;&#x4E4B;&#x524D;&#xFF0C;&#x60A8;&#x5C06;&#x6784;&#x5EFA;&#x4E00;&#x4E2A;&#x540D;&#x4E3A;&#x201C;create_mask_from_window()&#x201D;&#x7684;&#x52A9;&#x624B;&#x51FD;&#x6570;&#xFF0C;&#x5B83;&#x5C06;&#x6267;&#x884C;&#x4EE5;&#x4E0B;&#x64CD;&#x4F5C;:</p>
        <p></p><div class="mathjax-exps">$$X = \begin{bmatrix} 1 &amp;&amp; 3 \\ 4 &amp;&amp; 2 \end{bmatrix} \quad \rightarrow  \quad M =\begin{bmatrix} 0 &amp;&amp; 0 \\ 1 &amp;&amp; 0 \end{bmatrix}$$</div><p></p>
        <p>&#x6B63;&#x5982;&#x60A8;&#x6240;&#x770B;&#x5230;&#x7684;&#xFF0C;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x521B;&#x5EFA;&#x4E86;&#x4E00;&#x4E2A;&#x201C;&#x63A9;&#x7801;&#x201D;&#x77E9;&#x9635;/&quot;&#x8499;&#x7248;&quot;&#x77E9;&#x9635;&#xFF0C;&#x5B83;&#x8DDF;&#x8E2A;&#x77E9;&#x9635;&#x7684;&#x6700;&#x5927;&#x503C;&#x5728;&#x54EA;&#x91CC;&#x3002;True(1)&#x8868;&#x793A;&#x6700;&#x5927;&#x503C;&#x5728;X&#x4E2D;&#x7684;&#x4F4D;&#x7F6E;&#xFF0C;&#x5176;&#x4ED6;&#x6761;&#x76EE;&#x4E3A;False(0)&#x3002;</p>
        <pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">def</span> <span class="token function">create_mask_from_window</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token triple-quoted-string string">&quot;&quot;&quot;
            Creates a mask from an input matrix x, to identify the max entry of x.
            
            Arguments:
            x -- Array of shape (f, f)
            
            Returns:
            mask -- Array of the same shape as window, contains a True at the position corresponding to the max entry of x.
            &quot;&quot;&quot;</span>
            
            <span class="token comment">### START CODE HERE ### (&#x2248;1 line)</span>
            mask <span class="token operator">=</span> <span class="token punctuation">(</span>x <span class="token operator">==</span> np<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token comment">### END CODE HERE ###</span>
            
            <span class="token keyword">return</span> mask
        </pre><h4 class="mume-header" id="%E7%A4%BA%E4%BE%8B-4">&#x793A;&#x4F8B;</h4>
        
        <pre data-role="codeBlock" data-info="python" class="language-python">np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        x <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
        mask <span class="token operator">=</span> create_mask_from_window<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&apos;x = &apos;</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;mask = &quot;</span><span class="token punctuation">,</span> mask<span class="token punctuation">)</span>
        </pre><h4 class="mume-header" id="%E7%BB%93%E6%9E%9C-4">&#x7ED3;&#x679C;</h4>
        
        <pre data-role="codeBlock" data-info class="language-"><code>x =  [[ 1.62434536 -0.61175641 -0.52817175]
         [-1.07296862  0.86540763 -2.3015387 ]]
        mask =  [[ True False False]
         [False False False]]
        </code></pre><p>&#x4E3A;&#x4EC0;&#x4E48;&#x6211;&#x4EEC;&#x8981;&#x8DDF;&#x8E2A;&#x6700;&#x5927;&#x503C;&#x7684;&#x4F4D;&#x7F6E;?&#x8FD9;&#x662F;&#x56E0;&#x4E3A;&#x8F93;&#x5165;&#x503C;&#x6700;&#x7EC8;&#x5F71;&#x54CD;&#x4E86;&#x8F93;&#x51FA;&#xFF0C;&#x56E0;&#x6B64;&#x4E5F;&#x5F71;&#x54CD;&#x4E86;&#x6210;&#x672C;cost&#x3002;&#x53CD;&#x5411;&#x4F20;&#x64AD;&#x662F;&#x8BA1;&#x7B97;&#x76F8;&#x5BF9;&#x4E8E;cost&#x7684;&#x68AF;&#x5EA6;&#xFF0C;&#x6240;&#x4EE5;&#x4EFB;&#x4F55;&#x5F71;&#x54CD;&#x6700;&#x7EC8;cost&#x7684;&#x4E1C;&#x897F;&#x90FD;&#x5E94;&#x8BE5;&#x6709;&#x4E00;&#x4E2A;&#x975E;&#x96F6;&#x7684;&#x68AF;&#x5EA6;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x53CD;&#x5411;&#x4F20;&#x64AD;&#x4F1A;&#x5C06;&#x68AF;&#x5EA6;&#x201C;&#x4F20;&#x64AD;&#x201D;&#x56DE;&#x8FD9;&#x4E2A;&#x5F71;&#x54CD;&#x6210;&#x672C;&#x7684;&#x7279;&#x5B9A;&#x8F93;&#x5165;&#x503C;&#x3002;</p>
        <h3 class="mume-header" id="%E5%B9%B3%E5%9D%87%E6%B1%A0%E5%8C%96%E5%8F%8D%E9%A6%88">&#x5E73;&#x5747;&#x6C60;&#x5316;&#xFF08;&#x53CD;&#x9988;&#xFF09;</h3>
        
        <p>&#x5728;&#x6700;&#x5927;&#x6C60;&#x5316;&#x4E2D;&#xFF0C;&#x5BF9;&#x4E8E;&#x6BCF;&#x4E2A;&#x8F93;&#x5165;&#x7A97;&#x53E3;&#xFF0C;&#x5BF9;&#x8F93;&#x51FA;&#x7684;&#x6240;&#x6709;&#x201C;&#x5F71;&#x54CD;&#x201D;&#x90FD;&#x6765;&#x81EA;&#x4E00;&#x4E2A;&#x8F93;&#x5165;&#x503C;&#x2014;&#x2014;max&#x3002;&#x5728;&#x5E73;&#x5747;&#x6C60;&#x4E2D;&#xFF0C;&#x8F93;&#x5165;&#x7A97;&#x53E3;&#x7684;&#x6BCF;&#x4E2A;&#x5143;&#x7D20;&#x5BF9;&#x8F93;&#x51FA;&#x7684;&#x5F71;&#x54CD;&#x662F;&#x76F8;&#x7B49;&#x7684;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x8981;&#x5B9E;&#x73B0;&#x53CD;&#x5411;&#x4F20;&#x64AD;&#xFF0C;&#x73B0;&#x5728;&#x9700;&#x8981;&#x5B9E;&#x73B0;&#x4E00;&#x4E2A;&#x8F85;&#x52A9;&#x51FD;&#x6570;&#x6765;&#x53CD;&#x6620;&#x8FD9;&#x4E00;&#x70B9;&#x3002;</p>
        <p>&#x4F8B;&#x5982;&#xFF0C;&#x5982;&#x679C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;2x2&#x7684;&#x8FC7;&#x6EE4;&#x5668;&#x5728;&#x524D;&#x5411;&#x4F20;&#x9012;&#x4E2D;&#x8FDB;&#x884C;&#x5E73;&#x5747;&#x6C60;&#x5316;&#xFF0C;&#x90A3;&#x4E48;&#x4F60;&#x5C06;&#x7528;&#x4E8E;&#x540E;&#x5411;&#x4F20;&#x9012;&#x7684;&#x63A9;&#x7801;/&#x8499;&#x7248;&#x662F;&#x8FD9;&#x6837;&#x7684;:<br>
        </p><div class="mathjax-exps">$$dZ = 1 \quad \rightarrow  \quad dZ =\begin{bmatrix} 1/4 &amp;&amp; 1/4 \\ 1/4 &amp;&amp; 1/4 \end{bmatrix}$$</div><p></p>
        <p>&#x8FD9;&#x610F;&#x5473;&#x7740;<span class="mathjax-exps">$dZ$</span>&#x77E9;&#x9635;&#x4E2D;&#x7684;&#x6BCF;&#x4E2A;&#x4F4D;&#x7F6E;&#x5BF9;&#x8F93;&#x51FA;&#x7684;&#x8D21;&#x732E;&#x662F;&#x76F8;&#x7B49;&#x7684;&#xFF0C;&#x56E0;&#x4E3A;&#x5728;&#x524D;&#x5411;&#x4F20;&#x9012;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x53D6;&#x4E86;&#x5E73;&#x5747;&#x503C;&#x3002;</p>
        <pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">def</span> <span class="token function">distribute_value</span><span class="token punctuation">(</span>dz<span class="token punctuation">,</span> shape<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token triple-quoted-string string">&quot;&quot;&quot;
            Distributes the input value in the matrix of dimension shape
            
            Arguments:
            dz -- input scalar
            shape -- the shape (n_H, n_W) of the output matrix for which we want to distribute the value of dz
            
            Returns:
            a -- Array of size (n_H, n_W) for which we distributed the value of dz
            &quot;&quot;&quot;</span>
            
            <span class="token comment">### START CODE HERE ###</span>
            <span class="token comment"># &#x83B7;&#x53D6;shape&#x7EF4;&#x5EA6; (&#x2248;1 line)</span>
            <span class="token punctuation">(</span>n_H<span class="token punctuation">,</span> n_W<span class="token punctuation">)</span> <span class="token operator">=</span> shape
            
            <span class="token comment"># &#x8BA1;&#x7B97;&#x77E9;&#x9635;&#x7684;&#x503C;&#x5206;&#x5E03;&#x3010;&#x5747;&#x5300;&#x5206;&#x5E03;&#x3011; (&#x2248;1 line)</span>
            average <span class="token operator">=</span> dz <span class="token operator">/</span> <span class="token punctuation">(</span>n_H <span class="token operator">*</span> n_W<span class="token punctuation">)</span>
            
            <span class="token comment"># &#x586B;&#x6EE1;&#x5E73;&#x5747;&#x503C; (&#x2248;1 line)</span>
            a <span class="token operator">=</span> np<span class="token punctuation">.</span>full<span class="token punctuation">(</span>shape<span class="token punctuation">,</span> average<span class="token punctuation">)</span>
            <span class="token comment">### END CODE HERE ###</span>
            
            <span class="token keyword">return</span> a
        </pre><h4 class="mume-header" id="%E7%A4%BA%E4%BE%8B-5">&#x793A;&#x4F8B;</h4>
        
        <pre data-role="codeBlock" data-info="python" class="language-python">a <span class="token operator">=</span> distribute_value<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&apos;distributed value =&apos;</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span>
        </pre><h4 class="mume-header" id="%E7%BB%93%E6%9E%9C-5">&#x7ED3;&#x679C;</h4>
        
        <pre data-role="codeBlock" data-info class="language-"><code>distributed value = [[ 0.5  0.5]
                             [ 0.5  0.5]]
        </code></pre><h3 class="mume-header" id="%E7%BB%84%E8%A3%85%E5%8F%8D%E5%90%91%E6%B1%A0%E5%8C%96">&#x7EC4;&#x88C5;&#xFF1A;&#x53CD;&#x5411;&#x6C60;&#x5316;</h3>
        
        <pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">def</span> <span class="token function">pool_backward</span><span class="token punctuation">(</span>dA<span class="token punctuation">,</span> cache<span class="token punctuation">,</span> mode <span class="token operator">=</span> <span class="token string">&quot;max&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token triple-quoted-string string">&quot;&quot;&quot;
            Implements the backward pass of the pooling layer
            
            Arguments:
            dA -- gradient of cost with respect to the output of the pooling layer, same shape as A
            cache -- cache output from the forward pass of the pooling layer, contains the layer&apos;s input and hparameters 
            mode -- the pooling mode you would like to use, defined as a string (&quot;max&quot; or &quot;average&quot;)
            
            Returns:
            dA_prev -- gradient of cost with respect to the input of the pooling layer, same shape as A_prev
            &quot;&quot;&quot;</span>
            
            <span class="token comment">### START CODE HERE ###</span>
            
            <span class="token comment"># &#x83B7;&#x5F97;cache&#x7684;&#x4FE1;&#x606F; (&#x2248;1 line)</span>
            <span class="token punctuation">(</span>A_prev<span class="token punctuation">,</span> hparameters<span class="token punctuation">)</span> <span class="token operator">=</span> cache
            
            stride <span class="token operator">=</span> hparameters<span class="token punctuation">[</span><span class="token string">&apos;stride&apos;</span><span class="token punctuation">]</span>
            f <span class="token operator">=</span> hparameters<span class="token punctuation">[</span><span class="token string">&apos;f&apos;</span><span class="token punctuation">]</span>
            
            <span class="token comment"># &#x83B7;&#x5F97;A_prev&#x7684;shape&#x548C;dA&#x7684;shape&#x7684;&#x7EF4;&#x5EA6; (&#x2248;2 lines)</span>
            m<span class="token punctuation">,</span> n_H_prev<span class="token punctuation">,</span> n_W_prev<span class="token punctuation">,</span> n_C_prev <span class="token operator">=</span> A_prev<span class="token punctuation">.</span>shape
            m<span class="token punctuation">,</span> n_H<span class="token punctuation">,</span> n_W<span class="token punctuation">,</span> n_C <span class="token operator">=</span> dA<span class="token punctuation">.</span>shape
            
            <span class="token comment"># &#x96F6;&#x521D;&#x59CB;&#x5316;dA_prev(&#x2248;1 line)</span>
            dA_prev <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> n_H_prev<span class="token punctuation">,</span> n_W_prev<span class="token punctuation">,</span> n_C_prev<span class="token punctuation">)</span><span class="token punctuation">)</span>
            
            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>                       
        
                a_prev <span class="token operator">=</span> A_prev<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
                
                <span class="token keyword">for</span> h <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n_H<span class="token punctuation">)</span><span class="token punctuation">:</span>                   
                    <span class="token keyword">for</span> w <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n_W<span class="token punctuation">)</span><span class="token punctuation">:</span>               
                        <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n_C<span class="token punctuation">)</span><span class="token punctuation">:</span>           
                            
                            vert_start <span class="token operator">=</span> h <span class="token operator">*</span> stride
                            vert_end <span class="token operator">=</span> vert_start <span class="token operator">+</span> f
                            horiz_start <span class="token operator">=</span> w <span class="token operator">*</span> stride
                            horiz_end <span class="token operator">=</span> horiz_start <span class="token operator">+</span> f
                            
                            <span class="token comment"># &#x8BA1;&#x7B97;&#x4E24;&#x79CD;&#x53CD;&#x5411;&#x4F20;&#x64AD;.</span>
                            <span class="token keyword">if</span> mode <span class="token operator">==</span> <span class="token string">&quot;max&quot;</span><span class="token punctuation">:</span>
                                
                                <span class="token comment"># &#x4F7F;&#x7528;&#x89D2;&#x70B9;&#x548C; &quot;c&quot; &#x4ECE;a_prev &#x6765;&#x5B9A;&#x4E49;&#x73B0;&#x5728;&#x7684;&#x5207;&#x7247;  (&#x2248;1 line)</span>
                                a_prev_slice <span class="token operator">=</span> a_prev<span class="token punctuation">[</span>vert_start<span class="token punctuation">:</span>vert_end<span class="token punctuation">,</span> horiz_start<span class="token punctuation">:</span>horiz_end<span class="token punctuation">,</span> c<span class="token punctuation">]</span>
                                <span class="token comment"># &#x4ECE;a_prev_slice&#x521B;&#x5EFA;&#x63A9;&#x7801;/&#x8499;&#x7248; (&#x2248;1 line)</span>
                                mask <span class="token operator">=</span> create_mask_from_window<span class="token punctuation">(</span>a_prev_slice<span class="token punctuation">)</span>
                                <span class="token comment"># dA_prev = dA_prev + (mask * dA) (&#x2248;1 line)</span>
                                dA_prev<span class="token punctuation">[</span>i<span class="token punctuation">,</span> vert_start<span class="token punctuation">:</span> vert_end<span class="token punctuation">,</span> horiz_start<span class="token punctuation">:</span> horiz_end<span class="token punctuation">,</span> c<span class="token punctuation">]</span> <span class="token operator">+=</span> np<span class="token punctuation">.</span>multiply<span class="token punctuation">(</span>mask<span class="token punctuation">,</span> dA<span class="token punctuation">[</span>i<span class="token punctuation">,</span>h<span class="token punctuation">,</span>w<span class="token punctuation">,</span>c<span class="token punctuation">]</span><span class="token punctuation">)</span>
                                
                            <span class="token keyword">elif</span> mode <span class="token operator">==</span> <span class="token string">&quot;average&quot;</span><span class="token punctuation">:</span>
                                
                                <span class="token comment"># &#x83B7;&#x5F97; dA &#x7684;&#x503C;(&#x2248;1 line)</span>
                                da <span class="token operator">=</span> dA<span class="token punctuation">[</span>i<span class="token punctuation">,</span>h<span class="token punctuation">,</span>w<span class="token punctuation">,</span>c<span class="token punctuation">]</span>
                                <span class="token comment"># &#x5C06;&#x6EE4;&#x6CE2;&#x5668;&#x5B9A;&#x4E49;&#x4E3A; fxf &#x5927;&#x5C0F; (&#x2248;1 line)</span>
                                shape <span class="token operator">=</span> <span class="token punctuation">(</span>f<span class="token punctuation">,</span>f<span class="token punctuation">)</span>
                                <span class="token comment"># &#x5206;&#x6563;&#x5B83;&#x4EE5;&#x83B7;&#x5F97;&#x6B63;&#x786E;&#x7684; dA_prev &#x5207;&#x7247;&#x3010;&#x5373;&#x5C06;da&#x7684;&#x5206;&#x5E03;&#x503C;&#x76F8;&#x52A0;&#x3011; (&#x2248;1 line)</span>
                                dA_prev<span class="token punctuation">[</span>i<span class="token punctuation">,</span> vert_start<span class="token punctuation">:</span> vert_end<span class="token punctuation">,</span> horiz_start<span class="token punctuation">:</span> horiz_end<span class="token punctuation">,</span> c<span class="token punctuation">]</span> <span class="token operator">+=</span> distribute_value<span class="token punctuation">(</span>da<span class="token punctuation">,</span> shape<span class="token punctuation">)</span>
                                
            <span class="token comment">### END CODE ###</span>
            
            <span class="token comment"># &#x786E;&#x4FDD;&#x8F93;&#x51FA;shape&#x7B26;&#x5408;&#x8981;&#x6C42;</span>
            <span class="token keyword">assert</span><span class="token punctuation">(</span>dA_prev<span class="token punctuation">.</span>shape <span class="token operator">==</span> A_prev<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
            
            <span class="token keyword">return</span> dA_prev
        </pre><h4 class="mume-header" id="%E7%A4%BA%E4%BE%8B-6">&#x793A;&#x4F8B;</h4>
        
        <pre data-role="codeBlock" data-info="python" class="language-python">np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        A_prev <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
        hparameters <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;stride&quot;</span> <span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;f&quot;</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">}</span>
        A<span class="token punctuation">,</span> cache <span class="token operator">=</span> pool_forward<span class="token punctuation">(</span>A_prev<span class="token punctuation">,</span> hparameters<span class="token punctuation">)</span>
        dA <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
        
        dA_prev <span class="token operator">=</span> pool_backward<span class="token punctuation">(</span>dA<span class="token punctuation">,</span> cache<span class="token punctuation">,</span> mode <span class="token operator">=</span> <span class="token string">&quot;max&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;mode = max&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&apos;mean of dA = &apos;</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>dA<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&apos;dA_prev[1,1] = &apos;</span><span class="token punctuation">,</span> dA_prev<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        dA_prev <span class="token operator">=</span> pool_backward<span class="token punctuation">(</span>dA<span class="token punctuation">,</span> cache<span class="token punctuation">,</span> mode <span class="token operator">=</span> <span class="token string">&quot;average&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;mode = average&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&apos;mean of dA = &apos;</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>dA<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&apos;dA_prev[1,1] = &apos;</span><span class="token punctuation">,</span> dA_prev<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> 
        </pre><h4 class="mume-header" id="%E7%BB%93%E6%9E%9C-6">&#x7ED3;&#x679C;</h4>
        
        <pre data-role="codeBlock" data-info class="language-"><code>mode = max
        mean of dA =  0.145713902729
        dA_prev[1,1] =[  [ 0.          0.        ]
                  [ 5.05844394 -1.68282702]
                  [ 0.          0.        ]]
        
        mode = average
        mean of dA =  0.145713902729
        dA_prev[1,1] =  [[ 0.08485462  0.2787552 ]
                         [ 1.26461098 -0.25749373]
                         [ 1.17975636 -0.53624893]]
        </code></pre><h1 class="mume-header" id="cnn%E7%9A%84%E5%BA%94%E7%94%A8">CNN&#x7684;&#x5E94;&#x7528;</h1>
        
        <h2 class="mume-header" id="tensorflow-%E6%A8%A1%E5%BC%8F">TensorFlow &#x6A21;&#x5F0F;</h2>
        
        <p>&#x5728;&#x4E0A;&#x4E00;&#x4E2A;&#x4EFB;&#x52A1;&#x4E2D;&#xFF0C;&#x60A8;&#x4F7F;&#x7528;numpy&#x6784;&#x5EFA;&#x4E86;&#x5E2E;&#x52A9;&#x51FD;&#x6570;&#xFF0C;&#x4EE5;&#x7406;&#x89E3;&#x5377;&#x79EF;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;&#x80CC;&#x540E;&#x7684;&#x673A;&#x5236;&#x3002;&#x76EE;&#x524D;&#xFF0C;&#x6DF1;&#x5EA6;&#x5B66;&#x4E60;&#x7684;&#x5927;&#x591A;&#x6570;&#x5B9E;&#x9645;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x90FD;&#x662F;&#x4F7F;&#x7528;&#x7F16;&#x7A0B;&#x6846;&#x67B6;&#x6784;&#x5EFA;&#x7684;&#xFF0C;&#x8FD9;&#x4E9B;&#x6846;&#x67B6;&#x5177;&#x6709;&#x8BB8;&#x591A;&#x53EF;&#x4EE5;&#x7B80;&#x5355;&#x8C03;&#x7528;&#x7684;&#x5185;&#x7F6E;&#x51FD;&#x6570;&#x3002;</p>
        <h3 class="mume-header" id="%E5%AF%BC%E5%8C%85-1">&#x5BFC;&#x5305;</h3>
        
        <pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">import</span> math
        <span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
        <span class="token keyword">import</span> h5py
        <span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
        <span class="token keyword">import</span> scipy
        
        <span class="token keyword">from</span> scipy <span class="token keyword">import</span> ndimage
        
        <span class="token keyword">import</span> tensorflow <span class="token keyword">as</span> tf
        <span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>framework <span class="token keyword">import</span> ops
        <span class="token keyword">from</span> cnn_utils <span class="token keyword">import</span> <span class="token operator">*</span>
        
        <span class="token operator">%</span>matplotlib inline
        np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        </pre><h3 class="mume-header" id="%E5%8A%A0%E8%BD%BD%E6%95%B0%E6%8D%AE%E9%9B%86">&#x52A0;&#x8F7D;&#x6570;&#x636E;&#x96C6;</h3>
        
        <pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># &#x52A0;&#x8F7D;&#x6570;&#x636E; (signs)</span>
        X_train_orig<span class="token punctuation">,</span> Y_train_orig<span class="token punctuation">,</span> X_test_orig<span class="token punctuation">,</span> Y_test_orig<span class="token punctuation">,</span> classes <span class="token operator">=</span> load_dataset<span class="token punctuation">(</span><span class="token punctuation">)</span>
        </pre><p>&#x63D0;&#x9192;&#x4E00;&#x4E0B;&#xFF0C;SIGN&#x6570;&#x636E;&#x96C6;&#x662F;6&#x4E2A;&#x7B26;&#x53F7;&#x7684;&#x96C6;&#x5408;&#xFF0C;&#x5B83;&#x4EEC;&#x4EE3;&#x8868;&#x4ECE;0&#x5230;5&#x7684;&#x6570;&#x5B57;&#x3002;</p>
        <h3 class="mume-header" id="%E6%9F%A5%E7%9C%8B%E6%95%B0%E6%8D%AE%E9%9B%86">&#x67E5;&#x770B;&#x6570;&#x636E;&#x96C6;</h3>
        
        <pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># &#x793A;&#x4F8B;&#x56FE;&#x7247;</span>
        index <span class="token operator">=</span> <span class="token number">15</span>
        plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>X_train_orig<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;y = &quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>squeeze<span class="token punctuation">(</span>Y_train_orig<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> index<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        y <span class="token operator">=</span> <span class="token number">5</span>
        </pre><p><img src="img/1.jpg" alt></p>
        <h4 class="mume-header" id="%E7%A0%94%E7%A9%B6shape">&#x7814;&#x7A76;shape</h4>
        
        <p>&#x9996;&#x5148;&#xFF0C;&#x8BA9;&#x6211;&#x4EEC;&#x7814;&#x7A76;&#x4E00;&#x4E0B;&#x6570;&#x636E;&#x7684;&#x5F62;&#x72B6;&#x3002;</p>
        <pre data-role="codeBlock" data-info="python" class="language-python">X_train <span class="token operator">=</span> X_train_orig<span class="token operator">/</span><span class="token number">255</span><span class="token punctuation">.</span>
        X_test <span class="token operator">=</span> X_test_orig<span class="token operator">/</span><span class="token number">255</span><span class="token punctuation">.</span>
        Y_train <span class="token operator">=</span> convert_to_one_hot<span class="token punctuation">(</span>Y_train_orig<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">.</span>T
        Y_test <span class="token operator">=</span> convert_to_one_hot<span class="token punctuation">(</span>Y_test_orig<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">.</span>T
        <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;number of training examples = &quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>X_train<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;number of test examples = &quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>X_test<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;X_train shape: &quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>X_train<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;Y_train shape: &quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>Y_train<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;X_test shape: &quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>X_test<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;Y_test shape: &quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>Y_test<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span class="token punctuation">)</span>
        conv_layers <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
        </pre><h4 class="mume-header" id="%E7%BB%93%E6%9E%9C-7">&#x7ED3;&#x679C;</h4>
        
        <pre data-role="codeBlock" data-info class="language-"><code>number of training examples = 1080
        number of test examples = 120
        X_train shape: (1080, 64, 64, 3)
        Y_train shape: (1080, 6)
        X_test shape: (120, 64, 64, 3)
        Y_test shape: (120, 6)
        </code></pre><h3 class="mume-header" id="%E5%88%9B%E5%BB%BA%E5%8D%A0%E4%BD%8D%E7%AC%A6">&#x521B;&#x5EFA;&#x5360;&#x4F4D;&#x7B26;</h3>
        
        <p>TensorFlow&#x8981;&#x6C42;&#x60A8;&#x4E3A;&#x8FD0;&#x884C;&#x4F1A;&#x8BDD;&#x65F6;&#x5C06;&#x88AB;&#x8F93;&#x5165;&#x5230;&#x6A21;&#x578B;&#x4E2D;&#x7684;&#x8F93;&#x5165;&#x6570;&#x636E;&#x521B;&#x5EFA;&#x5360;&#x4F4D;&#x7B26;&#x3002;</p>
        <pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># GRADED FUNCTION: create_placeholders</span>
        
        <span class="token keyword">def</span> <span class="token function">create_placeholders</span><span class="token punctuation">(</span>n_H0<span class="token punctuation">,</span> n_W0<span class="token punctuation">,</span> n_C0<span class="token punctuation">,</span> n_y<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token triple-quoted-string string">&quot;&quot;&quot;
            Creates the placeholders for the tensorflow session.
            
            Arguments:
            n_H0 -- scalar, height of an input image
            n_W0 -- scalar, width of an input image
            n_C0 -- scalar, number of channels of the input
            n_y -- scalar, number of classes
                
            Returns:
            X -- placeholder for the data input, of shape [None, n_H0, n_W0, n_C0] and dtype &quot;float&quot;
            Y -- placeholder for the input labels, of shape [None, n_y] and dtype &quot;float&quot;
            &quot;&quot;&quot;</span>
        
            <span class="token comment">### START CODE HERE ### (&#x2248;2 lines)</span>
            X <span class="token operator">=</span> tf<span class="token punctuation">.</span>placeholder<span class="token punctuation">(</span><span class="token string">&apos;float&apos;</span><span class="token punctuation">,</span> shape<span class="token operator">=</span><span class="token punctuation">[</span><span class="token boolean">None</span><span class="token punctuation">,</span> n_H0<span class="token punctuation">,</span> n_W0<span class="token punctuation">,</span> n_C0<span class="token punctuation">]</span><span class="token punctuation">)</span>
            Y <span class="token operator">=</span> tf<span class="token punctuation">.</span>placeholder<span class="token punctuation">(</span><span class="token string">&apos;float&apos;</span><span class="token punctuation">,</span> shape<span class="token operator">=</span><span class="token punctuation">[</span><span class="token boolean">None</span><span class="token punctuation">,</span> n_y<span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token comment">### END CODE HERE ###</span>
            
            <span class="token keyword">return</span> X<span class="token punctuation">,</span> Y
        </pre><h4 class="mume-header" id="%E6%B5%8B%E8%AF%95">&#x6D4B;&#x8BD5;</h4>
        
        <pre data-role="codeBlock" data-info="python" class="language-python">X<span class="token punctuation">,</span> Y <span class="token operator">=</span> create_placeholders<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;X = &quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;Y = &quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>Y<span class="token punctuation">)</span><span class="token punctuation">)</span>
        </pre><h4 class="mume-header" id="%E7%BB%93%E6%9E%9C-8">&#x7ED3;&#x679C;</h4>
        
        <pre data-role="codeBlock" data-info class="language-"><code>X = Tensor(&quot;Placeholder:0&quot;, shape=(?, 64, 64, 3), dtype=float32)
        Y = Tensor(&quot;Placeholder_1:0&quot;, shape=(?, 6), dtype=float32)
        </code></pre><h3 class="mume-header" id="%E5%88%9D%E5%A7%8B%E5%8C%96%E5%8F%82%E6%95%B0">&#x521D;&#x59CB;&#x5316;&#x53C2;&#x6570;</h3>
        
        <p>&#x4F60;&#x5C06;&#x521D;&#x59CB;&#x5316;&#x6743;&#x91CD;/&#x8FC7;&#x6EE4;&#x5668;<span class="mathjax-exps">$W_1$</span>&#x548C;<span class="mathjax-exps">$W_2$</span>&#x4F7F;&#x7528;<code>tf.contrib.layers.xavier_initializer(seed = 0)</code>&#x3002;&#x4F60;&#x4E0D;&#x9700;&#x8981;&#x62C5;&#x5FC3;&#x504F;&#x5DEE;&#x53D8;&#x91CF;b&#xFF0C;&#x56E0;&#x4E3A;&#x4F60;&#x5F88;&#x5FEB;&#x5C31;&#x4F1A;&#x770B;&#x5230;TensorFlow&#x51FD;&#x6570;&#x4F1A;&#x5904;&#x7406;&#x504F;&#x5DEE;&#x3002;&#x8FD8;&#x8981;&#x6CE8;&#x610F;&#xFF0C;&#x60A8;&#x5C06;&#x53EA;&#x5BF9;conv2d&#x51FD;&#x6570;&#x521D;&#x59CB;&#x5316;&#x6743;&#x91CD;/&#x8FC7;&#x6EE4;&#x5668;&#x3002;TensorFlow&#x4E3A;&#x5B8C;&#x5168;&#x8FDE;&#x63A5;&#x7684;&#x90E8;&#x5206;&#x81EA;&#x52A8;&#x521D;&#x59CB;&#x5316;&#x5C42;&#x3002;</p>
        <pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># GRADED FUNCTION: initialize_parameters</span>
        
        <span class="token keyword">def</span> <span class="token function">initialize_parameters</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token triple-quoted-string string">&quot;&quot;&quot;
            Initializes weight parameters to build a neural network with tensorflow. The shapes are:
                                W1 : [4, 4, 3, 8]
                                W2 : [2, 2, 8, 16]
            Returns:
            parameters -- a dictionary of tensors containing W1, W2
            &quot;&quot;&quot;</span>
            
            tf<span class="token punctuation">.</span>set_random_seed<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>                              <span class="token comment"># &#x8BBE;&#x7F6E;&#x968F;&#x673A;&#x5316;&#x79CD;&#x5B50;</span>
                
            <span class="token comment">### START CODE HERE ### (approx. 2 lines of code)</span>
            W1 <span class="token operator">=</span> tf<span class="token punctuation">.</span>get_variable<span class="token punctuation">(</span><span class="token string">&quot;W1&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> initializer <span class="token operator">=</span> tf<span class="token punctuation">.</span>contrib<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>xavier_initializer<span class="token punctuation">(</span>seed <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            W2 <span class="token operator">=</span> tf<span class="token punctuation">.</span>get_variable<span class="token punctuation">(</span><span class="token string">&quot;W2&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">,</span> initializer <span class="token operator">=</span> tf<span class="token punctuation">.</span>contrib<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>xavier_initializer<span class="token punctuation">(</span>seed <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token comment">### END CODE HERE ###</span>
        
            parameters <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;W1&quot;</span><span class="token punctuation">:</span> W1<span class="token punctuation">,</span>
                          <span class="token string">&quot;W2&quot;</span><span class="token punctuation">:</span> W2<span class="token punctuation">}</span>
            
            <span class="token keyword">return</span> parameters
        </pre><h4 class="mume-header" id="%E6%B5%8B%E8%AF%95-1">&#x6D4B;&#x8BD5;</h4>
        
        <pre data-role="codeBlock" data-info="python" class="language-python">tf<span class="token punctuation">.</span>reset_default_graph<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">with</span> tf<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> sess_test<span class="token punctuation">:</span>
            parameters <span class="token operator">=</span> initialize_parameters<span class="token punctuation">(</span><span class="token punctuation">)</span>
            init <span class="token operator">=</span> tf<span class="token punctuation">.</span>global_variables_initializer<span class="token punctuation">(</span><span class="token punctuation">)</span>
            sess_test<span class="token punctuation">.</span>run<span class="token punctuation">(</span>init<span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;W1 = &quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>parameters<span class="token punctuation">[</span><span class="token string">&quot;W1&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;W2 = &quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>parameters<span class="token punctuation">[</span><span class="token string">&quot;W2&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        </pre><h4 class="mume-header" id="%E7%BB%93%E6%9E%9C-9">&#x7ED3;&#x679C;</h4>
        
        <pre data-role="codeBlock" data-info class="language-"><code>W1 = [ 0.00131723  0.14176141 -0.04434952  0.09197326  0.14984085 -0.03514394
         -0.06847463  0.05245192]
        W2 = [-0.08566415  0.17750949  0.11974221  0.16773748 -0.0830943  -0.08058
         -0.00577033 -0.14643836  0.24162132 -0.05857408 -0.19055021  0.1345228
         -0.22779644 -0.1601823  -0.16117483 -0.10286498]
        </code></pre><h3 class="mume-header" id="%E6%AD%A3%E5%90%91%E4%BC%A0%E6%92%AD">&#x6B63;&#x5411;&#x4F20;&#x64AD;</h3>
        
        <p>&#x5728;TensorFlow&#x4E2D;&#xFF0C;&#x6709;&#x4E00;&#x4E9B;&#x5185;&#x7F6E;&#x51FD;&#x6570;&#x53EF;&#x4EE5;&#x5E2E;&#x4F60;&#x5B8C;&#x6210;&#x5377;&#x79EF;&#x6B65;&#x9AA4;&#x3002;</p>
        <ul>
        <li>
        <p><strong>tf.nn.conv2d(X,W1, strides = [1,s,s,1], padding = &apos;SAME&apos;):</strong></p>
        <p>&#x7ED9;&#x5B9A;&#x4E00;&#x4E2A;&#x8F93;&#x5165; <span class="mathjax-exps">$X$</span> &#x548C;&#x4E00;&#x7EC4;filter <span class="mathjax-exps">$W1$</span>&#xFF0C;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x5BF9; <span class="mathjax-exps">$W1$</span>&#x7684;filter&#x5728; X&#x4E0A;&#x8FDB;&#x884C;&#x5377;&#x79EF;. &#x7B2C;&#x4E09;&#x4E2A;&#x8F93;&#x5165;([1,f,f,1])&#x8868;&#x793A;&#x8F93;&#x5165;(m, n_H_prev, n_W_prev, n_C_prev)&#x7684;&#x6BCF;&#x4E2A;&#x7EF4;&#x5EA6;&#x7684;&#x6B65;&#x957F;&#x3002;&#x9605;&#x8BFB;&#x5B8C;&#x6574;&#x6587;&#x6863;<a href="https://www.tensorflow.org/api_docs/python/tf/nn/conv2d">&#x6B64;&#x5904;</a></p>
        </li>
        <li>
        <p><strong>tf.nn.max_pool(A, ksize = [1,f,f,1], strides = [1,s,s,1], padding = &apos;SAME&apos;):</strong></p>
        <p>&#x7ED9;&#x5B9A;&#x8F93;&#x5165;A&#xFF0C;&#x8BE5;&#x51FD;&#x6570;&#x4F7F;&#x7528;&#x5927;&#x5C0F;&#x4E3A;(f, f)&#x7684;&#x7A97;&#x53E3;&#x548C;&#x5927;&#x5C0F;&#x7684;&#x6B65;&#x957F;(s, s)&#x5BF9;&#x6BCF;&#x4E2A;&#x7A97;&#x53E3;&#x6267;&#x884C;&#x6700;&#x5927;&#x6C60;&#x5316;&#x3002;&#x9605;&#x8BFB;&#x5B8C;&#x6574;&#x6587;&#x6863;<a href="https://www.tensorflow.org/api_docs/python/tf/nn/max_pool">&#x6B64;&#x5904;</a></p>
        </li>
        <li>
        <p><strong>tf.nn.relu(Z1):</strong></p>
        <p>&#x8BA1;&#x7B97;ReLU(Z1) (which can be any shape). &#x9605;&#x8BFB;&#x5B8C;&#x6574;&#x6587;&#x6863; <a href="https://www.tensorflow.org/api_docs/python/tf/nn/relu">&#x6B64;&#x5904;</a></p>
        </li>
        <li>
        <p><strong>tf.contrib.layers.flatten(P)</strong>:</p>
        <p>&#x7ED9;&#x5B9A;&#x4E00;&#x4E2A;&#x8F93;&#x5165;P&#xFF0C;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x5C06;&#x6BCF;&#x4E2A;&#x793A;&#x4F8B;&#x6241;&#x5E73;&#x5316;&#x6210;&#x4E00;&#x7EF4;&#x5411;&#x91CF;&#xFF0C;&#x540C;&#x65F6;&#x4FDD;&#x6301;&#x6279;&#x5904;&#x7406;&#x5927;&#x5C0F;&#x3002;&#x5B83;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x5F62;&#x72B6;&#x4E3A;[batch_size, k]&#x7684;&#x6241;&#x5E73;&#x5F20;&#x91CF;&#x3002; &#x9605;&#x8BFB;&#x5B8C;&#x6574;&#x6587;&#x6863; <a href="https://www.tensorflow.org/api_docs/python/tf/contrib/layers/flatten">&#x6B64;&#x5904;</a></p>
        </li>
        <li>
        <p><strong>tf.contrib.layers.fully_connected(F, num_outputs):</strong></p>
        <p>&#x7ED9;&#x5B9A;a&#x4E00;&#x4E2A;&#x6241;&#x5E73;&#x5316;&#x8F93;&#x5165;F&#xFF0C;&#x5B83;&#x8FD4;&#x56DE;&#x4F7F;&#x7528;&#x5B8C;&#x5168;&#x8FDE;&#x63A5;&#x5C42;&#x8BA1;&#x7B97;&#x7684;&#x8F93;&#x51FA;&#x3002; &#x9605;&#x8BFB;&#x5B8C;&#x6574;&#x6587;&#x6863; <a href="https://www.tensorflow.org/api_docs/python/tf/contrib/layers/fully_connected">&#x6B64;&#x5904;</a></p>
        </li>
        </ul>
        <p>&#x5728;&#x4E0A;&#x9762;&#x7684;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x51FD;&#x6570;(<code>tf.contrib.layers.fully_connected</code>)&#x4E2D;&#xFF0C;&#x5168;&#x8FDE;&#x63A5;&#x5C42;&#x81EA;&#x52A8;&#x521D;&#x59CB;&#x5316;&#x56FE;&#x4E2D;&#x7684;&#x6743;&#x91CD;w&#xFF0C;&#x5E76;&#x5728;&#x4F60;&#x8BAD;&#x7EC3;&#x6A21;&#x578B;&#x7684;&#x540C;&#x65F6;&#x7EE7;&#x7EED;&#x8BAD;&#x7EC3;&#x5B83;&#x4EEC;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x5728;&#x521D;&#x59CB;&#x5316;&#x53C2;&#x6570;&#x65F6;<strong>&#x4E0D;&#x9700;&#x8981;&#x521D;&#x59CB;&#x5316;</strong>&#x8FD9;&#x4E9B;&#x6743;&#x91CD;&#x3002;</p>
        <pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># GRADED FUNCTION: forward_propagation</span>
        
        <span class="token keyword">def</span> <span class="token function">forward_propagation</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> parameters<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token triple-quoted-string string">&quot;&quot;&quot;
            Implements the forward propagation for the model:
            CONV2D -&gt; RELU -&gt; MAXPOOL -&gt; CONV2D -&gt; RELU -&gt; MAXPOOL -&gt; FLATTEN -&gt; FULLYCONNECTED
            
            Arguments:
            X -- input dataset placeholder, of shape (input size, number of examples)
            parameters -- python dictionary containing your parameters &quot;W1&quot;, &quot;W2&quot;
                          the shapes are given in initialize_parameters
        
            Returns:
            Z3 -- the output of the last LINEAR unit
            &quot;&quot;&quot;</span>
            
            <span class="token comment"># &#x4ECE;&#x5B57;&#x5178;&quot;parameters&quot;&#x83B7;&#x53D6;&#x53C2;&#x6570; </span>
            W1 <span class="token operator">=</span> parameters<span class="token punctuation">[</span><span class="token string">&apos;W1&apos;</span><span class="token punctuation">]</span>
            W2 <span class="token operator">=</span> parameters<span class="token punctuation">[</span><span class="token string">&apos;W2&apos;</span><span class="token punctuation">]</span>
            
            <span class="token comment">### START CODE HERE ###</span>
            <span class="token comment"># CONV2D: stride of 1, padding &apos;SAME&apos;</span>
            Z1 <span class="token operator">=</span> tf<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>conv2d<span class="token punctuation">(</span>X<span class="token punctuation">,</span>W1<span class="token punctuation">,</span> strides <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> padding <span class="token operator">=</span> <span class="token string">&apos;SAME&apos;</span><span class="token punctuation">)</span>
            <span class="token comment"># RELU</span>
            A1 <span class="token operator">=</span> tf<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>Z1<span class="token punctuation">)</span>
            <span class="token comment"># MAXPOOL: window 8x8, sride 8, padding &apos;SAME&apos;</span>
            P1 <span class="token operator">=</span> tf<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>max_pool<span class="token punctuation">(</span>A1<span class="token punctuation">,</span> ksize <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> strides <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> padding <span class="token operator">=</span> <span class="token string">&apos;SAME&apos;</span><span class="token punctuation">)</span>
            <span class="token comment"># CONV2D: filters W2, stride 1, padding &apos;SAME&apos;</span>
            Z2 <span class="token operator">=</span> tf<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>conv2d<span class="token punctuation">(</span>P1<span class="token punctuation">,</span>W2<span class="token punctuation">,</span> strides <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> padding <span class="token operator">=</span> <span class="token string">&apos;SAME&apos;</span><span class="token punctuation">)</span>
            <span class="token comment"># RELU</span>
            A2 <span class="token operator">=</span> tf<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>relu<span class="token punctuation">(</span>Z2<span class="token punctuation">)</span>
            <span class="token comment"># MAXPOOL: window 4x4, stride 4, padding &apos;SAME&apos;</span>
            P2 <span class="token operator">=</span> tf<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>max_pool<span class="token punctuation">(</span>A2<span class="token punctuation">,</span> ksize <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> strides <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> padding <span class="token operator">=</span> <span class="token string">&apos;SAME&apos;</span><span class="token punctuation">)</span>
            <span class="token comment"># FLATTEN</span>
            P2 <span class="token operator">=</span> tf<span class="token punctuation">.</span>contrib<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>flatten<span class="token punctuation">(</span>P2<span class="token punctuation">)</span>
            <span class="token comment"># FULLY-CONNECTED &#x4E0D;&#x505A;&#x4EFB;&#x4F55;&#x975E;&#x7EBF;&#x6027;&#x5904;&#x7406;</span>
            <span class="token comment"># &#x8F93;&#x51FA;&#x5C42;&#x6709;6&#x4E2A;&#x795E;&#x7ECF;&#x5143;</span>
            Z3 <span class="token operator">=</span> tf<span class="token punctuation">.</span>contrib<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>fully_connected<span class="token punctuation">(</span>P2<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span>activation_fn <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">)</span>
            <span class="token comment">### END CODE HERE ###</span>
        
            <span class="token keyword">return</span> Z3
        </pre><h4 class="mume-header" id="%E6%B5%8B%E8%AF%95-2">&#x6D4B;&#x8BD5;</h4>
        
        <pre data-role="codeBlock" data-info="python" class="language-python">tf<span class="token punctuation">.</span>reset_default_graph<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        <span class="token keyword">with</span> tf<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> sess<span class="token punctuation">:</span>
            np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
            X<span class="token punctuation">,</span> Y <span class="token operator">=</span> create_placeholders<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span>
            parameters <span class="token operator">=</span> initialize_parameters<span class="token punctuation">(</span><span class="token punctuation">)</span>
            Z3 <span class="token operator">=</span> forward_propagation<span class="token punctuation">(</span>X<span class="token punctuation">,</span> parameters<span class="token punctuation">)</span>
            init <span class="token operator">=</span> tf<span class="token punctuation">.</span>global_variables_initializer<span class="token punctuation">(</span><span class="token punctuation">)</span>
            sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>init<span class="token punctuation">)</span>
            a <span class="token operator">=</span> sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>Z3<span class="token punctuation">,</span> <span class="token punctuation">{</span>X<span class="token punctuation">:</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">64</span><span class="token punctuation">,</span><span class="token number">64</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Y<span class="token punctuation">:</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Z3 = &quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        </pre><h4 class="mume-header" id="%E7%BB%93%E6%9E%9C-10">&#x7ED3;&#x679C;</h4>
        
        <pre data-role="codeBlock" data-info class="language-"><code>Z3 = [[ 1.44169843 -0.24909666  5.45049906 -0.26189619 -0.20669907  1.36546707]
              [ 1.40708458 -0.02573211  5.08928013 -0.48669922 -0.40940708  1.26248586]]
        </code></pre><h3 class="mume-header" id="%E8%AE%A1%E7%AE%97%E6%88%90%E6%9C%ACcost">&#x8BA1;&#x7B97;&#x6210;&#x672C;(cost)</h3>
        
        <ul>
        <li>
        <p><strong>tf.nn.softmax_cross_entropy_with_logits(logits = Z3, labels = Y):</strong></p>
        <p>&#x8BA1;&#x7B97;softmax&#x71B5;&#x635F;&#x5931;&#x3002;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x65E2;&#x8BA1;&#x7B97;softmax&#x6FC0;&#x6D3B;&#x51FD;&#x6570;&#xFF0C;&#x4E5F;&#x8BA1;&#x7B97;&#x7ED3;&#x679C;&#x635F;&#x5931;&#x3002;&#x9605;&#x8BFB;&#x5B8C;&#x6574;&#x7684;&#x6587;&#x6863;<a href="https://www.tensorflow.org/api_docs/python/tf/nn/softmax_cross_entropy_with_logits">&#x8FD9;&#x91CC;</a></p>
        </li>
        <li>
        <p><strong>tf.reduce_mean:</strong></p>
        <p>&#x8BA1;&#x7B97;&#x4E00;&#x4E2A;&#x5F20;&#x91CF;&#x7684;&#x7EF4;&#x6570;&#x4E2D;&#x5143;&#x7D20;&#x7684;&#x5E73;&#x5747;&#x503C;&#x3002;&#x5C06;&#x6240;&#x6709;&#x4F8B;&#x5B50;&#x7684;&#x635F;&#x5931;&#x52A0;&#x8D77;&#x6765;&#xFF0C;&#x5C31;&#x5F97;&#x5230;&#x4E86;&#x603B;&#x6210;&#x672C;cost&#x3002;&#x9605;&#x8BFB;&#x5B8C;&#x6574;&#x7684;&#x6587;&#x6863;<a href="https://www.tensorflow.org/api_docs/python/tf/reduce_mean">&#x8FD9;&#x91CC;</a></p>
        </li>
        </ul>
        <pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># GRADED FUNCTION: compute_cost </span>
        
        <span class="token keyword">def</span> <span class="token function">compute_cost</span><span class="token punctuation">(</span>Z3<span class="token punctuation">,</span> Y<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token triple-quoted-string string">&quot;&quot;&quot;
            Computes the cost
            
            Arguments:
            Z3 -- output of forward propagation (output of the last LINEAR unit), of shape (6, number of examples)
            Y -- &quot;true&quot; labels vector placeholder, same shape as Z3
            
            Returns:
            cost - Tensor of the cost function
            &quot;&quot;&quot;</span>
            
            <span class="token comment">### START CODE HERE ### (1 line of code)</span>
            cost <span class="token operator">=</span> tf<span class="token punctuation">.</span>reduce_mean<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>softmax_cross_entropy_with_logits<span class="token punctuation">(</span>logits <span class="token operator">=</span> Z3<span class="token punctuation">,</span>labels <span class="token operator">=</span> Y<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token comment">### END CODE HERE ###</span>
            
            <span class="token keyword">return</span> cost
        </pre><h4 class="mume-header" id="%E6%B5%8B%E8%AF%95-3">&#x6D4B;&#x8BD5;</h4>
        
        <pre data-role="codeBlock" data-info="python" class="language-python">tf<span class="token punctuation">.</span>reset_default_graph<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        <span class="token keyword">with</span> tf<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> sess<span class="token punctuation">:</span>
            np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
            X<span class="token punctuation">,</span> Y <span class="token operator">=</span> create_placeholders<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span>
            parameters <span class="token operator">=</span> initialize_parameters<span class="token punctuation">(</span><span class="token punctuation">)</span>
            Z3 <span class="token operator">=</span> forward_propagation<span class="token punctuation">(</span>X<span class="token punctuation">,</span> parameters<span class="token punctuation">)</span>
            cost <span class="token operator">=</span> compute_cost<span class="token punctuation">(</span>Z3<span class="token punctuation">,</span> Y<span class="token punctuation">)</span>
            init <span class="token operator">=</span> tf<span class="token punctuation">.</span>global_variables_initializer<span class="token punctuation">(</span><span class="token punctuation">)</span>
            sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>init<span class="token punctuation">)</span>
            a <span class="token operator">=</span> sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>cost<span class="token punctuation">,</span> <span class="token punctuation">{</span>X<span class="token punctuation">:</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">64</span><span class="token punctuation">,</span><span class="token number">64</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Y<span class="token punctuation">:</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;cost = &quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        </pre><h4 class="mume-header" id="%E7%BB%93%E6%9E%9C-11">&#x7ED3;&#x679C;</h4>
        
        <pre data-role="codeBlock" data-info class="language-"><code>cost = 2.91034
        </code></pre><h2 class="mume-header" id="%E6%A8%A1%E5%9E%8B">&#x6A21;&#x578B;</h2>
        
        <p>&#x6700;&#x540E;&#xFF0C;&#x60A8;&#x5C06;&#x5408;&#x5E76;&#x4E0A;&#x9762;&#x5B9E;&#x73B0;&#x7684;&#x5E2E;&#x52A9;&#x51FD;&#x6570;&#x6765;&#x6784;&#x5EFA;&#x4E00;&#x4E2A;&#x6A21;&#x578B;&#x3002;&#x60A8;&#x5C06;&#x5728;&#x7B26;&#x53F7;&#x6570;&#x636E;&#x96C6;&#x4E0A;&#x8BAD;&#x7EC3;&#x5B83;&#x3002;</p>
        <pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># GRADED FUNCTION: model</span>
        
        <span class="token keyword">def</span> <span class="token function">model</span><span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> Y_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> Y_test<span class="token punctuation">,</span> learning_rate <span class="token operator">=</span> <span class="token number">0.009</span><span class="token punctuation">,</span>
                  num_epochs <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">,</span> minibatch_size <span class="token operator">=</span> <span class="token number">64</span><span class="token punctuation">,</span> print_cost <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token triple-quoted-string string">&quot;&quot;&quot;
            Implements a three-layer ConvNet in Tensorflow:
            CONV2D -&gt; RELU -&gt; MAXPOOL -&gt; CONV2D -&gt; RELU -&gt; MAXPOOL -&gt; FLATTEN -&gt; FULLYCONNECTED
            
            Arguments:
            X_train -- training set, of shape (None, 64, 64, 3)
            Y_train -- test set, of shape (None, n_y = 6)
            X_test -- training set, of shape (None, 64, 64, 3)
            Y_test -- test set, of shape (None, n_y = 6)
            learning_rate -- learning rate of the optimization
            num_epochs -- number of epochs of the optimization loop
            minibatch_size -- size of a minibatch
            print_cost -- True to print the cost every 100 epochs
            
            Returns:
            train_accuracy -- real number, accuracy on the train set (X_train)
            test_accuracy -- real number, testing accuracy on the test set (X_test)
            parameters -- parameters learnt by the model. They can then be used to predict.
            &quot;&quot;&quot;</span>
            
            ops<span class="token punctuation">.</span>reset_default_graph<span class="token punctuation">(</span><span class="token punctuation">)</span>                         <span class="token comment"># &#x80FD;&#x591F;&#x5728;&#x4E0D;&#x8986;&#x76D6;tf&#x53D8;&#x91CF;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x91CD;&#x65B0;&#x8FD0;&#x884C;&#x6A21;&#x578B;</span>
            tf<span class="token punctuation">.</span>set_random_seed<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>                             <span class="token comment"># &#x4FDD;&#x6301;&#x7ED3;&#x679C;&#x4E00;&#x81F4;(tensorflow	&#x968F;&#x673A;&#x79CD;&#x5B50;)</span>
            seed <span class="token operator">=</span> <span class="token number">3</span>                                          <span class="token comment"># &#x4FDD;&#x6301;&#x7ED3;&#x679C;&#x4E00;&#x81F4;(numpy		&#x968F;&#x673A;&#x79CD;&#x5B50;)</span>
            <span class="token punctuation">(</span>m<span class="token punctuation">,</span> n_H0<span class="token punctuation">,</span> n_W0<span class="token punctuation">,</span> n_C0<span class="token punctuation">)</span> <span class="token operator">=</span> X_train<span class="token punctuation">.</span>shape             
            n_y <span class="token operator">=</span> Y_train<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>                            
            costs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>                                        <span class="token comment"># &#x8FFD;&#x8E2A;cost</span>
            
            <span class="token comment"># &#x521B;&#x5EFA;&#x5360;&#x4F4D;&#x7B26;</span>
            <span class="token comment">### START CODE HERE ### (1 line)</span>
            X<span class="token punctuation">,</span> Y <span class="token operator">=</span> create_placeholders<span class="token punctuation">(</span>n_H0<span class="token punctuation">,</span> n_W0<span class="token punctuation">,</span> n_C0<span class="token punctuation">,</span> n_y<span class="token punctuation">)</span>
            <span class="token comment">### END CODE HERE ###</span>
        
            <span class="token comment"># &#x521D;&#x59CB;&#x5316;</span>
            <span class="token comment">### START CODE HERE ### (1 line)</span>
            parameters <span class="token operator">=</span> initialize_parameters<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token comment">### END CODE HERE ###</span>
            
            <span class="token comment"># &#x6B63;&#x5411;&#x4F20;&#x64AD;</span>
            <span class="token comment">### START CODE HERE ### (1 line)</span>
            Z3 <span class="token operator">=</span> forward_propagation<span class="token punctuation">(</span>X<span class="token punctuation">,</span> parameters<span class="token punctuation">)</span>
            <span class="token comment">### END CODE HERE ###</span>
            
            <span class="token comment"># &#x6210;&#x672C;&#x51FD;&#x6570;</span>
            <span class="token comment">### START CODE HERE ### (1 line)</span>
            cost <span class="token operator">=</span> compute_cost<span class="token punctuation">(</span>Z3<span class="token punctuation">,</span> Y<span class="token punctuation">)</span>
            <span class="token comment">### END CODE HERE ###</span>
            
            <span class="token comment"># &#x53CD;&#x5411;&#x4F20;&#x64AD;: &#x4F7F;&#x7528; AdamOptimizer &#x4F18;&#x5316;cost.</span>
            <span class="token comment">### START CODE HERE ### (1 line)</span>
            optimizer <span class="token operator">=</span> tf<span class="token punctuation">.</span>train<span class="token punctuation">.</span>AdamOptimizer<span class="token punctuation">(</span>learning_rate<span class="token punctuation">)</span><span class="token punctuation">.</span>minimize<span class="token punctuation">(</span>cost<span class="token punctuation">)</span>
            <span class="token comment">### END CODE HERE ###</span>
            
            <span class="token comment"># &#x521D;&#x59CB;&#x5316;&#x6240;&#x6709;&#x5168;&#x5C40;&#x53D8;&#x91CF;</span>
            init <span class="token operator">=</span> tf<span class="token punctuation">.</span>global_variables_initializer<span class="token punctuation">(</span><span class="token punctuation">)</span>
             
            <span class="token comment"># &#x5F00;&#x542F;session&#x8BA1;&#x7B97;TensorFlow&#x7684;&#x8BA1;&#x7B97;&#x56FE;</span>
            <span class="token keyword">with</span> tf<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> sess<span class="token punctuation">:</span>
                
                <span class="token comment"># &#x8FD0;&#x884C;&#x521D;&#x59CB;&#x5316;</span>
                sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>init<span class="token punctuation">)</span>
                
                <span class="token comment"># &#x8BAD;&#x7EC3;&#x5FAA;&#x73AF;</span>
                <span class="token keyword">for</span> epoch <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_epochs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        
                    minibatch_cost <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">.</span>
                    num_minibatches <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>m <span class="token operator">/</span> minibatch_size<span class="token punctuation">)</span> <span class="token comment"># minibatch&#x7684;&#x6570;&#x91CF;</span>
                    seed <span class="token operator">=</span> seed <span class="token operator">+</span> <span class="token number">1</span>
                    minibatches <span class="token operator">=</span> random_mini_batches<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> Y_train<span class="token punctuation">,</span> minibatch_size<span class="token punctuation">,</span> seed<span class="token punctuation">)</span>
        
                    <span class="token keyword">for</span> minibatch <span class="token keyword">in</span> minibatches<span class="token punctuation">:</span>
        
                        <span class="token comment"># &#x9009;&#x62E9;&#x4E00;&#x4E2A; minibatch</span>
                        <span class="token punctuation">(</span>minibatch_X<span class="token punctuation">,</span> minibatch_Y<span class="token punctuation">)</span> <span class="token operator">=</span> minibatch
                        <span class="token comment"># &#x91CD;&#x8981;: &#x6240;&#x6709;&#x8BA1;&#x7B97;&#x56FE;&#x90FD;&#x662F;&#x5728;minibatch&#x4E0A;&#x8FD0;&#x884C;</span>
                        <span class="token comment"># &#x8FD0;&#x884C;session&#x6765;&#x6267;&#x884C;&#x4F18;&#x5316;&#x5668;&#x548C;&#x6210;&#x672C;&#xFF0C;feedict&#x5E94;&#x8BE5;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x9488;&#x5BF9;(X,Y)&#x7684;minibatch.</span>
                        <span class="token comment">### START CODE HERE ### (1 line)</span>
                        _ <span class="token punctuation">,</span> temp_cost <span class="token operator">=</span> sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">[</span>optimizer<span class="token punctuation">,</span> cost<span class="token punctuation">]</span> <span class="token punctuation">,</span> feed_dict<span class="token operator">=</span><span class="token punctuation">{</span>X<span class="token punctuation">:</span> minibatch_X<span class="token punctuation">,</span> Y<span class="token punctuation">:</span> minibatch_Y<span class="token punctuation">}</span><span class="token punctuation">)</span>
                        <span class="token comment">### END CODE HERE ###</span>
                        
                        minibatch_cost <span class="token operator">+=</span> temp_cost <span class="token operator">/</span> num_minibatches
                        
        
                    <span class="token comment"># &#x6253;&#x5370;cost</span>
                    <span class="token keyword">if</span> print_cost <span class="token operator">==</span> <span class="token boolean">True</span> <span class="token keyword">and</span> epoch <span class="token operator">%</span> <span class="token number">5</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
                        <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">&quot;Cost after epoch %i: %f&quot;</span> <span class="token operator">%</span> <span class="token punctuation">(</span>epoch<span class="token punctuation">,</span> minibatch_cost<span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token keyword">if</span> print_cost <span class="token operator">==</span> <span class="token boolean">True</span> <span class="token keyword">and</span> epoch <span class="token operator">%</span> <span class="token number">1</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
                        costs<span class="token punctuation">.</span>append<span class="token punctuation">(</span>minibatch_cost<span class="token punctuation">)</span>
                
                
                <span class="token comment"># &#x7ED8;&#x5236; cost &#x66F2;&#x7EBF;</span>
                plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>np<span class="token punctuation">.</span>squeeze<span class="token punctuation">(</span>costs<span class="token punctuation">)</span><span class="token punctuation">)</span>
                plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">&apos;cost&apos;</span><span class="token punctuation">)</span>
                plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">&apos;iterations (per tens)&apos;</span><span class="token punctuation">)</span>
                plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&quot;Learning rate =&quot;</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>learning_rate<span class="token punctuation">)</span><span class="token punctuation">)</span>
                plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
                <span class="token comment"># &#x8BA1;&#x7B97;&#x6B63;&#x786E;&#x7684;&#x9884;&#x6D4B;</span>
                predict_op <span class="token operator">=</span> tf<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>Z3<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
                correct_prediction <span class="token operator">=</span> tf<span class="token punctuation">.</span>equal<span class="token punctuation">(</span>predict_op<span class="token punctuation">,</span> tf<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>Y<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                
                <span class="token comment"># &#x8BA1;&#x7B97;&#x6D4B;&#x8BD5;&#x96C6;&#x7684;&#x51C6;&#x786E;&#x5EA6;</span>
                accuracy <span class="token operator">=</span> tf<span class="token punctuation">.</span>reduce_mean<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>cast<span class="token punctuation">(</span>correct_prediction<span class="token punctuation">,</span> <span class="token string">&quot;float&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>accuracy<span class="token punctuation">)</span>
                train_accuracy <span class="token operator">=</span> accuracy<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token punctuation">{</span>X<span class="token punctuation">:</span> X_train<span class="token punctuation">,</span> Y<span class="token punctuation">:</span> Y_train<span class="token punctuation">}</span><span class="token punctuation">)</span>
                test_accuracy <span class="token operator">=</span> accuracy<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token punctuation">{</span>X<span class="token punctuation">:</span> X_test<span class="token punctuation">,</span> Y<span class="token punctuation">:</span> Y_test<span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Train Accuracy:&quot;</span><span class="token punctuation">,</span> train_accuracy<span class="token punctuation">)</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Test Accuracy:&quot;</span><span class="token punctuation">,</span> test_accuracy<span class="token punctuation">)</span>
                        
                <span class="token keyword">return</span> train_accuracy<span class="token punctuation">,</span> test_accuracy<span class="token punctuation">,</span> parameters
        </pre><h4 class="mume-header" id="%E6%B5%8B%E8%AF%95-4">&#x6D4B;&#x8BD5;</h4>
        
        <pre data-role="codeBlock" data-info class="language-"><code>_, _, parameters = model(X_train, Y_train, X_test, Y_test)
        </code></pre><h4 class="mume-header" id="%E7%BB%93%E6%9E%9C-12">&#x7ED3;&#x679C;</h4>
        
        <pre data-role="codeBlock" data-info class="language-"><code>Cost after epoch 0: 1.917920
        Cost after epoch 5: 1.532475
        Cost after epoch 10: 1.014804
        Cost after epoch 15: 0.885137
        Cost after epoch 20: 0.766963
        Cost after epoch 25: 0.651208
        Cost after epoch 30: 0.613356
        Cost after epoch 35: 0.605931
        Cost after epoch 40: 0.534713
        Cost after epoch 45: 0.551402
        Cost after epoch 50: 0.496976
        Cost after epoch 55: 0.454438
        Cost after epoch 60: 0.455496
        Cost after epoch 65: 0.458359
        Cost after epoch 70: 0.450040
        Cost after epoch 75: 0.410687
        Cost after epoch 80: 0.469005
        Cost after epoch 85: 0.389253
        Cost after epoch 90: 0.363808
        Cost after epoch 95: 0.376132
        </code></pre><p><img src="img/QQ%E6%88%AA%E5%9B%BE20200820091743.jpg" alt></p>
        
            </div>
          </main>
        </div>
      </div>

    </body></html>
    